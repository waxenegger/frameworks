   (function (root, factories) {    var modules = factories(root);    for (m in modules)     root[m] = modules[m];   }(this, function (ctx) {    var OPENLAYERS = {};    var OME = {};    if (typeof(ctx) === 'object' && typeof(ctx.ome) === 'object') {     OME.ome = ctx.ome;     var ome = ctx.ome;    }    var B,aa=this;function ba(b,d,g){b=b.split(".");g=g||aa;b[0]in g||!g.execScript||g.execScript("var "+b[0]);for(var k;b.length&&(k=b.shift());)b.length||void 0===d?g[k]?g=g[k]:g=g[k]={}:g[k]=d}function ea(b){b.Nb=function(){return b.Ee?b.Ee:b.Ee=new b}}
function fa(b){var d=typeof b;if("object"==d)if(b){if(b instanceof Array)return"array";if(b instanceof Object)return d;var g=Object.prototype.toString.call(b);if("[object Window]"==g)return"object";if("[object Array]"==g||"number"==typeof b.length&&"undefined"!=typeof b.splice&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("splice"))return"array";if("[object Function]"==g||"undefined"!=typeof b.call&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==d&&"undefined"==typeof b.call)return"object";return d}function ga(b){return"array"==fa(b)}function ha(b){var d=fa(b);return"array"==d||"object"==d&&"number"==typeof b.length}function ia(b){return"string"==typeof b}function ja(b){return"number"==typeof b}function ka(b){return"function"==fa(b)}function la(b){var d=typeof b;return"object"==d&&null!=b||"function"==d}function I(b){return b[ma]||(b[ma]=++na)}var ma="closure_uid_"+(1E9*Math.random()>>>0),na=0;
function oa(b,d,g){return b.call.apply(b.bind,arguments)}function pa(b,d,g){if(!b)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var g=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(g,k);return b.apply(d,g)}}return function(){return b.apply(d,arguments)}}function qa(b,d,g){qa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oa:pa;return qa.apply(null,arguments)}
function ra(b,d){var g=Array.prototype.slice.call(arguments,1);return function(){var d=g.slice();d.push.apply(d,arguments);return b.apply(this,d)}}function M(b,d){function g(){}g.prototype=d.prototype;b.Aa=d.prototype;b.prototype=new g;b.prototype.constructor=b;b.Fi=function(b,g,q){for(var u=Array(arguments.length-2),v=2;v<arguments.length;v++)u[v-2]=arguments[v];return d.prototype[g].apply(b,u)}};if("object"!==typeof ome)var ome={};var sa,ta="function"===typeof Object.assign?Object.assign:function(b,d){if(void 0===b||null===b)throw new TypeError("Cannot convert undefined or null to object");for(var g=Object(b),k=1,p=arguments.length;k<p;++k){var q=arguments[k];if(void 0!==q&&null!==q)for(var u in q)q.hasOwnProperty(u)&&(g[u]=q[u])}return g};function ua(b){for(var d in b)delete b[d]}function wa(b){var d=[],g;for(g in b)d.push(b[g]);return d}function xa(b){for(var d in b)return!1;return!d};var ya="olm_"+(1E4*Math.random()|0);function za(b){function d(d){var k=b.listener,p=b.ie||b.target;b.ke&&Aa(b);return k.call(p,d)}return b.je=d}function Ba(b,d,g,k){for(var p,q=0,u=b.length;q<u;++q)if(p=b[q],p.listener===d&&p.ie===g)return k&&(p.deleteIndex=q),p}function Ca(b,d){var g=b[ya];return g?g[d]:void 0}function Da(b){var d=b[ya];d||(d=b[ya]={});return d}
function Ea(b,d){var g=Ca(b,d);if(g){for(var k=0,p=g.length;k<p;++k)b.removeEventListener(d,g[k].je),ua(g[k]);g.length=0;if(g=b[ya])delete g[d],0===Object.keys(g).length&&delete b[ya]}}function S(b,d,g,k,p){var q=Da(b),u=q[d];u||(u=q[d]=[]);(q=Ba(u,g,k,!1))?p||(q.ke=!1):(q={ie:k,ke:!!p,listener:g,target:b,type:d},b.addEventListener(d,za(q)),u.push(q));return q}function Fa(b,d,g,k){(b=Ca(b,d))&&(g=Ba(b,g,k,!0))&&Aa(g)}
function Aa(b){if(b&&b.target){b.target.removeEventListener(b.type,b.je);var d=Ca(b.target,b.type);if(d){var g="deleteIndex"in b?b.deleteIndex:d.indexOf(b);-1!==g&&d.splice(g,1);0===d.length&&Ea(b.target,b.type)}ua(b)}}function Ga(b){var d=Da(b),g;for(g in d)Ea(b,g)};function Ha(b){if(Error.captureStackTrace)Error.captureStackTrace(this,Ha);else{var d=Error().stack;d&&(this.stack=d)}b&&(this.message=String(b))}M(Ha,Error);Ha.prototype.name="CustomError";var Ia;function Ja(b,d){for(var g=b.split("%s"),k="",p=Array.prototype.slice.call(arguments,1);p.length&&1<g.length;)k+=g.shift()+p.shift();return k+g.join("%s")}var Ka=String.prototype.trim?function(b){return b.trim()}:function(b){return b.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};
function La(b){if(!Ma.test(b))return b;-1!=b.indexOf("&")&&(b=b.replace(Na,"&amp;"));-1!=b.indexOf("<")&&(b=b.replace(Oa,"&lt;"));-1!=b.indexOf(">")&&(b=b.replace(Pa,"&gt;"));-1!=b.indexOf('"')&&(b=b.replace(Qa,"&quot;"));-1!=b.indexOf("'")&&(b=b.replace(Sa,"&#39;"));-1!=b.indexOf("\x00")&&(b=b.replace(Ta,"&#0;"));return b}var Na=/&/g,Oa=/</g,Pa=/>/g,Qa=/"/g,Sa=/'/g,Ta=/\x00/g,Ma=/[\x00&<>"']/;function Ua(){return-1!=Va.toLowerCase().indexOf("webkit")}function Wa(b,d){return b<d?-1:b>d?1:0}
function Xa(b){return String(b).replace(/\-([a-z])/g,function(b,g){return g.toUpperCase()})}function Ya(b){var d=ia(void 0)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s";return b.replace(new RegExp("(^"+(d?"|["+d+"]+":"")+")([a-z])","g"),function(b,d,p){return d+p.toUpperCase()})};function Za(b,d){d.unshift(b);Ha.call(this,Ja.apply(null,d));d.shift()}M(Za,Ha);Za.prototype.name="AssertionError";function $a(b,d){throw new Za("Failure"+(b?": "+b:""),Array.prototype.slice.call(arguments,1));}function ab(b,d,g){if("boolean"!=typeof b){var k=[fa(b),b],p="Assertion failed";d?(p+=": "+d,k=Array.prototype.slice.call(arguments,2)):p+=": Expected boolean but got %s: %s.";throw new Za(""+p,k||[]);}};function bb(){};function cb(){}cb.prototype.ab=!1;cb.prototype.qa=function(){this.ab||(this.ab=!0,this.aa())};cb.prototype.aa=bb;function db(b,d){this.type=b;this.target=d||null}db.prototype.preventDefault=db.prototype.stopPropagation=function(){this.Ah=!0};function eb(b){b.stopPropagation()}function fb(b){b.preventDefault()};function gb(){this.da={};this.Z={}}M(gb,cb);gb.prototype.addEventListener=function(b,d){var g=this.Z[b];g||(g=this.Z[b]=[]);-1===g.indexOf(d)&&g.push(d)};function T(b,d){var g="string"===typeof d?new db(d):d,k=g.type;g.target=b;var p=b.Z[k],q;if(p){k in b.da||(b.da[k]=0);for(var u=0,v=p.length;u<v;++u)if(!1===p[u].call(b,g)||g.Ah){q=!1;break}g=b.da[k];for(delete b.da[k];g--;)b.removeEventListener(k,bb);return q}}gb.prototype.aa=function(){Ga(this)};
function hb(b,d){return d?d in b.Z:0<Object.keys(b.Z).length}gb.prototype.removeEventListener=function(b,d){var g=this.Z[b];if(g){var k=g.indexOf(d);b in this.da?(g[k]=bb,++this.da[b]):(g.splice(k,1),0===g.length&&delete this.Z[b])}};function ib(){gb.call(this);this.f=0}M(ib,gb);ib.prototype.A=function(){++this.f;T(this,"change")};function jb(b,d,g){if(Array.isArray("drawend"))for(var k=Array(7),p=0;7>p;++p)k[p]=S(b,"drawend"[p],d,g);else S(b,"drawend",d,g)};function kb(b){db.call(this,b)}M(kb,db);function lb(b){ib.call(this);I(this);this.$={};void 0!==b&&mb(this,b)}M(lb,ib);var nb={};function ob(b){return nb.hasOwnProperty(b)?nb[b]:nb[b]="change:"+b}lb.prototype.get=function(b){var d;this.$.hasOwnProperty(b)&&(d=this.$[b]);return d};lb.prototype.set=function(b,d,g){g?this.$[b]=d:(g=this.$[b],this.$[b]=d,g!==d&&(b=ob(b),T(this,new kb(b)),T(this,new kb("propertychange"))))};function mb(b,d){for(var g in d)b.set(g,d[g],void 0)};function pb(b,d,g){db.call(this,b,g);this.element=d}M(pb,db);function qb(b){lb.call(this);this.a=b?b:[];rb(this)}M(qb,lb);B=qb.prototype;B.clear=function(){for(;0<sb(this);)this.pop()};B.forEach=function(b,d){this.a.forEach(b,d)};B.item=function(b){return this.a[b]};function sb(b){return b.get("length")}function tb(b,d,g){b.a.splice(d,0,g);rb(b);T(b,new pb("add",g,b))}B.pop=function(){return ub(this,sb(this)-1)};B.push=function(b){var d=this.a.length;tb(this,d,b);return d};
B.remove=function(b){var d=this.a,g,k;g=0;for(k=d.length;g<k;++g)if(d[g]===b)return ub(this,g)};function ub(b,d){var g=b.a[d];b.a.splice(d,1);rb(b);T(b,new pb("remove",g,b));return g}function rb(b){b.set("length",b.a.length)};function vb(b){this.length=b.length||b;for(var d=0;d<this.length;d++)this[d]=b[d]||0}vb.prototype.BYTES_PER_ELEMENT=4;vb.prototype.set=function(b,d){d=d||0;for(var g=0;g<b.length&&d+g<this.length;g++)this[d+g]=b[g]};vb.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(vb.BYTES_PER_ELEMENT=4,vb.prototype.BYTES_PER_ELEMENT=vb.prototype.BYTES_PER_ELEMENT,vb.prototype.set=vb.prototype.set,vb.prototype.toString=vb.prototype.toString,ba("Float32Array",vb,void 0));function wb(b){this.length=b.length||b;for(var d=0;d<this.length;d++)this[d]=b[d]||0}wb.prototype.BYTES_PER_ELEMENT=8;wb.prototype.set=function(b,d){d=d||0;for(var g=0;g<b.length&&d+g<this.length;g++)this[d+g]=b[g]};wb.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{wb.BYTES_PER_ELEMENT=8}catch(b){}wb.prototype.BYTES_PER_ELEMENT=wb.prototype.BYTES_PER_ELEMENT;wb.prototype.set=wb.prototype.set;wb.prototype.toString=wb.prototype.toString;ba("Float64Array",wb,void 0)};function xb(b,d,g,k,p){b[0]=d;b[1]=g;b[2]=k;b[3]=p};function yb(){var b=Array(16);zb(b,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return b}function Ab(){var b=Array(16);zb(b,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return b}function zb(b,d,g,k,p,q,u,v,w,z,A,C,D,E,G,J,K){b[0]=d;b[1]=g;b[2]=k;b[3]=p;b[4]=q;b[5]=u;b[6]=v;b[7]=w;b[8]=z;b[9]=A;b[10]=C;b[11]=D;b[12]=E;b[13]=G;b[14]=J;b[15]=K}
function Cb(b,d){b[0]=d[0];b[1]=d[1];b[2]=d[2];b[3]=d[3];b[4]=d[4];b[5]=d[5];b[6]=d[6];b[7]=d[7];b[8]=d[8];b[9]=d[9];b[10]=d[10];b[11]=d[11];b[12]=d[12];b[13]=d[13];b[14]=d[14];b[15]=d[15]}function Db(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1}
function Eb(b,d){var g=b[0],k=b[1],p=b[2],q=b[3],u=b[4],v=b[5],w=b[6],z=b[7],A=b[8],C=b[9],D=b[10],E=b[11],G=b[12],J=b[13],K=b[14],N=b[15],F=g*v-k*u,H=g*w-p*u,O=g*z-q*u,Q=k*w-p*v,P=k*z-q*v,R=p*z-q*w,W=A*J-C*G,L=A*K-D*G,U=A*N-E*G,ca=C*K-D*J,Z=C*N-E*J,da=D*N-E*K,Y=F*da-H*Z+O*ca+Q*U-P*L+R*W;0!=Y&&(Y=1/Y,d[0]=(v*da-w*Z+z*ca)*Y,d[1]=(-k*da+p*Z-q*ca)*Y,d[2]=(J*R-K*P+N*Q)*Y,d[3]=(-C*R+D*P-E*Q)*Y,d[4]=(-u*da+w*U-z*L)*Y,d[5]=(g*da-p*U+q*L)*Y,d[6]=(-G*R+K*O-N*H)*Y,d[7]=(A*R-D*O+E*H)*Y,d[8]=(u*Z-v*U+z*W)*Y,
d[9]=(-g*Z+k*U-q*W)*Y,d[10]=(G*P-J*O+N*F)*Y,d[11]=(-A*P+C*O-E*F)*Y,d[12]=(-u*ca+v*L-w*W)*Y,d[13]=(g*ca-k*L+p*W)*Y,d[14]=(-G*Q+J*H-K*F)*Y,d[15]=(A*Q-C*H+D*F)*Y)}function Fb(b,d,g){var k=b[1]*d+b[5]*g+0*b[9]+b[13],p=b[2]*d+b[6]*g+0*b[10]+b[14],q=b[3]*d+b[7]*g+0*b[11]+b[15];b[12]=b[0]*d+b[4]*g+0*b[8]+b[12];b[13]=k;b[14]=p;b[15]=q}function Gb(b,d,g){zb(b,b[0]*d,b[1]*d,b[2]*d,b[3]*d,b[4]*g,b[5]*g,b[6]*g,b[7]*g,1*b[8],1*b[9],1*b[10],1*b[11],b[12],b[13],b[14],b[15])}
function Hb(b,d){var g=b[0],k=b[1],p=b[2],q=b[3],u=b[4],v=b[5],w=b[6],z=b[7],A=Math.cos(d),C=Math.sin(d);b[0]=g*A+u*C;b[1]=k*A+v*C;b[2]=p*A+w*C;b[3]=q*A+z*C;b[4]=g*-C+u*A;b[5]=k*-C+v*A;b[6]=p*-C+w*A;b[7]=q*-C+z*A}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);function Ib(b,d,g){return Math.min(Math.max(b,d),g)}var Jb=function(){var b;"cosh"in Math?b=Math.cosh:b=function(b){b=Math.exp(b);return(b+1/b)/2};return b}();function Kb(b,d){var g=b%d;return 0>g*d?g+d:g};function Lb(b,d){b[0]+=d[0];b[1]+=d[1]}function Mb(b,d){var g=b[0],k=b[1],p=d[0],q=d[1],u=p[0],p=p[1],v=q[0],q=q[1],w=v-u,z=q-p,g=0===w&&0===z?0:(w*(g-u)+z*(k-p))/(w*w+z*z||0);0>=g||(1<=g?(u=v,p=q):(u+=g*w,p+=g*z));return[u,p]}function Nb(b,d){for(var g=!0,k=b.length-1;0<=k;--k)if(b[k]!=d[k]){g=!1;break}return g}function Ob(b,d){var g=Math.cos(d),k=Math.sin(d),p=b[1]*g+b[0]*k;b[0]=b[0]*g-b[1]*k;b[1]=p}function Pb(b,d){var g=b[0]-d[0],k=b[1]-d[1];return g*g+k*k};function Qb(b,d){if(Array.isArray(b))return b;void 0===d?d=[b,b]:(d[0]=b,d[1]=b);return d};function Rb(b){for(var d=Sb(),g=0,k=b.length;g<k;++g)Tb(d,b[g]);return d}function Ub(b,d,g){return g?(g[0]=b[0]-d,g[1]=b[1]-d,g[2]=b[2]+d,g[3]=b[3]+d,g):[b[0]-d,b[1]-d,b[2]+d,b[3]+d]}function Vb(b,d){return d?(d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],d):b.slice()}function Wb(b,d){return b[0]<=d[0]&&d[2]<=b[2]&&b[1]<=d[1]&&d[3]<=b[3]}function Xb(b,d,g){return b[0]<=d&&d<=b[2]&&b[1]<=g&&g<=b[3]}
function Yb(b,d){var g=b[1],k=b[2],p=b[3],q=d[0],u=d[1],v=0;q<b[0]?v=v|16:q>k&&(v=v|4);u<g?v|=8:u>p&&(v|=2);0===v&&(v=1);return v}function Sb(){return[Infinity,Infinity,-Infinity,-Infinity]}function Zb(b,d,g,k,p){return p?(p[0]=b,p[1]=d,p[2]=g,p[3]=k,p):[b,d,g,k]}function $b(b,d){var g=b[0],k=b[1];return Zb(g,k,g,k,d)}function ac(b,d){return b[0]==d[0]&&b[2]==d[2]&&b[1]==d[1]&&b[3]==d[3]}function Tb(b,d){d[0]<b[0]&&(b[0]=d[0]);d[0]>b[2]&&(b[2]=d[0]);d[1]<b[1]&&(b[1]=d[1]);d[1]>b[3]&&(b[3]=d[1])}
function bc(b,d,g,k,p){for(;g<k;g+=p){var q=b,u=d[g],v=d[g+1];q[0]=Math.min(q[0],u);q[1]=Math.min(q[1],v);q[2]=Math.max(q[2],u);q[3]=Math.max(q[3],v)}return b}function cc(b,d,g){var k;return(k=d.call(g,dc(b)))||(k=d.call(g,[b[2],b[1]]))||(k=d.call(g,[b[2],b[3]]))?k:(k=d.call(g,ec(b)))?k:!1}function fc(b){var d=0;gc(b)||(d=hc(b)*ic(b));return d}function dc(b){return[b[0],b[1]]}function jc(b){return[(b[0]+b[2])/2,(b[1]+b[3])/2]}
function kc(b,d,g,k){var p=d*k[0]/2;k=d*k[1]/2;d=Math.cos(g);var q=Math.sin(g);g=p*d;p*=q;d*=k;var u=k*q,v=b[0],w=b[1];b=v-g+u;k=v-g-u;q=v+g-u;g=v+g+u;var u=w-p-d,v=w-p+d,z=w+p+d,p=w+p-d;return Zb(Math.min(b,k,q,g),Math.min(u,v,z,p),Math.max(b,k,q,g),Math.max(u,v,z,p),void 0)}function ic(b){return b[3]-b[1]}function lc(b,d){var g=Sb();mc(b,d)&&(g[0]=b[0]>d[0]?b[0]:d[0],g[1]=b[1]>d[1]?b[1]:d[1],g[2]=b[2]<d[2]?b[2]:d[2],g[3]=b[3]<d[3]?b[3]:d[3]);return g}function ec(b){return[b[0],b[3]]}
function hc(b){return b[2]-b[0]}function mc(b,d){return b[0]<=d[2]&&b[2]>=d[0]&&b[1]<=d[3]&&b[3]>=d[1]}function gc(b){return b[2]<b[0]||b[3]<b[1]};/*

 Latitude/longitude spherical geodesy formulae taken from
 http://www.movable-type.co.uk/scripts/latlong.html
 Licensed under CC-BY-3.0.
*/
function nc(b){this.Rb=b}function oc(b,d){var g=b[1]*Math.PI/180,k=d[1]*Math.PI/180,p=(k-g)/2,q=(d[0]-b[0])*Math.PI/180/2,g=Math.sin(p)*Math.sin(p)+Math.sin(q)*Math.sin(q)*Math.cos(g)*Math.cos(k);return 2*pc.Rb*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))}
nc.prototype.offset=function(b,d,g){var k=b[1]*Math.PI/180;d/=this.Rb;var p=Math.asin(Math.sin(k)*Math.cos(d)+Math.cos(k)*Math.sin(d)*Math.cos(g));return[180*(b[0]*Math.PI/180+Math.atan2(Math.sin(g)*Math.sin(d)*Math.cos(k),Math.cos(d)-Math.sin(k)*Math.sin(p)))/Math.PI,180*p/Math.PI]};var pc=new nc(6370997);var qc={};qc.degrees=2*Math.PI*pc.Rb/360;qc.ft=.3048;qc.m=1;qc["us-ft"]=1200/3937;
function rc(b){this.a=b.code;this.f=b.units;this.i=void 0!==b.D?b.D:null;this.b=void 0!==b.global?b.global:!1;this.bc=!(!this.b||!this.i);this.j=void 0!==b.dc?b.dc:this.l;this.g=null;this.h=b.Ie;var d=sc,g=b.code,k=tc||aa.proj4;if("function"==typeof k&&void 0===d[g]){var p=k.re(g);if(void 0!==p){void 0===b.Ie&&(this.h=p.Qi);void 0===b.units&&(this.f=p.units);var q,u;for(q in d)if(b=k.re(q),void 0!==b)if(d=uc(q),b===p)vc([d,this]);else{u=k(q,g);b=u.forward;u=u.inverse;var d=uc(d),v=uc(this);wc(d,v,
xc(b));wc(v,d,xc(u))}}}}rc.prototype.J=function(){return this.i};function yc(b){return b.h||qc[b.f]}rc.prototype.l=function(b,d){if("degrees"==this.f)return b;var g=zc(this,uc("EPSG:4326")),k=[d[0]-b/2,d[1],d[0]+b/2,d[1],d[0],d[1]-b/2,d[0],d[1]+b/2],k=g(k,k,2),g=(oc(k.slice(0,2),k.slice(2,4))+oc(k.slice(4,6),k.slice(6,8)))/2,k=yc(this);void 0!==k&&(g/=k);return g};rc.prototype.dc=function(b,d){return this.j(b,d)};var sc={},Ac={},tc=null;
function vc(b){Bc(b);b.forEach(function(d){b.forEach(function(b){d!==b&&wc(d,b,Cc)})})}function Dc(b){sc[b.a]=b;wc(b,b,Cc)}function Bc(b){var d=[];b.forEach(function(b){d.push(Dc(b))})}function Ec(b){return b?"string"===typeof b?uc(b):b:uc("EPSG:3857")}function wc(b,d,g){b=b.a;d=d.a;b in Ac||(Ac[b]={});Ac[b][d]=g}
function xc(b){return function(d,g,k){var p=d.length;k=void 0!==k?k:2;g=void 0!==g?g:Array(p);var q,u;for(u=0;u<p;u+=k)for(q=b([d[u],d[u+1]]),g[u]=q[0],g[u+1]=q[1],q=k-1;2<=q;--q)g[u+q]=d[u+q];return g}}function uc(b){var d;if(b instanceof rc)d=b;else if("string"===typeof b){d=sc[b];var g=tc||aa.proj4;void 0===d&&"function"==typeof g&&void 0!==g.re(b)&&(d=new rc({code:b}),Dc(d))}else d=null;return d}function Fc(b,d){if(b===d)return!0;var g=b.f===d.f;return b.a===d.a?g:zc(b,d)===Cc&&g}
function Gc(b,d){var g=uc(b),k=uc(d);return zc(g,k)}function zc(b,d){var g=b.a,k=d.a,p;g in Ac&&k in Ac[g]&&(p=Ac[g][k]);void 0===p&&(p=Hc);return p}function Hc(b,d){if(void 0!==d&&b!==d){$a("This should not be used internally.");for(var g=0,k=b.length;g<k;++g)d[g]=b[g];b=d}return b}function Cc(b,d){var g;if(void 0!==d){g=0;for(var k=b.length;g<k;++g)d[g]=b[g];g=d}else g=b.slice();return g};function Ic(b,d,g,k){this.a=b;this.f=d;this.b=g;this.g=k}function Jc(b,d,g){return b.a<=d&&d<=b.f&&b.b<=g&&g<=b.g}function Kc(b,d){return b.a==d.a&&b.b==d.b&&b.f==d.f&&b.g==d.g}function Lc(b,d){return b.a<=d.f&&b.f>=d.a&&b.b<=d.g&&b.g>=d.b};function Mc(b){this.f=b.Ce;this.a=b.Th?b.Th:null};function Nc(b){lb.call(this);this.l=uc(b.ba);this.ja=Oc(b.xa);this.oa=b.Fa;this.ua=void 0!==b.state?b.state:"ready";this.qd=void 0!==b.Na?b.Na:!1}M(Nc,lb);function Oc(b){if("string"===typeof b)return[new Mc({Ce:b})];if(b instanceof Mc)return[b];if(Array.isArray(b)){for(var d=b.length,g=Array(d),k=0;k<d;k++){var p=b[k];g[k]="string"===typeof p?new Mc({Ce:p}):p}return g}return null}Nc.prototype.P=bb;Nc.prototype.kb=function(){return this.ja};Nc.prototype.W=function(){return this.ua};function Pc(b){lb.call(this);var d=ta({},b);d.opacity=void 0!==b.opacity?b.opacity:1;d.visible=void 0!==b.visible?b.visible:!0;d.zIndex=void 0!==b.zIndex?b.zIndex:0;d.maxResolution=void 0!==b.Cb?b.Cb:Infinity;d.minResolution=void 0!==b.Pb?b.Pb:0;mb(this,d)}M(Pc,lb);function Qc(b){var d=b.get("opacity"),g=b.Jd(),k=b.get("visible"),p=b.J(),q=b.get("zIndex"),u=b.get("maxResolution"),v=b.get("minResolution");return{Bb:b,opacity:Ib(d,0,1),Wd:g,visible:k,Gc:!0,D:p,zIndex:q,Cb:u,Pb:Math.max(v,0)}}
Pc.prototype.J=function(){return this.get("extent")};function Rc(){};function Sc(b,d,g,k){db.call(this,b,d);this.Mb=k}M(Sc,db);function Tc(b){var d=ta({},b);delete d.source;Pc.call(this,d);this.b=this.h=this.g=null;b.map&&this.ta(b.map);S(this,ob("source"),this.mg,this);this.set("source",b.source?b.source:null)}M(Tc,Pc);function Uc(b,d){return b.visible&&d>=b.Pb&&d<b.Cb}B=Tc.prototype;B.Hd=function(b){b=b?b:[];b.push(Qc(this));return b};B.ea=function(){return this.get("source")||null};B.Jd=function(){var b=this.ea();return b?b.W():"undefined"};B.$g=function(){this.A()};
B.mg=function(){this.b&&(Aa(this.b),this.b=null);var b=this.ea();b&&(this.b=S(b,"change",this.$g,this));this.A()};B.ta=function(b){this.g&&(Aa(this.g),this.g=null);b||this.A();this.h&&(Aa(this.h),this.h=null);b&&(this.g=S(b,"precompose",function(b){var g=Qc(this);g.Gc=!1;g.zIndex=Infinity;b.Mb.Ob.push(g);b.Mb.Fc[I(this)]=g},this),this.h=S(this,"change",b.S,b),this.A())};function Vc(b){b=b?b:{};var d=ta({},b);delete d.Qd;delete d.af;Tc.call(this,d);this.set("preload",void 0!==b.Qd?b.Qd:0);this.set("useInterimTilesOnError",void 0!==b.af?b.af:!0)}M(Vc,Tc);function Wc(b){return b.get("useInterimTilesOnError")};function Xc(b){return function(d){if(d)return[Ib(d[0],b[0],b[2]),Ib(d[1],b[1],b[3])]}}function Yc(b){return b};function Zc(b,d){return b>d?1:b<d?-1:0}function $c(b,d,g){var k=b.length;if(b[0]<=d)return 0;if(!(d<=b[k-1])){if(0<g)for(g=1;g<k;++g){if(b[g]<d)return g-1}else if(0>g)for(g=1;g<k;++g){if(b[g]<=d)return g}else for(g=1;g<k;++g){if(b[g]==d)return g;if(b[g]<d)return b[g-1]-d<d-b[g]?g-1:g}$a()}return k-1}function ad(b,d){var g,k=ha(d)?d:[d],p=k.length;for(g=0;g<p;g++)b[b.length]=k[g]}function bd(b,d){var g=b.indexOf(d),k=-1<g;k&&b.splice(g,1);return k}
function cd(b,d){var g=b.length;if(g!==d.length)return!1;for(var k=0;k<g;k++)if(b[k]!==d[k])return!1;return!0}function dd(b){var d=ed,g=b.length,k=Array(b.length),p;for(p=0;p<g;p++)k[p]={index:p,value:b[p]};k.sort(function(b,g){return d(b.value,g.value)||b.index-g.index});for(p=0;p<b.length;p++)b[p]=k[p].value};function fd(b){return function(d,g,k){if(void 0!==d)return d=$c(b,d,k),d=Ib(d+g,0,b.length-1),b[d]}}function gd(b,d,g){return function(k,p,q){if(void 0!==k)return k=Math.max(Math.floor(Math.log(d/k)/Math.log(b)+(0<q?0:0>q?1:.5))+p,0),void 0!==g&&(k=Math.min(k,g)),d/Math.pow(b,k)}};function hd(b){if(void 0!==b)return 0}function jd(b,d){if(void 0!==b)return b+d}function kd(b){var d=2*Math.PI/b;return function(b,k){if(void 0!==b)return b=Math.floor((b+k)/d+.5)*d}}function ld(){var b=5*Math.PI/180;return function(d,g){if(void 0!==d)return Math.abs(d+g)<=b?0:d+g}};function md(b,d,g){this.T=b;this.H=d;this.rotation=g};function nd(){return!0}function od(){return!1};function pd(){lb.call(this);this.G=Sb();this.M=-1;this.w={};this.oa=this.B=0}M(pd,lb);pd.prototype.ua=function(b){return this.Hc(b[0],b[1])};pd.prototype.Hc=od;pd.prototype.J=function(b){this.M!=this.f&&(this.G=this.zd(this.G),this.M=this.f);var d=this.G;b?(b[0]=d[0],b[1]=d[1],b[2]=d[2],b[3]=d[3]):b=d;return b};function qd(b,d,g,k,p,q){var u=p[0],v=p[1],w=p[4],z=p[5],A=p[12];p=p[13];for(var C=q?q:[],D=0;d<g;d+=k){var E=b[d],G=b[d+1];C[D++]=u*E+w*G+A;C[D++]=v*E+z*G+p}q&&C.length!=D&&(C.length=D);return C};function rd(){pd.call(this);this.g="XY";this.F=2;this.a=null}M(rd,pd);function sd(b){if("XY"==b)return 2;if("XYZ"==b||"XYM"==b)return 3;if("XYZM"==b)return 4;$a("unsupported layout: "+b)}B=rd.prototype;B.Hc=od;B.zd=function(b){var d=this.a,g=this.a.length,k=this.F;b=Zb(Infinity,Infinity,-Infinity,-Infinity,b);return bc(b,d,0,g,k)};
function td(b,d){b.oa!=b.f&&(ua(b.w),b.B=0,b.oa=b.f);if(0>d||0!==b.B&&d<=b.B)return b;var g=d.toString();if(b.w.hasOwnProperty(g))return b.w[g];var k=b.ec(d);if(k.a.length<b.a.length)return b.w[g]=k;b.B=d;return b}B.ec=function(){return this};function ud(b,d,g){b.F=sd(d);b.g=d;b.a=g}function vd(b,d,g,k){if(d)g=sd(d);else{for(d=0;d<k;++d){if(0===g.length){b.g="XY";b.F=2;return}g=g[0]}g=g.length;2==g?d="XY":3==g?d="XYZ":4==g?d="XYZM":($a("unsupported stride: "+g),d=void 0)}b.g=d;b.F=g}
function wd(b,d){b.a&&(d(b.a,b.a,b.F),b.A())}B.rotate=function(b,d){var g=this.a;if(g){for(var k=g.length,p=this.F,q=g?g:[],u=Math.cos(b),v=Math.sin(b),w=d[0],z=d[1],A=0,C=0;C<k;C+=p){var D=g[C]-w,E=g[C+1]-z;q[A++]=w+D*u-E*v;q[A++]=z+D*v+E*u;for(D=C+2;D<C+p;++D)q[A++]=g[D]}g&&q.length!=A&&(q.length=A);this.A()}};
B.Xa=function(b,d){var g=this.a;if(g){var k=g.length,p=this.F,q=g?g:[],u=0,v,w;for(v=0;v<k;v+=p)for(q[u++]=g[v]+b,q[u++]=g[v+1]+d,w=v+2;w<v+p;++w)q[u++]=g[w];g&&q.length!=u&&(q.length=u);this.A()}};function xd(b,d){var g=0,k,p;k=0;for(p=d.length;k<p;++k)b[g++]=d[k];return g}function yd(b,d,g,k){var p,q;p=0;for(q=g.length;p<q;++p){var u=g[p],v;for(v=0;v<k;++v)b[d++]=u[v]}return d}function zd(b,d,g,k,p){p=p?p:[];var q=0,u,v;u=0;for(v=g.length;u<v;++u)d=yd(b,d,g[u],k),p[q++]=d;p.length=q;return p};function Ad(b,d,g,k,p){p=void 0!==p?p:[];for(var q=0;d<g;d+=k)p[q++]=b.slice(d,d+k);p.length=q;return p}function Bd(b,d,g,k,p){p=void 0!==p?p:[];var q=0,u,v;u=0;for(v=g.length;u<v;++u){var w=g[u];p[q++]=Ad(b,d,w,k,p[q]);d=w}p.length=q;return p};function Cd(b,d,g,k,p,q,u){var v=(g-d)/k;if(3>v){for(;d<g;d+=k)q[u++]=b[d],q[u++]=b[d+1];return u}var w=Array(v);w[0]=1;w[v-1]=1;g=[d,g-k];for(var z=0,A;0<g.length;){var C=g.pop(),D=g.pop(),E=0,G=b[D],J=b[D+1],K=b[C],N=b[C+1];for(A=D+k;A<C;A+=k){var F,H=b[A];F=b[A+1];var O=G,Q=J,P=K-O,R=N-Q;if(0!==P||0!==R){var W=((H-O)*P+(F-Q)*R)/(P*P+R*R);1<W?(O=K,Q=N):0<W&&(O+=P*W,Q+=R*W)}H=O-H;F=Q-F;F=H*H+F*F;F>E&&(z=A,E=F)}E>p&&(w[(z-d)/k]=1,D+k<z&&g.push(D,z),z+k<C&&g.push(z,C))}for(A=0;A<v;++A)w[A]&&(q[u++]=
b[d+A*k],q[u++]=b[d+A*k+1]);return u}
function Dd(b,d,g,k,p,q,u,v){var w,z;w=0;for(z=g.length;w<z;++w){var A=g[w];a:{var C=b,D=A,E=k,G=p,J=q;if(d!=D){var K=G*Math.round(C[d]/G),N=G*Math.round(C[d+1]/G);d+=E;J[u++]=K;J[u++]=N;var F=void 0,H=void 0;do if(F=G*Math.round(C[d]/G),H=G*Math.round(C[d+1]/G),d+=E,d==D){J[u++]=F;J[u++]=H;break a}while(F==K&&H==N);for(;d<D;){var O,Q;O=G*Math.round(C[d]/G);Q=G*Math.round(C[d+1]/G);d+=E;if(O!=F||Q!=H){var P=F-K,R=H-N,W=O-K,L=Q-N;P*L==R*W&&(0>P&&W<P||P==W||0<P&&W>P)&&(0>R&&L<R||R==L||0<R&&L>R)||(J[u++]=
F,J[u++]=H,K=F,N=H);F=O;H=Q}}J[u++]=F;J[u++]=H}}v.push(u);d=A}return u};function Ed(b,d){rd.call(this);this.wa(b,d)}M(Ed,rd);B=Ed.prototype;B.clone=function(){var b=new Ed(null);ud(b,this.g,this.a.slice());b.A();return b};B.sa=function(){return Ad(this.a,0,this.a.length,this.F)};B.ec=function(b){var d=[];d.length=Cd(this.a,0,this.a.length,this.F,b,d,0);b=new Ed(null);ud(b,"XY",d);b.A();return b};B.ka=function(){return"LinearRing"};B.wa=function(b,d){b?(vd(this,d,b,1),this.a||(this.a=[]),this.a.length=yd(this.a,0,b,this.F)):ud(this,"XY",null);this.A()};function Fd(b,d){rd.call(this);this.wa(b,d)}M(Fd,rd);B=Fd.prototype;B.clone=function(){var b=new Fd(null);ud(b,this.g,this.a.slice());b.A();return b};B.sa=function(){return this.a?this.a.slice():[]};B.zd=function(b){return $b(this.a,b)};B.ka=function(){return"Point"};B.eb=function(b){return Xb(b,this.a[0],this.a[1])};B.wa=function(b,d){b?(vd(this,d,b,0),this.a||(this.a=[]),this.a.length=xd(this.a,b)):ud(this,"XY",null);this.A()};function Gd(b,d,g,k,p){return!cc(p,function(p){return!Hd(b,d,g,k,p[0],p[1])})}function Hd(b,d,g,k,p,q){for(var u=!1,v=b[g-k],w=b[g-k+1];d<g;d+=k){var z=b[d],A=b[d+1];w>q!=A>q&&p<(z-v)*(q-w)/(A-w)+v&&(u=!u);v=z;w=A}return u}function Id(b,d,g,k,p,q){if(0===g.length||!Hd(b,d,g[0],k,p,q))return!1;var u;d=1;for(u=g.length;d<u;++d)if(Hd(b,g[d-1],g[d],k,p,q))return!1;return!0};function Jd(b,d,g,k,p,q,u){var v,w,z,A,C,D=p[q+1],E=[],G=g[0];z=b[G-k];C=b[G-k+1];for(v=d;v<G;v+=k){A=b[v];w=b[v+1];if(D<=C&&w<=D||C<=D&&D<=w)z=(D-C)/(w-C)*(A-z)+z,E.push(z);z=A;C=w}G=NaN;C=-Infinity;E.sort(Zc);z=E[0];v=1;for(w=E.length;v<w;++v){A=E[v];var J=Math.abs(A-z);J>C&&(z=(z+A)/2,Id(b,d,g,k,z,D)&&(G=z,C=J));z=A}isNaN(G)&&(G=p[q]);return u?(u.push(G,D),u):[G,D]};function Kd(b,d,g,k,p){for(var q=[b[d],b[d+1]],u=[],v;d+k<g;d+=k){u[0]=b[d+k];u[1]=b[d+k+1];if(v=p.call(void 0,q,u))return v;q[0]=u[0];q[1]=u[1]}return!1};function Ld(b,d,g,k,p){var q=bc(Sb(),b,d,g,k);return mc(p,q)?Wb(p,q)||q[0]>=p[0]&&q[2]<=p[2]||q[1]>=p[1]&&q[3]<=p[3]?!0:Kd(b,d,g,k,function(b,d){var g=!1,k=Yb(p,b),q=Yb(p,d);if(1===k||1===q)g=!0;else{var C=p[0],D=p[1],E=p[2],G=p[3],J=d[0],K=d[1],N=(K-b[1])/(J-b[0]);q&2&&!(k&2)&&(g=J-(K-G)/N,g=g>=C&&g<=E);g||!(q&4)||k&4||(g=K-(J-E)*N,g=g>=D&&g<=G);g||!(q&8)||k&8||(g=J-(K-D)/N,g=g>=C&&g<=E);g||!(q&16)||k&16||(g=K-(J-C)*N,g=g>=D&&g<=G)}return g}):!1}
function Md(b,d,g,k,p){var q=g[0];if(!(Ld(b,d,q,k,p)||Hd(b,d,q,k,p[0],p[1])||Hd(b,d,q,k,p[0],p[3])||Hd(b,d,q,k,p[2],p[1])||Hd(b,d,q,k,p[2],p[3])))return!1;if(1===g.length)return!0;d=1;for(q=g.length;d<q;++d)if(Gd(b,g[d-1],g[d],k,p))return!1;return!0};function Nd(b,d,g,k){for(var p=0,q=b[g-k],u=b[g-k+1];d<g;d+=k)var v=b[d],w=b[d+1],p=p+(v-q)*(w+u),q=v,u=w;return 0<p}function Od(b,d,g,k){var p=0;k=void 0!==k?k:!1;var q,u;q=0;for(u=d.length;q<u;++q){var v=d[q],p=Nd(b,p,v,g);if(0===q){if(k&&p||!k&&!p)return!1}else if(k&&!p||!k&&p)return!1;p=v}return!0}
function Pd(b,d,g,k,p){p=void 0!==p?p:!1;var q,u;q=0;for(u=g.length;q<u;++q){var v=g[q],w=Nd(b,d,v,k);if(0===q?p&&w||!p&&!w:p&&!w||!p&&w)for(var w=b,z=v,A=k;d<z-A;){var C;for(C=0;C<A;++C){var D=w[d+C];w[d+C]=w[z-A+C];w[z-A+C]=D}d+=A;z-=A}d=v}return d}function Qd(b,d,g,k){var p=0,q,u;q=0;for(u=d.length;q<u;++q)p=Pd(b,p,d[q],g,k);return p};function Rd(b,d){rd.call(this);this.b=[];this.P=-1;this.V=null;this.ca=-1;this.j=null;this.wa(b,d)}M(Rd,rd);B=Rd.prototype;B.clone=function(){var b=new Rd(null),d=this.b.slice();ud(b,this.g,this.a.slice());b.b=d;b.A();return b};B.Hc=function(b,d){return Id(Sd(this),0,this.b,this.F,b,d)};B.sa=function(b){var d;void 0!==b?(d=Sd(this).slice(),Pd(d,0,this.b,this.F,b)):d=this.a;return Bd(d,0,this.b,this.F)};B.Ac=function(){return this.b};
function Td(b){if(b.P!=b.f){var d=jc(b.J());b.V=Jd(Sd(b),0,b.b,b.F,d,0);b.P=b.f}return b.V}function Sd(b){if(b.ca!=b.f){var d=b.a;Od(d,b.b,b.F)?b.j=d:(b.j=d.slice(),b.j.length=Pd(b.j,0,b.b,b.F));b.ca=b.f}return b.j}B.ec=function(b){var d=[],g=[];d.length=Dd(this.a,0,this.b,this.F,Math.sqrt(b),d,0,g);b=new Rd(null);ud(b,"XY",d);b.b=g;b.A();return b};B.ka=function(){return"Polygon"};B.eb=function(b){return Md(Sd(this),0,this.b,this.F,b)};
B.wa=function(b,d){if(b){vd(this,d,b,2);this.a||(this.a=[]);var g=zd(this.a,0,b,this.F,this.b);this.a.length=0===g.length?0:g[g.length-1]}else g=this.b,ud(this,"XY",null),this.b=g;this.A()};function Ud(b){var d;lb.call(this);b=b||{};this.b=[0,0];var g={};g.center=void 0!==b.T?b.T:null;this.g=Ec(b.ba);var k,p,q=void 0!==b.wb?b.wb:0;d=void 0!==b.kc?b.kc:28;var u=void 0!==b.ki?b.ki:2;if(void 0!==b.yb)d=b.yb,k=d[0],p=d[d.length-1],d=fd(d);else{k=Ec(b.ba);p=k.J();var v=(p?Math.max(hc(p),ic(p)):360*qc.degrees/yc(k))/256/Math.pow(2,0),w=v/Math.pow(2,28);k=b.Cb;void 0!==k?q=0:k=v/Math.pow(u,q);p=b.Pb;void 0===p&&(p=void 0!==b.kc?void 0!==b.Cb?k/Math.pow(u,d):v/Math.pow(u,d):w);d=q+Math.floor(Math.log(k/
p)/Math.log(u));p=k/Math.pow(u,d-q);d=gd(u,k,d-q)}this.h=k;this.i=p;this.j=q;q=void 0!==b.D?Xc(b.D):Yc;k=Vd(b);this.a=new md(q,d,k);void 0!==b.H?g.resolution=b.H:void 0!==b.zoom&&(g.resolution=this.a.H(this.h,b.zoom-this.j||0,0));g.rotation=void 0!==b.rotation?b.rotation:0;mb(this,g)}M(Ud,lb);B=Ud.prototype;B.Ad=function(b,d){return this.a.rotation(b,d||0)};function Wd(b){return b.get("center")}B.O=function(){return this.get("resolution")};B.ha=function(){return this.get("rotation")};
B.W=function(){var b=Wd(this),d=this.g,g=this.O(),k=this.ha();return{T:[Math.round(b[0]/g)*g,Math.round(b[1]/g)*g],ba:void 0!==d?d:null,H:g,rotation:k}};B.rotate=function(b,d){if(void 0!==d){var g,k=Wd(this);void 0!==k&&(g=[k[0]-d[0],k[1]-d[1]],Ob(g,b-this.ha()),Lb(g,d));Xd(this,g)}this.Vb(b)};function Xd(b,d){b.set("center",d)}function Yd(b,d){b.b[1]+=d}B.Vb=function(b){this.set("rotation",b)};
function Vd(b){if(void 0!==b.Kf?b.Kf:1){b=b.Ad;if(void 0===b||!0===b)return ld();if(!1===b)return jd;if(ja(b))return kd(b);$a("illegal option for constrainRotation (%s)",b);return jd}return hd};function Zd(){return!0}function $d(b){var d=arguments,g=d.length;return function(){for(var b=0;b<g;b++)if(!d[b].apply(this,arguments))return!1;return!0}};var ae=Array.prototype.indexOf?function(b,d,g){return Array.prototype.indexOf.call(b,d,g)}:function(b,d,g){g=null==g?0:0>g?Math.max(0,b.length+g):g;if(ia(b))return ia(d)&&1==d.length?b.indexOf(d,g):-1;for(;g<b.length;g++)if(g in b&&b[g]===d)return g;return-1},be=Array.prototype.forEach?function(b,d,g){Array.prototype.forEach.call(b,d,g)}:function(b,d,g){for(var k=b.length,p=ia(b)?b.split(""):b,q=0;q<k;q++)q in p&&d.call(g,p[q],q,b)};
function ce(b){var d=b.length;if(0<d){for(var g=Array(d),k=0;k<d;k++)g[k]=b[k];return g}return[]}function de(b,d,g){return 2>=arguments.length?Array.prototype.slice.call(b,d):Array.prototype.slice.call(b,d,g)};var Va;a:{var ee=aa.navigator;if(ee){var fe=ee.userAgent;if(fe){Va=fe;break a}}Va=""}function ge(b){return-1!=Va.indexOf(b)};function he(b,d){for(var g in b)d.call(void 0,b[g],g,b)}var ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function je(b,d){for(var g,k,p=1;p<arguments.length;p++){k=arguments[p];for(g in k)b[g]=k[g];for(var q=0;q<ie.length;q++)g=ie[q],Object.prototype.hasOwnProperty.call(k,g)&&(b[g]=k[g])}};function ke(){return ge("Opera")||ge("OPR")}function le(){return ge("Trident")||ge("MSIE")}function me(){return(ge("Chrome")||ge("CriOS"))&&!ke()&&!ge("Edge")};function ne(){return ge("Edge")}function oe(){return ge("Gecko")&&!(Ua()&&!ne())&&!(ge("Trident")||ge("MSIE"))&&!ne()};var pe;
function qe(){var b=aa.MessageChannel;"undefined"===typeof b&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!ge("Presto")&&(b=function(){var b=document.createElement("IFRAME");b.style.display="none";b.src="";document.documentElement.appendChild(b);var d=b.contentWindow,b=d.document;b.open();b.write("");b.close();var g="callImmediate"+Math.random(),k="file:"==d.location.protocol?"*":d.location.protocol+"//"+d.location.host,b=qa(function(b){if(("*"==k||b.origin==k)&&b.data==
g)this.port1.onmessage()},this);d.addEventListener("message",b,!1);this.port1={};this.port2={postMessage:function(){d.postMessage(g,k)}}});if("undefined"!==typeof b&&!le()){var d=new b,g={},k=g;d.port1.onmessage=function(){if(void 0!==g.next){g=g.next;var b=g.le;g.le=null;b()}};return function(b){k.next={le:b};k=k.next;d.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(b){var d=document.createElement("SCRIPT");d.onreadystatechange=
function(){d.onreadystatechange=null;d.parentNode.removeChild(d);d=null;b();b=null};document.documentElement.appendChild(d)}:function(b){aa.setTimeout(b,0)}};var re=ke(),se=le(),te=ne(),ue=oe(),ve=Ua()&&!ne();function we(){var b=aa.document;return b?b.documentMode:void 0}var xe;a:{var ye="",ze=function(){var b=Va;if(ue)return/rv\:([^\);]+)(\)|;)/.exec(b);if(te)return/Edge\/([\d\.]+)/.exec(b);if(se)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(b);if(ve)return/WebKit\/(\S+)/.exec(b);if(re)return/(?:Version)[ \/]?(\S+)/.exec(b)}();ze&&(ye=ze?ze[1]:"");if(se){var Ae=we();if(null!=Ae&&Ae>parseFloat(ye)){xe=String(Ae);break a}}xe=ye}var Be={};
function Ce(b){var d;if(!(d=Be[b])){d=0;for(var g=Ka(String(xe)).split("."),k=Ka(String(b)).split("."),p=Math.max(g.length,k.length),q=0;0==d&&q<p;q++){var u=g[q]||"",v=k[q]||"",w=RegExp("(\\d*)(\\D*)","g"),z=RegExp("(\\d*)(\\D*)","g");do{var A=w.exec(u)||["","",""],C=z.exec(v)||["","",""];if(0==A[0].length&&0==C[0].length)break;d=Wa(0==A[1].length?0:parseInt(A[1],10),0==C[1].length?0:parseInt(C[1],10))||Wa(0==A[2].length,0==C[2].length)||Wa(A[2],C[2])}while(0==d)}d=Be[b]=0<=d}return d}
var De=aa.document,Ee=De&&se?we()||("CSS1Compat"==De.compatMode?parseInt(xe,10):5):void 0;var Fe=!se||9<=Number(Ee);!ue&&!se||se&&9<=Number(Ee)||ue&&Ce("1.9.1");se&&Ce("9");function Ge(b,d){this.x=void 0!==b?b:0;this.y=void 0!==d?d:0}B=Ge.prototype;B.clone=function(){return new Ge(this.x,this.y)};B.toString=function(){return"("+this.x+", "+this.y+")"};B.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};B.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};B.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};B.scale=function(b,d){var g=ja(d)?d:b;this.x*=b;this.y*=g;return this};function He(b,d){this.width=b;this.height=d}B=He.prototype;B.clone=function(){return new He(this.width,this.height)};B.toString=function(){return"("+this.width+" x "+this.height+")"};B.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};B.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};B.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
B.scale=function(b,d){var g=ja(d)?d:b;this.width*=b;this.height*=g;return this};function Ie(b){return b?new Je(Ke(b)):Ia||(Ia=new Je)}function Le(b){var d=document;return ia(b)?d.getElementById(b):b}function Me(b,d){he(d,function(d,k){"style"==k?b.style.cssText=d:"class"==k?b.className=d:"for"==k?b.htmlFor=d:Ne.hasOwnProperty(k)?b.setAttribute(Ne[k],d):0==k.lastIndexOf("aria-",0)||0==k.lastIndexOf("data-",0)?b.setAttribute(k,d):b[k]=d})}
var Ne={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Oe(b,d,g){var k=arguments,p=document,q=k[0],u=k[1];if(!Fe&&u&&(u.name||u.type)){q=["<",q];u.name&&q.push(' name="',La(u.name),'"');if(u.type){q.push(' type="',La(u.type),'"');var v={};je(v,u);delete v.type;u=v}q.push(">");q=q.join("")}q=p.createElement(q);u&&(ia(u)?q.className=u:ga(u)?q.className=u.join(" "):Me(q,u));2<k.length&&Pe(p,q,k);return q}
function Pe(b,d,g){function k(g){g&&d.appendChild(ia(g)?b.createTextNode(g):g)}for(var p=2;p<g.length;p++){var q=g[p];!ha(q)||la(q)&&0<q.nodeType?k(q):be(Qe(q)?ce(q):q,k)}}function Re(b,d){b.appendChild(d)}function Se(b){for(var d;d=b.firstChild;)b.removeChild(d)}function Te(b,d,g){b.insertBefore(d,b.childNodes[g]||null)}function Ue(b){b&&b.parentNode&&b.parentNode.removeChild(b)}function Ve(b,d){var g=d.parentNode;g&&g.replaceChild(b,d)}
function We(b,d){if(!b||!d)return!1;if(b.contains&&1==d.nodeType)return b==d||b.contains(d);if("undefined"!=typeof b.compareDocumentPosition)return b==d||!!(b.compareDocumentPosition(d)&16);for(;d&&b!=d;)d=d.parentNode;return d==b}function Ke(b){return 9==b.nodeType?b:b.ownerDocument||b.document}function Qe(b){if(b&&"number"==typeof b.length){if(la(b))return"function"==typeof b.item||"string"==typeof b.item;if(ka(b))return"function"==typeof b.item}return!1}
function Je(b){this.a=b||aa.document||document}Je.prototype.appendChild=Re;function Xe(b,d,g,k){this.top=b;this.right=d;this.bottom=g;this.left=k}B=Xe.prototype;B.clone=function(){return new Xe(this.top,this.right,this.bottom,this.left)};B.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};B.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};
B.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};B.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};B.scale=function(b,d){var g=ja(d)?d:b;this.left*=b;this.right*=b;this.top*=g;this.bottom*=g;return this};function Ye(b,d,g){if(ia(d))(d=Ze(b,d))&&(b.style[d]=g);else for(var k in d){g=b;var p=d[k],q=Ze(g,k);q&&(g.style[q]=p)}}var $e={};function Ze(b,d){var g=$e[d];if(!g){var k=Xa(d),g=k;void 0===b.style[k]&&(k=(ve?"Webkit":ue?"Moz":se?"ms":re?"O":null)+Ya(k),void 0!==b.style[k]&&(g=k));$e[d]=g}return g}function af(b,d){var g=Ke(b);return g.defaultView&&g.defaultView.getComputedStyle&&(g=g.defaultView.getComputedStyle(b,null))?g[d]||g.getPropertyValue(d)||"":""}
function bf(b){var d;try{d=b.getBoundingClientRect()}catch(g){return{left:0,top:0,right:0,bottom:0}}se&&b.ownerDocument.body&&(b=b.ownerDocument,d.left-=b.documentElement.clientLeft+b.body.clientLeft,d.top-=b.documentElement.clientTop+b.body.clientTop);return d}
function cf(b){var d=df;if("none"!=(af(b,"display")||(b.currentStyle?b.currentStyle.display:null)||b.style&&b.style.display))return d(b);var g=b.style,k=g.display,p=g.visibility,q=g.position;g.visibility="hidden";g.position="absolute";g.display="inline";b=d(b);g.display=k;g.position=q;g.visibility=p;return b}function df(b){var d=b.offsetWidth,g=b.offsetHeight,k=ve&&!d&&!g;return(void 0===d||k)&&b.getBoundingClientRect?(b=bf(b),new He(b.right-b.left,b.bottom-b.top)):new He(d,g)}
function ef(b,d){b.style.display=d?"":"none"}function ff(b,d,g,k){if(/^\d+px?$/.test(d))return parseInt(d,10);var p=b.style[g],q=b.runtimeStyle[g];b.runtimeStyle[g]=b.currentStyle[g];b.style[g]=d;d=b.style[k];b.style[g]=p;b.runtimeStyle[g]=q;return d}function gf(b,d){var g=b.currentStyle?b.currentStyle[d]:null;return g?ff(b,g,"left","pixelLeft"):0}var hf={thin:2,medium:4,thick:6};
function jf(b,d){if("none"==(b.currentStyle?b.currentStyle[d+"Style"]:null))return 0;var g=b.currentStyle?b.currentStyle[d+"Width"]:null;return g in hf?hf[g]:ff(b,g,"left","pixelLeft")};function kf(b,d,g){db.call(this,b);this.map=d;this.Mb=void 0!==g?g:null}M(kf,db);function lf(b,d,g){db.call(this,b);this.a=d;b=g?g:{};this.buttons=mf(b);this.pressure=nf(b,this.buttons);this.bubbles="bubbles"in b?b.bubbles:!1;this.cancelable="cancelable"in b?b.cancelable:!1;this.view="view"in b?b.view:null;this.detail="detail"in b?b.detail:null;this.screenX="screenX"in b?b.screenX:0;this.screenY="screenY"in b?b.screenY:0;this.clientX="clientX"in b?b.clientX:0;this.clientY="clientY"in b?b.clientY:0;this.button="button"in b?b.button:0;this.relatedTarget="relatedTarget"in b?b.relatedTarget:
null;this.pointerId="pointerId"in b?b.pointerId:0;this.width="width"in b?b.width:0;this.height="height"in b?b.height:0;this.pointerType="pointerType"in b?b.pointerType:"";this.isPrimary="isPrimary"in b?b.isPrimary:!1;d.preventDefault&&(this.preventDefault=function(){d.preventDefault()})}M(lf,db);function mf(b){if(b.buttons||of)b=b.buttons;else switch(b.which){case 1:b=1;break;case 2:b=4;break;case 3:b=2;break;default:b=0}return b}
function nf(b,d){var g=0;b.pressure?g=b.pressure:g=d?.5:0;return g}var of=!1;try{of=1===(new MouseEvent("click",{buttons:1})).buttons}catch(b){};function pf(b,d){var g=document.createElement("CANVAS");b&&(g.width=b);d&&(g.height=d);return g.getContext("2d")}
var qf=function(){var b;return function(){if(void 0===b){var d=document.createElement("P"),g,k={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.appendChild(d);for(var p in k)p in d.style&&(d.style[p]="translate(1px,1px)",g=aa.getComputedStyle(d).getPropertyValue(k[p]));document.body.removeChild(d);b=g&&"none"!==g}return b}}(),rf=function(){var b;return function(){if(void 0===b){var d=document.createElement("P"),
g,k={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.appendChild(d);for(var p in k)p in d.style&&(d.style[p]="translate3d(1px,1px,1px)",g=aa.getComputedStyle(d).getPropertyValue(k[p]));document.body.removeChild(d);b=g&&"none"!==g}return b}}();
function sf(b,d){var g=b.style;g.WebkitTransform=d;g.MozTransform=d;g.a=d;g.msTransform=d;g.transform=d;se&&Ce("9.0")&&(b.style.transformOrigin="0 0")}function tf(b,d){var g;if(rf()){var k=Array(16);for(g=0;16>g;++g)k[g]=d[g].toFixed(6);sf(b,"matrix3d("+k.join(",")+")")}else if(qf()){var k=[d[0],d[1],d[4],d[5],d[12],d[13]],p=Array(6);for(g=0;6>g;++g)p[g]=k[g].toFixed(6);sf(b,"matrix("+p.join(",")+")")}else b.style.left=Math.round(d[12])+"px",b.style.top=Math.round(d[13])+"px"};var uf=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function vf(b,d){var g,k,p=uf.length;for(k=0;k<p;++k)try{if(g=b.getContext(uf[k],d))return g}catch(q){}return null};var wf,xf="undefined"!==typeof navigator?navigator.userAgent.toLowerCase():"",yf=-1!==xf.indexOf("firefox"),zf=-1!==xf.indexOf("safari")&&-1===xf.indexOf("chrom"),Af=-1!==xf.indexOf("macintosh"),Bf=aa.devicePixelRatio||1,Cf=!1,Df=function(){if(!("HTMLCanvasElement"in aa))return!1;try{var b=pf();return b?(void 0!==b.setLineDash&&(Cf=!0),!0):!1}catch(d){return!1}}(),Ef="ontouchstart"in aa,Ff="PointerEvent"in aa,Gf=!!aa.navigator.msPointerEnabled,Hf=!1,If=[];
if("WebGLRenderingContext"in aa)try{var Jf=vf(document.createElement("CANVAS"),{failIfMajorPerformanceCaveat:!0});Jf&&(Hf=!0,If=Jf.getSupportedExtensions())}catch(b){}wf=Hf;sa=If;function Kf(b,d){this.a=b;this.h=d};function Lf(b){Kf.call(this,b,{mousedown:this.Jg,mousemove:this.Kg,mouseup:this.Ng,mouseover:this.Mg,mouseout:this.Lg});this.f=b.f;this.b=[]}M(Lf,Kf);function Mf(b,d){for(var g=b.b,k=d.clientX,p=d.clientY,q=0,u=g.length,v;q<u&&(v=g[q]);q++){var w=Math.abs(p-v[1]);if(25>=Math.abs(k-v[0])&&25>=w)return!0}return!1}function Nf(b){var d=Of(b,b),g=d.preventDefault;d.preventDefault=function(){b.preventDefault();g()};d.pointerId=1;d.isPrimary=!0;d.pointerType="mouse";return d}B=Lf.prototype;
B.Jg=function(b){if(!Mf(this,b)){if((1).toString()in this.f){var d=Nf(b);Pf(this.a,Qf,d,b);delete this.f[(1).toString()]}d=Nf(b);this.f[(1).toString()]=b;Pf(this.a,Rf,d,b)}};B.Kg=function(b){if(!Mf(this,b)){var d=Nf(b);Pf(this.a,Sf,d,b)}};B.Ng=function(b){if(!Mf(this,b)){var d=this.f[(1).toString()];d&&d.button===b.button&&(d=Nf(b),Pf(this.a,Tf,d,b),delete this.f[(1).toString()])}};B.Mg=function(b){if(!Mf(this,b)){var d=Nf(b);Uf(this.a,d,b)}};
B.Lg=function(b){if(!Mf(this,b)){var d=Nf(b);Vf(this.a,d,b)}};function Wf(b){Kf.call(this,b,{MSPointerDown:this.Sg,MSPointerMove:this.Tg,MSPointerUp:this.Wg,MSPointerOut:this.Ug,MSPointerOver:this.Vg,MSPointerCancel:this.Rg,MSGotPointerCapture:this.Pg,MSLostPointerCapture:this.Qg});this.f=b.f;this.b=["","unavailable","touch","pen","mouse"]}M(Wf,Kf);function Xf(b,d){var g=d;ja(d.pointerType)&&(g=Of(d,d),g.pointerType=b.b[d.pointerType]);return g}B=Wf.prototype;B.Sg=function(b){this.f[b.pointerId.toString()]=b;var d=Xf(this,b);Pf(this.a,Rf,d,b)};
B.Tg=function(b){var d=Xf(this,b);Pf(this.a,Sf,d,b)};B.Wg=function(b){var d=Xf(this,b);Pf(this.a,Tf,d,b);delete this.f[b.pointerId.toString()]};B.Ug=function(b){var d=Xf(this,b);Vf(this.a,d,b)};B.Vg=function(b){var d=Xf(this,b);Uf(this.a,d,b)};B.Rg=function(b){var d=Xf(this,b);Pf(this.a,Qf,d,b);delete this.f[b.pointerId.toString()]};B.Qg=function(b){T(this.a,new lf("lostpointercapture",b,b))};B.Pg=function(b){T(this.a,new lf("gotpointercapture",b,b))};function Yf(b){Kf.call(this,b,{pointerdown:this.uh,pointermove:this.vh,pointerup:this.yh,pointerout:this.wh,pointerover:this.xh,pointercancel:this.th,gotpointercapture:this.Uf,lostpointercapture:this.Eg})}M(Yf,Kf);B=Yf.prototype;B.uh=function(b){Zf(this.a,b)};B.vh=function(b){Zf(this.a,b)};B.yh=function(b){Zf(this.a,b)};B.wh=function(b){Zf(this.a,b)};B.xh=function(b){Zf(this.a,b)};B.th=function(b){Zf(this.a,b)};B.Eg=function(b){Zf(this.a,b)};B.Uf=function(b){Zf(this.a,b)};function $f(b,d){Kf.call(this,b,{touchstart:this.Zh,touchmove:this.Yh,touchend:this.Xh,touchcancel:this.Wh});this.f=b.f;this.j=d;this.b=void 0;this.i=0;this.g=void 0}M($f,Kf);B=$f.prototype;B.Xe=function(){this.i=0;this.g=void 0};
function ag(b,d,g){d=Of(d,g);d.pointerId=g.identifier+2;d.bubbles=!0;d.cancelable=!0;d.detail=b.i;d.button=0;d.buttons=1;d.width=g.webkitRadiusX||g.radiusX||0;d.height=g.webkitRadiusY||g.radiusY||0;d.pressure=g.webkitForce||g.force||.5;d.isPrimary=b.b===g.identifier;d.pointerType="touch";d.clientX=g.clientX;d.clientY=g.clientY;d.screenX=g.screenX;d.screenY=g.screenY;return d}
function bg(b,d,g){function k(){d.preventDefault()}var p=Array.prototype.slice.call(d.changedTouches),q=p.length,u,v;for(u=0;u<q;++u)v=ag(b,d,p[u]),v.preventDefault=k,g.call(b,d,v)}
B.Zh=function(b){var d=b.touches,g=Object.keys(this.f),k=g.length;if(k>=d.length){var p=[],q,u,v;for(q=0;q<k;++q){u=g[q];v=this.f[u];var w;if(!(w=1==u))a:{w=d.length;for(var z=void 0,A=0;A<w;A++)if(z=d[A],z.identifier===u-2){w=!0;break a}w=!1}w||p.push(v.xb)}for(q=0;q<p.length;++q)this.vd(b,p[q])}d=b.changedTouches[0];g=Object.keys(this.f).length;if(0===g||1===g&&(1).toString()in this.f)this.b=d.identifier,void 0!==this.g&&aa.clearTimeout(this.g);cg(this,b);this.i++;bg(this,b,this.nh)};
B.nh=function(b,d){this.f[d.pointerId]={target:d.target,xb:d,Te:d.target};var g=this.a;d.bubbles=!0;Pf(g,dg,d,b);g=this.a;d.bubbles=!1;Pf(g,eg,d,b);Pf(this.a,Rf,d,b)};B.Yh=function(b){b.preventDefault();bg(this,b,this.Og)};B.Og=function(b,d){var g=this.f[d.pointerId];if(g){var k=g.xb,p=g.Te;Pf(this.a,Sf,d,b);k&&p!==d.target&&(k.relatedTarget=d.target,d.relatedTarget=p,k.target=p,d.target?(Vf(this.a,k,b),Uf(this.a,d,b)):(d.target=p,d.relatedTarget=null,this.vd(b,d)));g.xb=d;g.Te=d.target}};
B.Xh=function(b){cg(this,b);bg(this,b,this.ai)};B.ai=function(b,d){Pf(this.a,Tf,d,b);this.a.xb(d,b);var g=this.a;d.bubbles=!1;Pf(g,fg,d,b);delete this.f[d.pointerId];d.isPrimary&&(this.b=void 0,this.g=aa.setTimeout(this.Xe.bind(this),200))};B.Wh=function(b){bg(this,b,this.vd)};B.vd=function(b,d){Pf(this.a,Qf,d,b);this.a.xb(d,b);var g=this.a;d.bubbles=!1;Pf(g,fg,d,b);delete this.f[d.pointerId];d.isPrimary&&(this.b=void 0,this.g=aa.setTimeout(this.Xe.bind(this),200))};
function cg(b,d){var g=b.j.b,k=d.changedTouches[0];if(b.b===k.identifier){var p=[k.clientX,k.clientY];g.push(p);aa.setTimeout(function(){bd(g,p)},2500)}};function gg(b){gb.call(this);this.h=b;this.f={};this.g={};this.a=[];Ff?hg(this,new Yf(this)):Gf?hg(this,new Wf(this)):(b=new Lf(this),hg(this,b),Ef&&hg(this,new $f(this,b)));b=this.a.length;for(var d,g=0;g<b;g++)d=this.a[g],ig(this,Object.keys(d.h))}M(gg,gb);function hg(b,d){var g=Object.keys(d.h);g&&(g.forEach(function(b){var g=d.h[b];g&&(this.g[b]=g.bind(d))},b),b.a.push(d))}gg.prototype.b=function(b){var d=this.g[b.type];d&&d(b)};
function ig(b,d){d.forEach(function(b){S(this.h,b,this.b,this)},b)}function jg(b,d){d.forEach(function(b){Fa(this.h,b,this.b,this)},b)}function Of(b,d){for(var g={},k,p=0,q=kg.length;p<q;p++)k=kg[p][0],g[k]=b[k]||d[k]||kg[p][1];return g}gg.prototype.xb=function(b,d){b.bubbles=!0;Pf(this,lg,b,d)};function Vf(b,d,g){b.xb(d,g);var k=d.relatedTarget;k&&We(d.target,k)||(d.bubbles=!1,Pf(b,fg,d,g))}
function Uf(b,d,g){d.bubbles=!0;Pf(b,dg,d,g);var k=d.relatedTarget;k&&We(d.target,k)||(d.bubbles=!1,Pf(b,eg,d,g))}function Pf(b,d,g,k){T(b,new lf(d,k,g))}function Zf(b,d){T(b,new lf(d.type,d,d))}gg.prototype.aa=function(){for(var b=this.a.length,d,g=0;g<b;g++)d=this.a[g],jg(this,Object.keys(d.h));gg.Aa.aa.call(this)};
var Sf="pointermove",Rf="pointerdown",Tf="pointerup",dg="pointerover",lg="pointerout",eg="pointerenter",fg="pointerleave",Qf="pointercancel",kg=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",
!1],["type",""],["target",null],["currentTarget",null],["which",0]];function mg(b,d,g,k,p){kf.call(this,b,d,p);this.a=g;b=d.a.getBoundingClientRect();g=g.changedTouches?g.changedTouches[0]:g;this.f=[g.clientX-b.left,g.clientY-b.top];this.b=d.Pa(this.f);this.h=void 0!==k?k:!1}M(mg,kf);mg.prototype.preventDefault=function(){mg.Aa.preventDefault.call(this);this.a.preventDefault()};mg.prototype.stopPropagation=function(){mg.Aa.stopPropagation.call(this);this.a.stopPropagation()};function ng(b,d,g,k,p){mg.call(this,b,d,g.a,k,p);this.g=g}M(ng,mg);
function og(b){gb.call(this);this.b=b;this.i=0;this.j=!1;this.g=[];this.f=null;b=this.b.a;this.w=0;this.u={};this.h=new gg(b);this.a=null;this.l=S(this.h,Rf,this.hg,this);this.s=S(this.h,Sf,this.Bh,this)}M(og,gb);function pg(b,d){var g;g=new ng(qg,b.b,d);T(b,g);0!==b.i?(aa.clearTimeout(b.i),b.i=0,g=new ng(rg,b.b,d),T(b,g)):b.i=aa.setTimeout(function(){this.i=0;var b=new ng(sg,this.b,d);T(this,b)}.bind(b),250)}
function tg(b,d){d.type==ug||d.type==vg?delete b.u[d.pointerId]:d.type==wg&&(b.u[d.pointerId]=!0);b.w=Object.keys(b.u).length}B=og.prototype;B.Be=function(b){tg(this,b);var d=new ng(ug,this.b,b);T(this,d);!this.j&&0===b.button&&pg(this,this.f);0===this.w&&(this.g.forEach(Aa),this.g.length=0,this.j=!1,this.f=null,this.a.qa(),this.a=null)};
B.hg=function(b){tg(this,b);var d=new ng(wg,this.b,b);T(this,d);this.f=b;0===this.g.length&&(this.a=new gg(document),this.g.push(S(this.a,xg,this.Zg,this),S(this.a,ug,this.Be,this),S(this.h,vg,this.Be,this)))};B.Zg=function(b){if(b.clientX!=this.f.clientX||b.clientY!=this.f.clientY){this.j=!0;var d=new ng(yg,this.b,b,this.j);T(this,d)}b.preventDefault()};B.Bh=function(b){T(this,new ng(b.type,this.b,b,!(!this.f||b.clientX==this.f.clientX&&b.clientY==this.f.clientY)))};
B.aa=function(){this.s&&(Aa(this.s),this.s=null);this.l&&(Aa(this.l),this.l=null);this.g.forEach(Aa);this.g.length=0;this.a&&(this.a.qa(),this.a=null);this.h&&(this.h.qa(),this.h=null);og.Aa.aa.call(this)};var sg="singleclick",qg="click",rg="dblclick",yg="pointerdrag",xg="pointermove",wg="pointerdown",ug="pointerup",vg="pointercancel",zg={Bi:sg,pi:qg,ri:rg,ui:yg,xi:xg,ti:wg,Ai:ug,zi:"pointerover",yi:"pointerout",vi:"pointerenter",wi:"pointerleave",si:vg};function Ag(b,d,g,k,p){gb.call(this);this.l=p;this.D=b;this.h=g;this.H=d;this.state=k}M(Ag,gb);B=Ag.prototype;B.A=function(){T(this,"change")};B.kb=function(){return this.l};B.J=function(){return this.D};B.O=function(){return this.H};B.W=function(){return this.state};function Bg(b,d){gb.call(this);this.na=b;this.state=d;this.a=null;this.g=""}M(Bg,gb);Bg.prototype.A=function(){T(this,"change")};Bg.prototype.getKey=function(){return I(this).toString()};Bg.prototype.W=function(){return this.state};function Cg(){this.g=0;this.b={};this.f=this.a=null}B=Cg.prototype;B.clear=function(){this.g=0;this.b={};this.f=this.a=null};function Dg(b,d){return b.b.hasOwnProperty(d)}B.forEach=function(b,d){for(var g=this.a;g;)b.call(d,g.$b,g.Kd,this),g=g.fb};B.get=function(b){b=this.b[b];if(b===this.f)return b.$b;b===this.a?(this.a=this.a.fb,this.a.lc=null):(b.fb.lc=b.lc,b.lc.fb=b.fb);b.fb=null;b.lc=this.f;this.f=this.f.fb=b;return b.$b};
B.pop=function(){var b=this.a;delete this.b[b.Kd];b.fb&&(b.fb.lc=null);this.a=b.fb;this.a||(this.f=null);--this.g;return b.$b};B.replace=function(b,d){this.get(b);this.b[b].$b=d};B.set=function(b,d){var g={Kd:b,fb:null,lc:this.f,$b:d};this.f?this.f.fb=g:this.a=g;this.f=g;this.b[b]=g;++this.g};function Eg(b){Cg.call(this);this.h=void 0!==b?b:2048}M(Eg,Cg);function Fg(b){return b.g>b.h}function Gg(b,d){for(var g,k;Fg(b);){g=b.a.$b;k=g.na[0].toString();var p;if(p=k in d)g=g.na,p=Jc(d[k],g[1],g[2]);if(p)break;else b.pop().qa()}};function Hg(b){this.wb=void 0!==b.wb?b.wb:0;this.Tb=b.yb;this.kc=this.Tb.length-1;this.f=void 0!==b.origin?b.origin:null;this.g=null;void 0!==b.mh&&(this.g=b.mh);var d=b.D;void 0===d||this.f||this.g||(this.f=ec(d));this.h=null;void 0!==b.Uh&&(this.h=b.Uh);this.Yb=void 0!==b.Xd?b.Xd:this.h?null:256;this.i=void 0!==d?d:null;this.a=null;void 0!==b.sizes?this.a=b.sizes.map(function(b){return new Ic(Math.min(0,b[0]),Math.max(b[0]-1,-1),Math.min(0,b[1]),Math.max(b[1]-1,-1))},this):d&&Ig(this,d);this.b=
[0,0]}var Jg=[0,0,0];function Kg(b,d,g,k,p){p=Lg(b,d,p);for(d=d[0]-1;d>=b.wb;){if(g.call(null,d,Mg(b,p,d,k)))return!0;--d}return!1}Hg.prototype.J=function(){return this.i};Hg.prototype.lb=function(b){return this.f?this.f:this.g[b]};Hg.prototype.O=function(b){return this.Tb[b]};function Ng(b,d,g,k){return d[0]<b.kc?(k=Lg(b,d,k),Mg(b,k,d[0]+1,g)):null}
function Og(b,d,g,k){Pg(b,d[0],d[1],g,!1,Jg);var p=Jg[1],q=Jg[2];Pg(b,d[2],d[3],g,!0,Jg);b=Jg[1];d=Jg[2];void 0!==k?(k.a=p,k.f=b,k.b=q,k.g=d):k=new Ic(p,b,q,d);return k}function Mg(b,d,g,k){g=b.O(g);return Og(b,d,g,k)}function Qg(b,d){var g=b.lb(d[0]),k=b.O(d[0]),p=Qb(Rg(b,d[0]),b.b);return[g[0]+(d[1]+.5)*p[0]*k,g[1]+(d[2]+.5)*p[1]*k]}function Lg(b,d,g){var k=b.lb(d[0]),p=b.O(d[0]);b=Qb(Rg(b,d[0]),b.b);var q=k[0]+d[1]*b[0]*p;d=k[1]+d[2]*b[1]*p;return Zb(q,d,q+b[0]*p,d+b[1]*p,g)}
function Pg(b,d,g,k,p,q){var u=Sg(b,k),v=k/b.O(u),w=b.lb(u);b=Qb(Rg(b,u),b.b);d=v*Math.floor((d-w[0])/k+(p?.5:0))/b[0];g=v*Math.floor((g-w[1])/k+(p?0:.5))/b[1];p?(d=Math.ceil(d)-1,g=Math.ceil(g)-1):(d=Math.floor(d),g=Math.floor(g));p=d;void 0!==q?(q[0]=u,q[1]=p,q[2]=g):q=[u,p,g];return q}function Tg(b,d,g){g=b.O(g);return Pg(b,d[0],d[1],g,!1,void 0)}function Rg(b,d){return b.Yb?b.Yb:b.h[d]}function Sg(b,d){var g=$c(b.Tb,d,0);return Ib(g,b.wb,b.kc)}
function Ig(b,d){for(var g=b.Tb.length,k=Array(g),p=b.wb;p<g;++p)k[p]=Mg(b,d,p);b.a=k}function Ug(b){var d=b.g;if(!d){for(var d=Vg(b),g=Qb(256),g=Math.max(hc(d)/g[0],ic(d)/g[1]),k=Array(43),p=0;43>p;++p)k[p]=g/Math.pow(2,p);d=new Hg({D:d,origin:ec(d),yb:k,Xd:void 0});b.g=d}return d}function Vg(b){b=uc(b);var d=b.J();d||(b=180*qc.degrees/yc(b),d=Zb(-b,-b,b,b));return d};function Wg(b){Nc.call(this,{xa:b.xa,D:b.D,Fa:b.Fa,ba:b.ba,state:b.state,Na:b.Na});this.B=void 0!==b.Ic?b.Ic:!1;this.i=void 0!==b.Qc?b.Qc:1;this.Da=void 0!==b.Da?b.Da:null;this.a=new Eg(b.Xc);this.w=[0,0]}M(Wg,Nc);B=Wg.prototype;B.Qe=function(){return Fg(this.a)};B.Re=function(b,d){var g=this.Cc(b);g&&Gg(g,d)};
function Xg(b,d,g,k,p){d=b.Cc(d);if(!d)return!1;for(var q=!0,u,v,w=k.a;w<=k.f;++w)for(var z=k.b;z<=k.g;++z)u=b.bd(g,w,z),v=!1,Dg(d,u)&&(u=d.get(u),(v=2===u.W())&&(v=!1!==p(u))),v||(q=!1);return q}B.ad=function(){return 0};B.bd=function(b,d,g){return b+"/"+d+"/"+g};B.Id=function(){return this.B};B.mb=function(b){return this.Da?this.Da:Ug(b)};B.Cc=function(b){var d=this.l;return d&&!Fc(d,b)?null:this.a};
function Yg(b,d,g){var k=b.mb(g);g=b.i;d=Qb(Rg(k,d),b.w);1==g?b=d:(b=b.w,void 0===b&&(b=[0,0]),b[0]=d[0]*g+.5|0,b[1]=d[1]*g+.5|0);return b}function Zg(b,d,g){var k=void 0!==g?g:b.l;g=b.mb(k);if(b.qd&&k.b){var p=d;d=p[0];b=Qg(g,p);k=Vg(k);Xb(k,b[0],b[1])?d=p:(p=hc(k),b[0]+=p*Math.ceil((k[0]-b[0])/p),d=Tg(g,b,d))}p=d[0];k=d[1];b=d[2];if(g.wb>p||p>g.kc)g=!1;else{var q=g.J();g=(g=q?Mg(g,q,p):g.a?g.a[p]:null)?Jc(g,k,b):!0}return g?d:null}B.bf=bb;function $g(b){db.call(this,b)}M($g,db);function ah(b,d,g,k,p,q,u,v){Db(b);0===d&&0===g||Fb(b,d,g);1==k&&1==p||Gb(b,k,p);0!==q&&Hb(b,q);0===u&&0===v||Fb(b,u,v);return b}function bh(b,d){return b[0]==d[0]&&b[1]==d[1]&&b[4]==d[4]&&b[5]==d[5]&&b[12]==d[12]&&b[13]==d[13]}function ch(b,d,g){var k=b[1],p=b[5],q=b[13],u=d[0];d=d[1];g[0]=b[0]*u+b[4]*d+b[12];g[1]=k*u+p*d+q;return g};function dh(b){ib.call(this);this.a=b}M(dh,ib);dh.prototype.Db=bb;dh.prototype.i=function(b,d,g){return function(k,p){return Xg(b,d,k,p,function(b){g[k]||(g[k]={});g[k][b.na.toString()]=b})}};dh.prototype.oa=function(b){2===b.target.W()&&eh(this)};function fh(b,d){var g=d.W();2!=g&&3!=g&&S(d,"change",b.oa,b);0==g&&(d.load(),g=d.W());return 2==g}function eh(b){var d=b.a;d.get("visible")&&"ready"==d.Jd()&&b.A()}
function gh(b,d){d.Qe()&&b.gb.push(ra(function(b,d,p){d=I(b).toString();b.Re(p.L.ba,p.Sc[d])},d))}function hh(b,d){if(d){var g,k,p;k=0;for(p=d.length;k<p;++k)g=d[k],b[I(g).toString()]=g}}function ih(b,d){var g=d.oa;void 0!==g&&("string"===typeof g?b.jc[g]="":la(g)&&(b.jc[g.src]=g.href))}function jh(b,d,g,k){d=I(d).toString();g=g.toString();d in b?g in b[d]?(b=b[d][g],k.a<b.a&&(b.a=k.a),k.f>b.f&&(b.f=k.f),k.b<b.b&&(b.b=k.b),k.g>b.g&&(b.g=k.g)):b[d][g]=k:(b[d]={},b[d][g]=k)}
function kh(b,d,g){return[d*(Math.round(b[0]/d)+g[0]%2/2),d*(Math.round(b[1]/d)+g[1]%2/2)]}function lh(b,d,g,k,p,q,u,v,w,z){var A=I(d).toString();A in b.Tc||(b.Tc[A]={});var C=b.Tc[A];b=b.Sh;var D=g.wb,E,G,J,K,N,F;for(F=u;F>=D;--F)for(G=Mg(g,q,F,G),J=g.O(F),K=G.a;K<=G.f;++K)for(N=G.b;N<=G.g;++N)u-F<=v?(E=mh(d,F,K,N,k,p),0==E.W()&&(C[E.na.toString()]=!0,E.getKey()in b.mc||b.enqueue([E,A,Qg(g,E.na),J])),void 0!==w&&w.call(z,E)):d.bf(F,K,N,p)};function nh(b){if("string"!==typeof b){var d=b[0];d!=(d|0)&&(d=d+.5|0);var g=b[1];g!=(g|0)&&(g=g+.5|0);var k=b[2];k!=(k|0)&&(k=k+.5|0);b="rgba("+d+","+g+","+k+","+(void 0===b[3]?1:b[3])+")"}return b};function oh(b){this.s=b.opacity;this.u=b.Hh;this.da=b.rotation;this.l=b.scale;this.B=b.Vd}oh.prototype.ha=function(){return this.da};oh.prototype.Vb=function(b){this.da=b};oh.prototype.nd=function(b){this.l=b};function ph(){this.a={};this.f=0}ea(ph);ph.prototype.clear=function(){this.a={};this.f=0};ph.prototype.get=function(b,d,g){b=d+":"+b+":"+(g?nh(g):"null");return b in this.a?this.a[b]:null};ph.prototype.set=function(b,d,g,k){this.a[d+":"+b+":"+(g?nh(g):"null")]=k;++this.f};function qh(b,d){this.B=d;this.b={};this.s={}}M(qh,cb);function rh(b){var d=b.L,g=b.cc;ah(g,b.size[0]/2,b.size[1]/2,1/d.H,-1/d.H,-d.rotation,-d.T[0],-d.T[1]);Eb(g,b.Ve)}B=qh.prototype;B.aa=function(){for(var b in this.b)this.b[b].qa()};function sh(){var b=ph.Nb();if(32<b.f){var d=0,g,k;for(g in b.a)k=b.a[g],0!==(d++&3)||hb(k)||(delete b.a[g],--b.f)}}
B.Le=function(b,d,g,k,p,q){function u(b,p){var q=I(b).toString(),u=d.Fc[I(p)].Gc;if(!(q in d.Xb)||u)return g.call(k,b,u?p:null)}var v,w=d.L,z=w.H,A=w.ba,w=b;if(A.bc){var A=A.J(),C=hc(A),D=b[0];if(D<A[0]||D>A[2])w=[D+C*Math.ceil((A[0]-D)/C),b[1]]}A=d.Ob;for(C=A.length-1;0<=C;--C){var E=A[C],D=E.Bb;if(Uc(E,z)&&p.call(q,D)&&(E=th(this,D),D.ea()&&(v=E.Db(D.ea().qd?w:b,d,u,k)),v))return v}};
function th(b,d){var g=I(d).toString();if(g in b.b)return b.b[g];var k=b.Bd(d);b.b[g]=k;b.s[g]=S(k,"change",b.bg,b);return k}B.Ba=function(){return this.B};B.bg=function(){this.B.S()};B.jd=bb;B.Dh=function(b,d){for(var g in this.b)if(!(d&&g in d.Fc)){var k=g,p=this.b[k];delete this.b[k];Aa(this.s[k]);delete this.s[k];p.qa()}};function uh(b,d){for(var g in b.b)if(!(g in d.Fc)){d.gb.push(b.Dh.bind(b));break}}function ed(b,d){return b.zIndex-d.zIndex};function vh(b,d){this.j=b;this.h=d;this.a=[];this.f=[];this.mc={}}vh.prototype.clear=function(){this.a.length=0;this.f.length=0;ua(this.mc)};function wh(b){var d=b.a,g=b.f,k=d[0];1==d.length?(d.length=0,g.length=0):(d[0]=d.pop(),g[0]=g.pop(),xh(b,0));d=b.h(k);delete b.mc[d];return k}vh.prototype.enqueue=function(b){var d=this.j(b);return Infinity!=d?(this.a.push(b),this.f.push(d),this.mc[this.h(b)]=!0,yh(this,0,this.a.length-1),!0):!1};
function xh(b,d){for(var g=b.a,k=b.f,p=g.length,q=g[d],u=k[d],v=d;d<p>>1;){var w=2*d+1,z=2*d+2,w=z<p&&k[z]<k[w]?z:w;g[d]=g[w];k[d]=k[w];d=w}g[d]=q;k[d]=u;yh(b,v,d)}function yh(b,d,g){var k=b.a;b=b.f;for(var p=k[g],q=b[g];g>d;){var u=g-1>>1;if(b[u]>q)k[g]=k[u],b[g]=b[u],g=u;else break}k[g]=p;b[g]=q}function zh(b){var d=b.j,g=b.a,k=b.f,p=0,q=g.length,u,v,w;for(v=0;v<q;++v)u=g[v],w=d(u),Infinity==w?delete b.mc[b.h(u)]:(k[p]=w,g[p++]=u);g.length=p;k.length=p;for(d=(b.a.length>>1)-1;0<=d;d--)xh(b,d)};function Ah(b,d){vh.call(this,function(d){return b.apply(null,d)},function(b){return b[0].getKey()});this.l=d;this.g=0;this.b={}}M(Ah,vh);Ah.prototype.enqueue=function(b){var d=Ah.Aa.enqueue.call(this,b);d&&S(b[0],"change",this.i,this);return d};Ah.prototype.i=function(b){b=b.target;var d=b.W();if(2===d||3===d||4===d||5===d)Fa(b,"change",this.i,this),b=b.getKey(),b in this.b&&(delete this.b[b],--this.g),this.l()};function Bh(b){lb.call(this);this.element=b.element?b.element:null;this.s=this.G=null;this.h=[];this.S=b.S?b.S:bb;b.target&&(this.G=Le(b.target))}M(Bh,lb);Bh.prototype.aa=function(){Ue(this.element);Bh.Aa.aa.call(this)};Bh.prototype.Ba=function(){return this.s};Bh.prototype.ta=function(b){this.s&&Ue(this.element);for(var d=0,g=this.h.length;d<g;++d)Aa(this.h[d]);this.h.length=0;if(this.s=b)(this.G?this.G:b.s).appendChild(this.element),this.S!==bb&&this.h.push(S(b,"postrender",this.S,this)),b.S()};function Ch(b){b=b?b:{};this.u=document.createElement("UL");this.j=document.createElement("LI");this.u.appendChild(this.j);ef(this.j,!1);this.g=void 0!==b.collapsed?b.collapsed:!0;this.i=void 0!==b.xf?b.xf:!0;this.i||(this.g=!1);var d=void 0!==b.className?b.className:"ol-attribution",g=void 0!==b.Rc?b.Rc:"Attributions",k=void 0!==b.wf?b.wf:"\u00bb";this.w="string"===typeof k?Oe("SPAN",{},k):k;k=void 0!==b.label?b.label:"i";this.B="string"===typeof k?Oe("SPAN",{},k):k;g=Oe("BUTTON",{type:"button",
title:g},this.i&&!this.g?this.w:this.B);S(g,"click",this.P,this);d=Oe("DIV",d+" ol-unselectable ol-control"+(this.g&&this.i?" ol-collapsed":"")+(this.i?"":" ol-uncollapsible"),this.u,g);Bh.call(this,{element:d,S:b.S?b.S:Dh,target:b.target});this.l=!0;this.b={};this.a={};this.M={}}M(Ch,Bh);
function Dh(b){if(b=b.Mb){var d,g,k,p,q,u,v,w,z,A,C,D=b.Ob,E=ta({},b.xa),G={},J=b.L.ba;g=0;for(d=D.length;g<d;g++)if(u=D[g].Bb.ea())if(A=I(u).toString(),z=u.kb())for(k=0,p=z.length;k<p;k++)if(v=z[k],w=I(v).toString(),!(w in E)){if(q=b.Sc[A]){var K=u.mb(J);a:{C=v;var N=J;if(C.a){var F=void 0,H=void 0,O=void 0,Q=void 0;for(Q in q)if(Q in C.a)for(var O=q[Q],P,F=0,H=C.a[Q].length;F<H;++F){P=C.a[Q][F];if(Lc(P,O)){C=!0;break a}var R=Mg(K,Vg(N),parseInt(Q,10)),W=R.f-R.a+1;if(O.a<R.a||O.f>R.f)if(Lc(P,new Ic(Kb(O.a,
W),Kb(O.f,W),O.b,O.g))||O.f-O.a+1>W&&Lc(P,R)){C=!0;break a}}C=!1}else C=!0}}else C=!1;C?(w in G&&delete G[w],E[w]=v):G[w]=v}d=[E,G];g=d[0];d=d[1];for(var L in this.b)L in g?(this.a[L]||(ef(this.b[L],!0),this.a[L]=!0),delete g[L]):L in d?(this.a[L]&&(ef(this.b[L],!1),delete this.a[L]),delete d[L]):(Ue(this.b[L]),delete this.b[L],delete this.a[L]);for(L in g)k=document.createElement("LI"),k.innerHTML=g[L].f,this.u.appendChild(k),this.b[L]=k,this.a[L]=!0;for(L in d)k=document.createElement("LI"),k.innerHTML=
d[L].f,ef(k,!1),this.u.appendChild(k),this.b[L]=k;L=!xa(this.a)||!xa(b.jc);this.l!=L&&(ef(this.element,L),this.l=L);L&&xa(this.a)?this.element.classList.add("ol-logo-only"):this.element.classList.remove("ol-logo-only");var U;b=b.jc;L=this.M;for(U in L)U in b||(Ue(L[U]),delete L[U]);for(var ca in b)ca in L||(U=new Image,U.src=ca,g=b[ca],""===g?g=U:(g=Oe("A",{href:g}),g.appendChild(U)),this.j.appendChild(g),L[ca]=g);ef(this.j,!xa(b))}else this.l&&(ef(this.element,!1),this.l=!1)}
Ch.prototype.P=function(b){b.preventDefault();this.element.classList.toggle("ol-collapsed");this.g?Ve(this.w,this.B):Ve(this.B,this.w);this.g=!this.g};function Eh(b){return 1-Math.pow(1-b,3)}function Fh(b){return 3*b*b-2*b*b*b}function Gh(b){return b};function Hh(b){var d=b.source,g=b.start?b.start:Date.now(),k=d[0],p=d[1],q=void 0!==b.duration?b.duration:1E3,u=b.Ma?b.Ma:Fh;return function(b,d){if(d.time<g)return d.sb=!0,d.la[0]+=1,!0;if(d.time<g+q){var z=1-u((d.time-g)/q),A=k-d.L.T[0],C=p-d.L.T[1];d.sb=!0;d.L.T[0]+=z*A;d.L.T[1]+=z*C;d.la[0]+=1;return!0}return!1}}
function Ih(b){var d=b.rotation?b.rotation:0,g=b.start?b.start:Date.now(),k=void 0!==b.duration?b.duration:1E3,p=b.Ma?b.Ma:Fh,q=b.anchor?b.anchor:null;return function(b,v){if(v.time<g)return v.sb=!0,v.la[0]+=1,!0;if(v.time<g+k){var w=1-p((v.time-g)/k),w=(d-v.L.rotation)*w;v.sb=!0;v.L.rotation+=w;if(q){var z=v.L.T;z[0]-=q[0];z[1]-=q[1];Ob(z,w);Lb(z,q)}v.la[0]+=1;return!0}return!1}}
function Jh(b){var d=b.H,g=b.start?b.start:Date.now(),k=void 0!==b.duration?b.duration:1E3,p=b.Ma?b.Ma:Fh;return function(b,u){if(u.time<g)return u.sb=!0,u.la[0]+=1,!0;if(u.time<g+k){var v=1-p((u.time-g)/k),w=d-u.L.H;u.sb=!0;u.L.H+=v*w;u.la[0]+=1;return!0}return!1}};function Kh(b){b=b?b:{};var d=void 0!==b.className?b.className:"ol-rotate",g=void 0!==b.label?b.label:"\u21e7";this.a=null;"string"===typeof g?this.a=Oe("SPAN","ol-compass",g):(this.a=g,this.a.classList.add(this.a,"ol-compass"));g=Oe("BUTTON",{"class":d+"-reset",type:"button",title:b.Rc?b.Rc:"Reset rotation"},this.a);S(g,"click",Kh.prototype.l,this);d=Oe("DIV",d+" ol-unselectable ol-control",g);g=b.S?b.S:Lh;this.g=b.Gh?b.Gh:void 0;Bh.call(this,{element:d,S:g,target:b.target});this.i=void 0!==b.duration?
b.duration:250;this.b=void 0!==b.sf?b.sf:!0;this.j=void 0;this.b&&this.element.classList.add("ol-hidden")}M(Kh,Bh);Kh.prototype.l=function(b){b.preventDefault();if(void 0!==this.g)this.g();else{b=this.Ba();var d=V(b);if(d){var g=d.ha();void 0!==g&&(0<this.i&&(g%=2*Math.PI,g<-Math.PI&&(g+=2*Math.PI),g>Math.PI&&(g-=2*Math.PI),b.cb(Ih({rotation:g,duration:this.i,Ma:Eh}))),d.Vb(0))}}};
function Lh(b){if(b=b.Mb){b=b.L.rotation;if(b!=this.j){var d="rotate("+b+"rad)";if(this.b){var g=this.element.classList.contains("ol-hidden");g||0!==b?g&&0!==b&&this.element.classList.remove("ol-hidden"):this.element.classList.add("ol-hidden")}this.a.style.msTransform=d;this.a.style.webkitTransform=d;this.a.style.transform=d}this.j=b}};function Mh(b){b=b?b:{};var d=void 0!==b.className?b.className:"ol-zoom",g=void 0!==b.Kb?b.Kb:1,k=void 0!==b.ni?b.ni:"\u2212",p=void 0!==b.oi?b.oi:"Zoom out",q=Oe("BUTTON",{"class":d+"-in",type:"button",title:void 0!==b.mi?b.mi:"Zoom in"},void 0!==b.li?b.li:"+");S(q,"click",ra(Mh.prototype.b,g),this);k=Oe("BUTTON",{"class":d+"-out",type:"button",title:p},k);S(k,"click",ra(Mh.prototype.b,-g),this);d=Oe("DIV",d+" ol-unselectable ol-control",q,k);Bh.call(this,{element:d,target:b.target});this.a=void 0!==
b.duration?b.duration:250}M(Mh,Bh);Mh.prototype.b=function(b,d){d.preventDefault();var g=this.Ba(),k=V(g);if(k){var p=k.O();p&&(0<this.a&&g.cb(Jh({H:p,duration:this.a,Ma:Eh})),g=k.a.H(p,b||0,0),k.set("resolution",g))}};function Nh(){this.a=[];this.f=this.b=0}function Oh(b,d){var g=b.f,k=.05-g,p=Math.log(.05/b.f)/-.005;return Hh({source:d,duration:p,Ma:function(b){return g*(Math.exp(-.005*b*p)-1)/k}})};function Ph(b){lb.call(this);this.Jb=null;this.set("active",!0);this.handleEvent=b.handleEvent}M(Ph,lb);Ph.prototype.Ba=function(){return this.Jb};Ph.prototype.ta=function(b){this.Jb=b};function Qh(b,d,g,k,p){if(void 0!==g){var q=d.ha(),u=Wd(d);void 0!==q&&u&&p&&0<p&&(b.cb(Ih({rotation:q,duration:p,Ma:Eh})),k&&b.cb(Hh({source:u,duration:p,Ma:Eh})));d.rotate(g,k)}}function Rh(b,d,g,k,p){var q=d.O();g=d.a.H(q,g||0,0);Sh(b,d,g,k,p)}
function Sh(b,d,g,k,p){if(g){var q=d.O(),u=Wd(d);void 0!==q&&u&&g!==q&&p&&0<p&&(b.cb(Jh({H:q,duration:p,Ma:Eh})),k&&b.cb(Hh({source:u,duration:p,Ma:Eh})));if(k){var v;b=Wd(d);p=d.O();void 0!==b&&void 0!==p&&(v=[k[0]-g*(k[0]-b[0])/p,k[1]-g*(k[1]-b[1])/p]);Xd(d,v)}d.set("resolution",g)}};function Th(b){b=b?b:{};this.a=b.Kb?b.Kb:1;Ph.call(this,{handleEvent:Uh});this.b=void 0!==b.duration?b.duration:250}M(Th,Ph);function Uh(b){var d=!1,g=b.a;if(b.type==rg){var d=b.map,k=b.b,g=g.shiftKey?-this.a:this.a,p=V(d);Rh(d,p,g,k,this.b);b.preventDefault();d=!0}return!d};function Vh(b){b=b.a;return b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey}function Wh(b){return b.type==qg}function Xh(b){b=b.a;return 0==b.button&&!(ve&&Af&&b.ctrlKey)}function Yh(b){return b.type==sg}function Zh(b){b=b.a;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&!b.shiftKey}function $h(b){b=b.a;return!b.altKey&&(Af?b.metaKey:b.ctrlKey)&&!b.shiftKey}function ai(b){b=b.a;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey}
function bi(b){b=b.a.target.tagName;return"INPUT"!==b&&"SELECT"!==b&&"TEXTAREA"!==b}function ci(b){return"mouse"==b.g.pointerType};function di(b){b=b?b:{};Ph.call(this,{handleEvent:b.handleEvent?b.handleEvent:ei});this.Ja=b.ub?b.ub:od;this.Ka=b.Ab?b.Ab:bb;this.bb=b.Ae?b.Ae:bb;this.oa=b.vb?b.vb:od;this.s=!1;this.P={};this.g=[]}M(di,Ph);function fi(b){for(var d=b.length,g=0,k=0,p=0;p<d;p++)g+=b[p].clientX,k+=b[p].clientY;return[g/d,k/d]}
function ei(b){if(!(b instanceof ng))return!0;var d=!1,g=b.type;if(g===wg||g===yg||g===ug)g=b.g,b.type==ug?delete this.P[g.pointerId]:b.type==wg?this.P[g.pointerId]=g:g.pointerId in this.P&&(this.P[g.pointerId]=g),this.g=wa(this.P);this.s&&(b.type==yg?this.Ka(b):b.type==ug&&(this.s=this.oa(b)));b.type==wg?(this.s=b=this.Ja(b),d=this.B(b)):b.type==xg&&this.bb(b);return!d}di.prototype.B=function(b){return b};function gi(b){di.call(this,{ub:hi,Ab:ii,vb:ji});b=b?b:{};this.a=b.zg;this.b=this.h=null;this.La=b.Oa?b.Oa:Zh;this.i=!1}M(gi,di);function ii(b){var d=fi(this.g);this.a&&this.a.a.push(d[0],d[1],Date.now());if(this.b){var g=this.b[0]-d[0],k=d[1]-this.b[1];b=b.map;var p=V(b),q=p.W(),k=g=[g,k],u=q.H;k[0]*=u;k[1]*=u;Ob(g,q.rotation);Lb(g,q.T);g=p.a.T(g);b.S();Xd(p,g)}this.b=d}
function ji(b){b=b.map;var d=V(b);if(0===this.g.length){var g;if(g=!this.i&&this.a)if(g=this.a,6>g.a.length)g=!1;else{var k=Date.now()-100,p=g.a.length-3;if(g.a[p+2]<k)g=!1;else{for(var q=p-3;0<q&&g.a[q+2]>k;)q-=3;var k=g.a[p+2]-g.a[q+2],u=g.a[p]-g.a[q],p=g.a[p+1]-g.a[q+1];g.b=Math.atan2(p,u);g.f=Math.sqrt(u*u+p*p)/k;g=.05<g.f}}g&&(g=(.05-this.a.f)/-.005,p=this.a.b,q=Wd(d),this.h=Oh(this.a,q),b.cb(this.h),q=ki(b,q),g=b.Pa([q[0]-g*Math.cos(p),q[1]-g*Math.sin(p)]),g=d.a.T(g),Xd(d,g));Yd(d,-1);b.S();
return!1}this.b=null;return!0}function hi(b){if(0<this.g.length&&this.La(b)){var d=b.map,g=V(d);this.b=null;this.s||Yd(g,1);d.S();this.h&&bd(d.B,this.h)&&(Xd(g,b.Mb.L.T),this.h=null);this.a&&(b=this.a,b.a.length=0,b.b=0,b.f=0);this.i=1<this.g.length;return!0}return!1}gi.prototype.B=od;function li(b){b=b?b:{};di.call(this,{ub:mi,Ab:ni,vb:oi});this.La=b.Oa?b.Oa:Vh;this.a=void 0;this.b=void 0!==b.duration?b.duration:250}M(li,di);function ni(b){if(ci(b)){var d=b.map,g=pi(d);b=b.f;g=Math.atan2(g[1]/2-b[1],b[0]-g[0]/2);if(void 0!==this.a){b=g-this.a;var k=V(d),p=k.ha();d.S();Qh(d,k,p-b)}this.a=g}}function oi(b){if(!ci(b))return!0;b=b.map;var d=V(b);Yd(d,-1);var g=d.ha(),k=this.b,g=d.Ad(g,0);Qh(b,d,g,void 0,k);return!1}
function mi(b){return ci(b)&&Xh(b)&&this.La(b)?(b=b.map,Yd(V(b),1),b.S(),this.a=void 0,!0):!1}li.prototype.B=od;function qi(b){this.g=null;this.f=document.createElement("div");this.f.style.position="absolute";this.f.className="ol-box "+b;this.b=this.h=this.a=null}M(qi,cb);qi.prototype.aa=function(){this.ta(null)};function ri(b){var d=b.h,g=b.b;b=b.f.style;b.left=Math.min(d[0],g[0])+"px";b.top=Math.min(d[1],g[1])+"px";b.width=Math.abs(g[0]-d[0])+"px";b.height=Math.abs(g[1]-d[1])+"px"}
qi.prototype.ta=function(b){if(this.a){this.a.u.removeChild(this.f);var d=this.f.style;d.left=d.top=d.width=d.height="inherit"}(this.a=b)&&this.a.u.appendChild(this.f)};function si(b){var d=b.h,g=b.b,d=[d,[d[0],g[1]],g,[g[0],d[1]]].map(b.a.Pa,b.a);d[4]=d[0].slice();b.g?b.g.wa([d]):b.g=new Rd([d])}qi.prototype.C=function(){return this.g};function ti(b){db.call(this,b)}M(ti,db);function ui(b){di.call(this,{ub:vi,Ab:wi,vb:xi});b=b?b:{};this.a=new qi(b.className||"ol-dragbox");this.b=null;this.La=b.Oa?b.Oa:nd;this.u=b.vf?b.vf:yi}M(ui,di);function yi(b,d,g){b=g[0]-d[0];d=g[1]-d[1];return 64<=b*b+d*d}function wi(b){if(ci(b)){var d=this.a;b=b.f;d.h=this.b;d.b=b;si(d);ri(d);T(this,new ti("boxdrag"))}}ui.prototype.C=function(){return this.a.C()};ui.prototype.j=bb;
function xi(b){if(!ci(b))return!0;this.a.ta(null);this.u(b,this.b,b.f)&&(this.j(b),T(this,new ti("boxend")));return!1}function vi(b){if(ci(b)&&Xh(b)&&this.La(b)){this.b=b.f;this.a.ta(b.map);b=this.a;var d=this.b;b.h=this.b;b.b=d;si(b);ri(b);T(this,new ti("boxstart"));return!0}return!1};function zi(b){b=b?b:{};var d=b.Oa?b.Oa:ai;this.h=void 0!==b.duration?b.duration:200;this.i=void 0!==b.xb?b.xb:!1;ui.call(this,{Oa:d,className:b.className||"ol-dragzoom"})}M(zi,ui);
zi.prototype.j=function(){var b=this.Ba(),d=V(b),g=pi(b),k=this.C().J();if(this.i){var p;p=Wd(d);var q=d.O(),u=d.ha();p=kc(p,q,u,g);var k=[ki(b,dc(k)),ki(b,[k[2],k[3]])],q=Zb(Infinity,Infinity,-Infinity,-Infinity,void 0),v,u=0;for(v=k.length;u<v;++u)Tb(q,k[u]);q=1/Math.max(hc(q)/g[0],ic(q)/g[1]);k=(p[2]-p[0])/2*(q-1);q=(p[3]-p[1])/2*(q-1);p[0]-=k;p[2]+=k;p[1]-=q;p[3]+=q;k=p}g=d.a.H(Math.max(hc(k)/g[0],ic(k)/g[1]),0,0);p=d.O();q=Wd(d);b.cb(Jh({H:p,duration:this.h,Ma:Eh}));b.cb(Hh({source:q,duration:this.h,
Ma:Eh}));Xd(d,jc(k));d.set("resolution",g)};function Ai(b){Ph.call(this,{handleEvent:Bi});b=b||{};this.a=function(b){return Zh.call(this,b)&&bi.call(this,b)};this.La=void 0!==b.Oa?b.Oa:this.a;this.b=void 0!==b.duration?b.duration:100;this.g=void 0!==b.qh?b.qh:128}M(Ai,Ph);
function Bi(b){var d=!1;if("keydown"==b.type){var g=b.a.keyCode;if(this.La(b)&&(40==g||37==g||39==g||38==g)){var k=b.map,d=V(k),p=d.O()*this.g,q=0,u=0;40==g?u=-p:37==g?q=-p:39==g?q=p:u=p;g=[q,u];Ob(g,d.ha());p=this.b;if(q=Wd(d))p&&0<p&&k.cb(Hh({source:q,duration:p,Ma:Gh})),k=d.a.T([q[0]+g[0],q[1]+g[1]]),Xd(d,k);b.preventDefault();d=!0}}return!d};function Ci(b){Ph.call(this,{handleEvent:Di});b=b?b:{};this.La=b.Oa?b.Oa:bi;this.a=b.Kb?b.Kb:1;this.b=void 0!==b.duration?b.duration:100}M(Ci,Ph);function Di(b){var d=!1;if("keydown"==b.type||"keypress"==b.type){var g=b.a.charCode;if(this.La(b)&&(43==g||45==g)){d=b.map;g=43==g?this.a:-this.a;d.S();var k=V(d);Rh(d,k,g,void 0,this.b);b.preventDefault();d=!0}}return!d};function Ei(b){Ph.call(this,{handleEvent:Fi});b=b||{};this.a=0;this.j=void 0!==b.duration?b.duration:250;this.l=void 0!==b.ci?b.ci:!0;this.g=null;this.h=this.b=void 0}M(Ei,Ph);
function Fi(b){var d=!1;if("wheel"==b.type||"mousewheel"==b.type){var d=b.map,g=b.a;this.l&&(this.g=b.b);var k;"wheel"==b.type?(k=g.deltaY,yf&&g.deltaMode===aa.WheelEvent.DOM_DELTA_PIXEL&&(k/=Bf),g.deltaMode===aa.WheelEvent.DOM_DELTA_LINE&&(k*=40)):"mousewheel"==b.type&&(k=-g.wheelDeltaY,zf&&(k/=3));this.a+=k;void 0===this.b&&(this.b=Date.now());k=Math.max(80-(Date.now()-this.b),0);aa.clearTimeout(this.h);this.h=aa.setTimeout(this.i.bind(this,d),k);b.preventDefault();d=!0}return!d}
Ei.prototype.i=function(b){var d=Ib(this.a,-1,1),g=V(b);b.S();Rh(b,g,-d,this.g,this.j);this.a=0;this.g=null;this.h=this.b=void 0};function Gi(b){di.call(this,{ub:Hi,Ab:Ii,vb:Ji});b=b||{};this.b=null;this.h=void 0;this.a=!1;this.i=0;this.l=void 0!==b.threshold?b.threshold:.3;this.j=void 0!==b.duration?b.duration:250}M(Gi,di);
function Ii(b){var d=0,g=this.g[0],k=this.g[1],g=Math.atan2(k.clientY-g.clientY,k.clientX-g.clientX);void 0!==this.h&&(d=g-this.h,this.i+=d,!this.a&&Math.abs(this.i)>this.l&&(this.a=!0));this.h=g;b=b.map;g=b.a.getBoundingClientRect();k=fi(this.g);k[0]-=g.left;k[1]-=g.top;this.b=b.Pa(k);this.a&&(g=V(b),k=g.ha(),b.S(),Qh(b,g,k+d,this.b))}function Ji(b){if(2>this.g.length){b=b.map;var d=V(b);Yd(d,-1);if(this.a){var g=d.ha(),k=this.b,p=this.j,g=d.Ad(g,0);Qh(b,d,g,k,p)}return!1}return!0}
function Hi(b){return 2<=this.g.length?(b=b.map,this.b=null,this.h=void 0,this.a=!1,this.i=0,this.s||Yd(V(b),1),b.S(),!0):!1}Gi.prototype.B=od;function Ki(b){di.call(this,{ub:Li,Ab:Mi,vb:Ni});b=b?b:{};this.b=null;this.i=void 0!==b.duration?b.duration:400;this.a=void 0;this.h=1}M(Ki,di);function Mi(b){var d=1,g=this.g[0],k=this.g[1],p=g.clientX-k.clientX,g=g.clientY-k.clientY,p=Math.sqrt(p*p+g*g);void 0!==this.a&&(d=this.a/p);this.a=p;1!=d&&(this.h=d);b=b.map;var p=V(b),g=p.O(),k=b.a.getBoundingClientRect(),q=fi(this.g);q[0]-=k.left;q[1]-=k.top;this.b=b.Pa(q);b.S();Sh(b,p,g*d,this.b)}
function Ni(b){if(2>this.g.length){b=b.map;var d=V(b);Yd(d,-1);var g=d.O(),k=this.b,p=this.i,g=d.a.H(g,0,this.h-1||0);Sh(b,d,g,k,p);return!1}return!0}function Li(b){return 2<=this.g.length?(b=b.map,this.b=null,this.a=void 0,this.h=1,this.s||Yd(V(b),1),b.S(),!0):!1}Ki.prototype.B=od;function Oi(b){var d=b||{};b=ta({},d);delete b.ic;d=d.ic;Pc.call(this,b);this.g=[];this.a={};S(this,ob("layers"),this.dg,this);d?Array.isArray(d)&&(d=new qb(d.slice())):d=new qb;this.set("layers",d)}M(Oi,Pc);B=Oi.prototype;B.dd=function(){this.get("visible")&&this.A()};
B.dg=function(){this.g.forEach(Aa);this.g.length=0;var b=this.get("layers");this.g.push(S(b,"add",this.cg,this),S(b,"remove",this.eg,this));for(var d in this.a)this.a[d].forEach(Aa);ua(this.a);var b=b.a,g,k;d=0;for(g=b.length;d<g;d++)k=b[d],this.a[I(k).toString()]=[S(k,"propertychange",this.dd,this),S(k,"change",this.dd,this)];this.A()};B.cg=function(b){b=b.element;var d=I(b).toString();this.a[d]=[S(b,"propertychange",this.dd,this),S(b,"change",this.dd,this)];this.A()};
B.eg=function(b){b=I(b.element).toString();this.a[b].forEach(Aa);delete this.a[b];this.A()};B.Hd=function(b){var d=void 0!==b?b:[],g=d.length;this.get("layers").forEach(function(b){b.Hd(d)});b=Qc(this);var k,p;for(k=d.length;g<k;g++)p=d[g],p.opacity*=b.opacity,p.visible=p.visible&&b.visible,p.Cb=Math.min(p.Cb,b.Cb),p.Pb=Math.max(p.Pb,b.Pb),void 0!==b.D&&(p.D=void 0!==p.D?lc(p.D,b.D):b.D);return d};B.Jd=function(){return"ready"};function Pi(b){rc.call(this,{code:b,units:"m",D:Qi,global:!0,di:Ri})}M(Pi,rc);Pi.prototype.dc=function(b,d){return b/Jb(d[1]/6378137)};var Si=6378137*Math.PI,Qi=[-Si,-Si,Si,Si],Ri=[-180,-85,180,85],Ti="EPSG:3857 EPSG:102100 EPSG:102113 EPSG:900913 urn:ogc:def:crs:EPSG:6.18:3:3857 urn:ogc:def:crs:EPSG::3857 http://www.opengis.net/gml/srs/epsg.xml#3857".split(" ").map(function(b){return new Pi(b)});
function Ui(b,d,g){var k=b.length;g=1<g?g:2;void 0===d&&(2<g?d=b.slice():d=Array(k));for(var p=0;p<k;p+=g)d[p]=6378137*Math.PI*b[p]/180,d[p+1]=6378137*Math.log(Math.tan(Math.PI*(b[p+1]+90)/360));return d}function Vi(b,d,g){var k=b.length;g=1<g?g:2;void 0===d&&(2<g?d=b.slice():d=Array(k));for(var p=0;p<k;p+=g)d[p]=180*b[p]/(6378137*Math.PI),d[p+1]=360*Math.atan(Math.exp(b[p+1]/6378137))/Math.PI-90;return d};var Wi=new nc(6378137);function Xi(b,d){rc.call(this,{code:b,units:"degrees",D:Yi,Ei:d,global:!0,Ie:Zi,di:Yi})}M(Xi,rc);Xi.prototype.dc=function(b){return b};var Yi=[-180,-90,180,90],Zi=Math.PI*Wi.Rb/180,$i=[new Xi("CRS:84"),new Xi("EPSG:4326","neu"),new Xi("urn:ogc:def:crs:EPSG::4326","neu"),new Xi("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Xi("urn:ogc:def:crs:OGC:1.3:CRS84"),new Xi("urn:ogc:def:crs:OGC:2:84"),new Xi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Xi("urn:x-ogc:def:crs:EPSG:4326","neu")];function aj(b){Tc.call(this,b?b:{})}M(aj,Tc);function bj(b){return"string"===typeof b||b instanceof CanvasPattern||b instanceof CanvasGradient?b:nh(b)};var cj=[0,0,0,1],dj=[],ej=[0,0,0,1];function fj(b,d,g,k){0!==d&&(b.translate(g,k),b.rotate(d),b.translate(-g,-k))};function gj(b){b=b||{};this.a=void 0!==b.color?b.color:null;this.f=void 0}gj.prototype.Nc=function(b){this.a=b;this.f=void 0};function hj(){this.f=-1};function ij(){this.f=-1;this.f=64;this.a=Array(4);this.h=Array(this.f);this.g=this.b=0;this.a[0]=1732584193;this.a[1]=4023233417;this.a[2]=2562383102;this.a[3]=271733878;this.g=this.b=0}M(ij,hj);
function jj(b,d,g){g||(g=0);var k=Array(16);if(ia(d))for(var p=0;16>p;++p)k[p]=d.charCodeAt(g++)|d.charCodeAt(g++)<<8|d.charCodeAt(g++)<<16|d.charCodeAt(g++)<<24;else for(p=0;16>p;++p)k[p]=d[g++]|d[g++]<<8|d[g++]<<16|d[g++]<<24;d=b.a[0];g=b.a[1];var p=b.a[2],q=b.a[3],u=0,u=d+(q^g&(p^q))+k[0]+3614090360&4294967295;d=g+(u<<7&4294967295|u>>>25);u=q+(p^d&(g^p))+k[1]+3905402710&4294967295;q=d+(u<<12&4294967295|u>>>20);u=p+(g^q&(d^g))+k[2]+606105819&4294967295;p=q+(u<<17&4294967295|u>>>15);u=g+(d^p&(q^
d))+k[3]+3250441966&4294967295;g=p+(u<<22&4294967295|u>>>10);u=d+(q^g&(p^q))+k[4]+4118548399&4294967295;d=g+(u<<7&4294967295|u>>>25);u=q+(p^d&(g^p))+k[5]+1200080426&4294967295;q=d+(u<<12&4294967295|u>>>20);u=p+(g^q&(d^g))+k[6]+2821735955&4294967295;p=q+(u<<17&4294967295|u>>>15);u=g+(d^p&(q^d))+k[7]+4249261313&4294967295;g=p+(u<<22&4294967295|u>>>10);u=d+(q^g&(p^q))+k[8]+1770035416&4294967295;d=g+(u<<7&4294967295|u>>>25);u=q+(p^d&(g^p))+k[9]+2336552879&4294967295;q=d+(u<<12&4294967295|u>>>20);u=p+
(g^q&(d^g))+k[10]+4294925233&4294967295;p=q+(u<<17&4294967295|u>>>15);u=g+(d^p&(q^d))+k[11]+2304563134&4294967295;g=p+(u<<22&4294967295|u>>>10);u=d+(q^g&(p^q))+k[12]+1804603682&4294967295;d=g+(u<<7&4294967295|u>>>25);u=q+(p^d&(g^p))+k[13]+4254626195&4294967295;q=d+(u<<12&4294967295|u>>>20);u=p+(g^q&(d^g))+k[14]+2792965006&4294967295;p=q+(u<<17&4294967295|u>>>15);u=g+(d^p&(q^d))+k[15]+1236535329&4294967295;g=p+(u<<22&4294967295|u>>>10);u=d+(p^q&(g^p))+k[1]+4129170786&4294967295;d=g+(u<<5&4294967295|
u>>>27);u=q+(g^p&(d^g))+k[6]+3225465664&4294967295;q=d+(u<<9&4294967295|u>>>23);u=p+(d^g&(q^d))+k[11]+643717713&4294967295;p=q+(u<<14&4294967295|u>>>18);u=g+(q^d&(p^q))+k[0]+3921069994&4294967295;g=p+(u<<20&4294967295|u>>>12);u=d+(p^q&(g^p))+k[5]+3593408605&4294967295;d=g+(u<<5&4294967295|u>>>27);u=q+(g^p&(d^g))+k[10]+38016083&4294967295;q=d+(u<<9&4294967295|u>>>23);u=p+(d^g&(q^d))+k[15]+3634488961&4294967295;p=q+(u<<14&4294967295|u>>>18);u=g+(q^d&(p^q))+k[4]+3889429448&4294967295;g=p+(u<<20&4294967295|
u>>>12);u=d+(p^q&(g^p))+k[9]+568446438&4294967295;d=g+(u<<5&4294967295|u>>>27);u=q+(g^p&(d^g))+k[14]+3275163606&4294967295;q=d+(u<<9&4294967295|u>>>23);u=p+(d^g&(q^d))+k[3]+4107603335&4294967295;p=q+(u<<14&4294967295|u>>>18);u=g+(q^d&(p^q))+k[8]+1163531501&4294967295;g=p+(u<<20&4294967295|u>>>12);u=d+(p^q&(g^p))+k[13]+2850285829&4294967295;d=g+(u<<5&4294967295|u>>>27);u=q+(g^p&(d^g))+k[2]+4243563512&4294967295;q=d+(u<<9&4294967295|u>>>23);u=p+(d^g&(q^d))+k[7]+1735328473&4294967295;p=q+(u<<14&4294967295|
u>>>18);u=g+(q^d&(p^q))+k[12]+2368359562&4294967295;g=p+(u<<20&4294967295|u>>>12);u=d+(g^p^q)+k[5]+4294588738&4294967295;d=g+(u<<4&4294967295|u>>>28);u=q+(d^g^p)+k[8]+2272392833&4294967295;q=d+(u<<11&4294967295|u>>>21);u=p+(q^d^g)+k[11]+1839030562&4294967295;p=q+(u<<16&4294967295|u>>>16);u=g+(p^q^d)+k[14]+4259657740&4294967295;g=p+(u<<23&4294967295|u>>>9);u=d+(g^p^q)+k[1]+2763975236&4294967295;d=g+(u<<4&4294967295|u>>>28);u=q+(d^g^p)+k[4]+1272893353&4294967295;q=d+(u<<11&4294967295|u>>>21);u=p+(q^
d^g)+k[7]+4139469664&4294967295;p=q+(u<<16&4294967295|u>>>16);u=g+(p^q^d)+k[10]+3200236656&4294967295;g=p+(u<<23&4294967295|u>>>9);u=d+(g^p^q)+k[13]+681279174&4294967295;d=g+(u<<4&4294967295|u>>>28);u=q+(d^g^p)+k[0]+3936430074&4294967295;q=d+(u<<11&4294967295|u>>>21);u=p+(q^d^g)+k[3]+3572445317&4294967295;p=q+(u<<16&4294967295|u>>>16);u=g+(p^q^d)+k[6]+76029189&4294967295;g=p+(u<<23&4294967295|u>>>9);u=d+(g^p^q)+k[9]+3654602809&4294967295;d=g+(u<<4&4294967295|u>>>28);u=q+(d^g^p)+k[12]+3873151461&4294967295;
q=d+(u<<11&4294967295|u>>>21);u=p+(q^d^g)+k[15]+530742520&4294967295;p=q+(u<<16&4294967295|u>>>16);u=g+(p^q^d)+k[2]+3299628645&4294967295;g=p+(u<<23&4294967295|u>>>9);u=d+(p^(g|~q))+k[0]+4096336452&4294967295;d=g+(u<<6&4294967295|u>>>26);u=q+(g^(d|~p))+k[7]+1126891415&4294967295;q=d+(u<<10&4294967295|u>>>22);u=p+(d^(q|~g))+k[14]+2878612391&4294967295;p=q+(u<<15&4294967295|u>>>17);u=g+(q^(p|~d))+k[5]+4237533241&4294967295;g=p+(u<<21&4294967295|u>>>11);u=d+(p^(g|~q))+k[12]+1700485571&4294967295;d=g+
(u<<6&4294967295|u>>>26);u=q+(g^(d|~p))+k[3]+2399980690&4294967295;q=d+(u<<10&4294967295|u>>>22);u=p+(d^(q|~g))+k[10]+4293915773&4294967295;p=q+(u<<15&4294967295|u>>>17);u=g+(q^(p|~d))+k[1]+2240044497&4294967295;g=p+(u<<21&4294967295|u>>>11);u=d+(p^(g|~q))+k[8]+1873313359&4294967295;d=g+(u<<6&4294967295|u>>>26);u=q+(g^(d|~p))+k[15]+4264355552&4294967295;q=d+(u<<10&4294967295|u>>>22);u=p+(d^(q|~g))+k[6]+2734768916&4294967295;p=q+(u<<15&4294967295|u>>>17);u=g+(q^(p|~d))+k[13]+1309151649&4294967295;
g=p+(u<<21&4294967295|u>>>11);u=d+(p^(g|~q))+k[4]+4149444226&4294967295;d=g+(u<<6&4294967295|u>>>26);u=q+(g^(d|~p))+k[11]+3174756917&4294967295;q=d+(u<<10&4294967295|u>>>22);u=p+(d^(q|~g))+k[2]+718787259&4294967295;p=q+(u<<15&4294967295|u>>>17);u=g+(q^(p|~d))+k[9]+3951481745&4294967295;b.a[0]=b.a[0]+d&4294967295;b.a[1]=b.a[1]+(p+(u<<21&4294967295|u>>>11))&4294967295;b.a[2]=b.a[2]+p&4294967295;b.a[3]=b.a[3]+q&4294967295}
function kj(b,d){var g;void 0===g&&(g=d.length);for(var k=g-b.f,p=b.h,q=b.b,u=0;u<g;){if(0==q)for(;u<=k;)jj(b,d,u),u+=b.f;if(ia(d))for(;u<g;){if(p[q++]=d.charCodeAt(u++),q==b.f){jj(b,p);q=0;break}}else for(;u<g;)if(p[q++]=d[u++],q==b.f){jj(b,p);q=0;break}}b.b=q;b.g+=g};function lj(b){b=b||{};this.h=void 0!==b.color?b.color:null;this.a=b.lineCap;this.j=void 0!==b.U?b.U:null;this.f=b.lineJoin;this.b=b.miterLimit;this.i=b.width;this.g=void 0}lj.prototype.Nc=function(b){this.h=b;this.g=void 0};lj.prototype.setLineDash=function(b){this.j=b;this.g=void 0};lj.prototype.Wb=function(b){this.i=b;this.g=void 0};function mj(b){b=b||{};this.b=this.a=this.g=null;this.h=void 0!==b.fill?b.fill:null;this.Ia=void 0!==b.stroke?b.stroke:null;this.f=b.Rb;this.Z=[0,0];this.w=this.j=this.i=null;var d=b.Ci,g,k=null,p,q=0;this.Ia&&(p=nh(this.Ia.h),q=this.Ia.i,void 0===q&&(q=1),k=this.Ia.j,Cf||(k=null));var u=2*(this.f+q)+1;p={strokeStyle:p,$e:q,size:u,U:k};if(void 0===d)this.a=document.createElement("CANVAS"),this.a.height=u,this.a.width=u,g=u=this.a.width,d=this.a.getContext("2d"),this.ib(p,d,0,0),this.h?this.b=this.a:
(d=this.b=document.createElement("CANVAS"),d.height=p.size,d.width=p.size,d=d.getContext("2d"),this.te(p,d,0,0));else{u=Math.round(u);(k=!this.h)&&(g=this.te.bind(this,p));if(this.Ia){q=this.Ia;if(void 0===q.g){var v="s"+(q.h?nh(q.h):"-")+","+(void 0!==q.a?q.a.toString():"-")+","+(q.j?q.j.toString():"-")+","+(void 0!==q.f?q.f:"-")+","+(void 0!==q.b?q.b.toString():"-")+","+(void 0!==q.i?q.i.toString():"-"),w=new ij;kj(w,v);var z=Array((56>w.b?w.f:2*w.f)-w.b);z[0]=128;for(v=1;v<z.length-8;++v)z[v]=
0;for(var A=8*w.g,v=z.length-8;v<z.length;++v)z[v]=A&255,A/=256;kj(w,z);z=Array(16);for(v=A=0;4>v;++v)for(var C=0;32>C;C+=8)z[A++]=w.a[v]>>>C&255;if(8192>=z.length)w=String.fromCharCode.apply(null,z);else for(w="",v=0;v<z.length;v+=8192)w+=String.fromCharCode.apply(null,de(z,v,v+8192));q.g=w}q=q.g}else q="-";this.h?(w=this.h,void 0===w.f&&(w.f=w.a instanceof CanvasPattern||w.a instanceof CanvasGradient?I(w.a).toString():"f"+(w.a?nh(w.a):"-")),w=w.f):w="-";this.g&&q==this.g[1]&&w==this.g[2]&&this.f==
this.g[3]||(this.g=["c"+q+w+(void 0!==this.f?this.f.toString():"-"),q,w,this.f]);p=d.add(this.g[0],u,u,this.ib.bind(this,p),g);this.a=p.Ra;this.Z=[p.offsetX,p.offsetY];g=p.Ra.width;k?this.b=p.Ji:this.b=this.a}this.i=[u/2,u/2];this.j=[u,u];this.w=[g,g];oh.call(this,{opacity:1,Hh:!1,rotation:0,scale:1,Vd:void 0!==b.Vd?b.Vd:!0})}M(mj,oh);B=mj.prototype;B.lb=function(){return this.Z};B.Bc=function(){return this.f};B.R=function(){return this.Ia};B.load=bb;B.$h=bb;
B.ib=function(b,d,g,k){d.setTransform(1,0,0,1,0,0);d.translate(g,k);d.beginPath();d.arc(b.size/2,b.size/2,this.f,0,2*Math.PI,!0);this.h&&(d.fillStyle=bj(this.h.a),d.fill());this.Ia&&(d.strokeStyle=b.strokeStyle,d.lineWidth=b.$e,b.U&&d.setLineDash(b.U),d.stroke());d.closePath()};
B.te=function(b,d,g,k){d.setTransform(1,0,0,1,0,0);d.translate(g,k);d.beginPath();d.arc(b.size/2,b.size/2,this.f,0,2*Math.PI,!0);d.fillStyle=nh(cj);d.fill();this.Ia&&(d.strokeStyle=b.strokeStyle,d.lineWidth=b.$e,b.U&&d.setLineDash(b.U),d.stroke());d.closePath()};function nj(b){b=b||{};this.h=null;this.b=oj;void 0!==b.ra&&pj(this,b.ra);this.f=void 0!==b.fill?b.fill:null;this.g=void 0!==b.Ra?b.Ra:null;this.Ia=void 0!==b.stroke?b.stroke:null;this.i=void 0!==b.text?b.text:null;this.a=b.zIndex}nj.prototype.C=function(){return this.h};nj.prototype.R=function(){return this.Ia};nj.prototype.I=function(){return this.i};function pj(b,d){ka(d)?b.b=d:"string"===typeof d?b.b=function(b){return b.get(d)}:d?void 0!==d&&(b.b=function(){return d}):b.b=oj;b.h=d}
function qj(b){if(!ka(b)){var d;d=Array.isArray(b)?b:[b];b=function(){return d}}return b}var rj=null;function sj(){if(!rj){var b=new gj({color:"rgba(255,255,255,0.4)"}),d=new lj({color:"#3399CC",width:1.25});rj=[new nj({Ra:new mj({fill:b,stroke:d,Rb:5}),fill:b,stroke:d})]}return rj}
function tj(){var b={},d=[255,255,255,1],g=[0,153,255,1];b.Polygon=[new nj({fill:new gj({color:[255,255,255,.5]})})];b.MultiPolygon=b.Polygon;b.LineString=[new nj({stroke:new lj({color:d,width:5})}),new nj({stroke:new lj({color:g,width:3})})];b.MultiLineString=b.LineString;b.Circle=b.Polygon.concat(b.LineString);b.Point=[new nj({Ra:new mj({Rb:6,fill:new gj({color:g}),stroke:new lj({color:d,width:1.5})}),zIndex:Infinity})];b.MultiPoint=b.Point;b.GeometryCollection=b.Polygon.concat(b.LineString,b.Point);
return b}function oj(b){return b.C()};function uj(b){b=b?b:{};var d=ta({},b);delete d.style;delete d.We;delete d.$d;delete d.ae;Tc.call(this,d);this.a=void 0!==b.We?b.We:100;this.s=null;this.i=void 0;d=b.style;this.s=void 0!==d?d:sj;this.i=null===d?void 0:qj(this.s);this.A();this.j=void 0!==b.$d?b.$d:!1;this.l=void 0!==b.ae?b.ae:!1}M(uj,Tc);function vj(b,d,g,k,p){this.g=b;this.da=d;this.j=g;this.G=k;this.ac=p;this.h=this.a=this.f=this.ua=this.ja=this.oa=null;this.Ja=this.ab=this.w=this.P=this.M=this.$=0;this.Ka=!1;this.i=this.bb=0;this.pb=!1;this.V=0;this.b="";this.s=this.B=this.Ib=this.qb=0;this.ca=this.u=this.l=null;this.Z=[];this.Jb=yb()}M(vj,Rc);
function wj(b,d,g){if(b.h){d=qd(d,0,g,2,b.G,b.Z);g=b.g;var k=b.Jb,p=g.globalAlpha;1!=b.w&&(g.globalAlpha=p*b.w);var q=b.bb;b.Ka&&(q+=b.ac);var u,v;u=0;for(v=d.length;u<v;u+=2){var w=d[u]-b.$,z=d[u+1]-b.M;b.pb&&(w=Math.round(w),z=Math.round(z));if(0!==q||1!=b.i){var A=w+b.$,C=z+b.M;ah(k,A,C,b.i,b.i,q,-A,-C);g.setTransform(k[0],k[1],k[4],k[5],k[12],k[13])}g.drawImage(b.h,b.ab,b.Ja,b.V,b.P,w,z,b.V,b.P)}0===q&&1==b.i||g.setTransform(1,0,0,1,0,0);1!=b.w&&(g.globalAlpha=p)}}
function xj(b,d,g,k){var p=0;if(b.ca&&""!==b.b){b.l&&yj(b,b.l);b.u&&zj(b,b.u);var q=b.ca,u=b.g,v=b.ua;v?(v.font!=q.font&&(v.font=u.font=q.font),v.textAlign!=q.textAlign&&(v.textAlign=u.textAlign=q.textAlign),v.textBaseline!=q.textBaseline&&(v.textBaseline=u.textBaseline=q.textBaseline)):(u.font=q.font,u.textAlign=q.textAlign,u.textBaseline=q.textBaseline,b.ua={font:q.font,textAlign:q.textAlign,textBaseline:q.textBaseline});d=qd(d,p,g,k,b.G,b.Z);for(q=b.g;p<g;p+=k){u=d[p]+b.qb;v=d[p+1]+b.Ib;if(0!==
b.B||1!=b.s){var w=ah(b.Jb,u,v,b.s,b.s,b.B,-u,-v);q.setTransform(w[0],w[1],w[4],w[5],w[12],w[13])}b.u&&q.strokeText(b.b,u,v);b.l&&q.fillText(b.b,u,v)}0===b.B&&1==b.s||q.setTransform(1,0,0,1,0,0)}}function Aj(b,d,g,k,p,q){var u=b.g;b=qd(d,g,k,p,b.G,b.Z);u.moveTo(b[0],b[1]);d=b.length;q&&(d-=2);for(g=2;g<d;g+=2)u.lineTo(b[g],b[g+1]);q&&u.closePath();return k}function Bj(b,d,g,k,p){var q,u;q=0;for(u=k.length;q<u;++q)g=Aj(b,d,g,k[q],p,!0);return g}B=vj.prototype;
B.se=function(b){if(mc(this.j,b.J())){if(this.f||this.a){this.f&&yj(this,this.f);this.a&&zj(this,this.a);var d;d=this.G;var g=this.Z,k=b.a;d=k?qd(k,0,k.length,b.F,d,g):null;g=d[2]-d[0];k=d[3]-d[1];g=Math.sqrt(g*g+k*k);k=this.g;k.beginPath();k.arc(d[0],d[1],g,0,2*Math.PI);this.f&&k.fill();this.a&&k.stroke()}""!==this.b&&xj(this,Cj(b),2,2)}};B.Ed=function(b){var d=b.a;b=b.F;this.h&&wj(this,d,d.length);""!==this.b&&xj(this,d,d.length,b)};
B.Dd=function(b){var d=b.a;b=b.F;this.h&&wj(this,d,d.length);""!==this.b&&xj(this,d,d.length,b)};B.ue=function(b){if(mc(this.j,b.J())){if(this.a){zj(this,this.a);var d=this.g,g=b.a;d.beginPath();Aj(this,g,0,g.length,b.F,!1);d.stroke()}""!==this.b&&(b=Dj(b),xj(this,b,2,2))}};
B.ve=function(b){var d=b.J();if(mc(this.j,d)){if(this.a){zj(this,this.a);var d=this.g,g=b.a,k=0,p=b.Ac(),q=b.F;d.beginPath();var u,v;u=0;for(v=p.length;u<v;++u)k=Aj(this,g,k,p[u],q,!1);d.stroke()}""!==this.b&&(b=Ej(b),xj(this,b,b.length,2))}};B.xe=function(b){if(mc(this.j,b.J())){if(this.a||this.f){this.f&&yj(this,this.f);this.a&&zj(this,this.a);var d=this.g;d.beginPath();Bj(this,Sd(b),0,b.Ac(),b.F);this.f&&d.fill();this.a&&d.stroke()}""!==this.b&&(b=Td(b),xj(this,b,2,2))}};
B.we=function(b){if(mc(this.j,b.J())){if(this.a||this.f){this.f&&yj(this,this.f);this.a&&zj(this,this.a);var d=this.g,g=Fj(b),k=0,p=b.b,q=b.F,u,v;u=0;for(v=p.length;u<v;++u){var w=p[u];d.beginPath();k=Bj(this,g,k,w,q);this.f&&d.fill();this.a&&d.stroke()}}""!==this.b&&(b=Gj(b),xj(this,b,b.length,2))}};function yj(b,d){var g=b.g,k=b.oa;k?k.fillStyle!=d.fillStyle&&(k.fillStyle=g.fillStyle=d.fillStyle):(g.fillStyle=d.fillStyle,b.oa={fillStyle:d.fillStyle})}
function zj(b,d){var g=b.g,k=b.ja;k?(k.lineCap!=d.lineCap&&(k.lineCap=g.lineCap=d.lineCap),Cf&&!cd(k.U,d.U)&&g.setLineDash(k.U=d.U),k.lineJoin!=d.lineJoin&&(k.lineJoin=g.lineJoin=d.lineJoin),k.lineWidth!=d.lineWidth&&(k.lineWidth=g.lineWidth=d.lineWidth),k.miterLimit!=d.miterLimit&&(k.miterLimit=g.miterLimit=d.miterLimit),k.strokeStyle!=d.strokeStyle&&(k.strokeStyle=g.strokeStyle=d.strokeStyle)):(g.lineCap=d.lineCap,Cf&&g.setLineDash(d.U),g.lineJoin=d.lineJoin,g.lineWidth=d.lineWidth,g.miterLimit=
d.miterLimit,g.strokeStyle=d.strokeStyle,b.ja={lineCap:d.lineCap,U:d.U,lineJoin:d.lineJoin,lineWidth:d.lineWidth,miterLimit:d.miterLimit,strokeStyle:d.strokeStyle})}B.Ub=function(b,d){if(b){var g=b.a;this.f={fillStyle:bj(g?g:cj)}}else this.f=null;if(d){var g=d.h,k=d.a,p=d.j,q=d.f,u=d.i,v=d.b;this.a={lineCap:void 0!==k?k:"round",U:p?p:dj,lineJoin:void 0!==q?q:"round",lineWidth:this.da*(void 0!==u?u:1),miterLimit:void 0!==v?v:10,strokeStyle:nh(g?g:ej)}}else this.a=null};
B.md=function(b){if(b){var d=b.i,g=b.a,k=b.lb(),p=b.j;this.$=d[0];this.M=d[1];this.P=p[1];this.h=g;this.w=b.s;this.ab=k[0];this.Ja=k[1];this.Ka=b.u;this.bb=b.ha();this.i=b.l;this.pb=b.B;this.V=p[0]}else this.h=null};
B.Fb=function(b){if(b){var d=b.a;d?(d=d.a,this.l={fillStyle:bj(d?d:cj)}):this.l=null;var g=b.R();if(g){var d=g.h,k=g.a,p=g.j,q=g.f,u=g.i,g=g.b;this.u={lineCap:void 0!==k?k:"round",U:p?p:dj,lineJoin:void 0!==q?q:"round",lineWidth:void 0!==u?u:1,miterLimit:void 0!==g?g:10,strokeStyle:nh(d?d:ej)}}else this.u=null;var d=b.jb,k=b.f,p=b.b,q=b.ha(),u=b.g,g=b.I(),v=b.h;b=b.i;this.ca={font:void 0!==d?d:"10px sans-serif",textAlign:void 0!==v?v:"center",textBaseline:void 0!==b?b:"middle"};this.b=void 0!==g?
g:"";this.qb=void 0!==k?this.da*k:0;this.Ib=void 0!==p?this.da*p:0;this.B=void 0!==q?q:0;this.s=this.da*(void 0!==u?u:1)}else this.b=""};function Hj(b){dh.call(this,b);this.V=yb()}M(Hj,dh);
Hj.prototype.j=function(b,d,g){Ij(this,"precompose",g,b,void 0);var k=this.b?this.b.f():null;if(k){var p=d.D,q=void 0!==p;if(q){var u=b.ga,v=b.size[0]*u,w=b.size[1]*u,z=b.L.rotation,A=ec(p),C=[p[2],p[3]],D=[p[2],p[1]],p=dc(p);ch(b.cc,A,A);ch(b.cc,C,C);ch(b.cc,D,D);ch(b.cc,p,p);g.save();fj(g,-z,v/2,w/2);g.beginPath();g.moveTo(A[0]*u,A[1]*u);g.lineTo(C[0]*u,C[1]*u);g.lineTo(D[0]*u,D[1]*u);g.lineTo(p[0]*u,p[1]*u);g.clip();fj(g,z,v/2,w/2)}u=this.u;v=g.globalAlpha;g.globalAlpha=d.opacity;g.drawImage(k,
0,0,+k.width,+k.height,Math.round(u[12]),Math.round(u[13]),Math.round(k.width*u[0]),Math.round(k.height*u[5]));g.globalAlpha=v;q&&g.restore()}Ij(this,"postcompose",g,b,void 0)};function Ij(b,d,g,k,p){var q=b.a;if(hb(q,d)){var u=k.size[0]*k.ga,v=k.size[1]*k.ga,w=k.L.rotation;fj(g,-w,u/2,v/2);b=void 0!==p?p:Jj(b,k,0);new vj(g,k.ga,k.D,b,k.L.rotation);T(q,new Sc(d,q,0,k));fj(g,w,u/2,v/2)}}
function Jj(b,d,g){var k=d.L,p=d.ga;return ah(b.V,p*d.size[0]/2,p*d.size[1]/2,p/k.H,-p/k.H,-k.rotation,-k.T[0]+g,-k.T[1])};var Kj=["Polygon","LineString","Image","Text"];function Lj(b,d,g){this.Ka=b;this.oa=d;this.h=null;this.i=0;this.H=g;this.V=this.P=null;this.b=[];this.f=[];this.ua=yb();this.a=[];this.ja=[];this.ab=yb();this.Ja=yb()}M(Lj,Rc);
function Mj(b,d,g,k,p,q){var u=b.f.length,v=b.Fd(),w=[d[g],d[g+1]],z=[NaN,NaN],A=!0,C,D,E;for(C=g+p;C<k;C+=p)z[0]=d[C],z[1]=d[C+1],E=Yb(v,z),E!==D?(A&&(b.f[u++]=w[0],b.f[u++]=w[1]),b.f[u++]=z[0],b.f[u++]=z[1],A=!1):1===E?(b.f[u++]=z[0],b.f[u++]=z[1],A=!1):A=!0,w[0]=z[0],w[1]=z[1],D=E;C===g+p&&(b.f[u++]=w[0],b.f[u++]=w[1]);q&&(b.f[u++]=d[g],b.f[u++]=d[g+1]);return u}function Nj(b,d){b.P=[0,d,0];b.b.push(b.P);b.V=[0,d,0];b.a.push(b.V)}
function Oj(b,d,g,k,p,q,u,v,w){var z;bh(k,b.ua)?z=b.ja:(z=qd(b.f,0,b.f.length,2,k,b.ja),Cb(b.ua,k));k=!xa(q);var A=0,C=u.length,D=0,E,G=b.ab;b=b.Ja;for(var J,K,N,F;A<C;){var H=u[A],O,Q,P,R;switch(H[0]){case 0:D=H[1];k&&q[I(D).toString()]||!D.C()?A=H[2]:void 0===w||mc(w,D.C().J())?++A:A=H[2];break;case 1:d.beginPath();++A;break;case 2:D=H[1];E=z[D];H=z[D+1];N=z[D+2]-E;D=z[D+3]-H;d.arc(E,H,Math.sqrt(N*N+D*D),0,2*Math.PI,!0);++A;break;case 3:d.closePath();++A;break;case 4:D=H[1];E=H[2];O=H[3];P=H[4]*
g;var W=H[5]*g,L=H[6];Q=H[7];var U=H[8],ca=H[9];N=H[11];F=H[12];var Z=H[13],da=H[14];for(H[10]&&(N+=p);D<E;D+=2){H=z[D]-P;R=z[D+1]-W;Z&&(H=Math.round(H),R=Math.round(R));if(1!=F||0!==N){var Y=H+P,va=R+W;ah(G,Y,va,F,F,N,-Y,-va);d.transform(G[0],G[1],G[4],G[5],G[12],G[13])}Y=d.globalAlpha;1!=Q&&(d.globalAlpha=Y*Q);var va=da+U>O.width?O.width-U:da,Ra=L+ca>O.height?O.height-ca:L;d.drawImage(O,U,ca,va,Ra,H,R,va*g,Ra*g);1!=Q&&(d.globalAlpha=Y);if(1!=F||0!==N)Eb(G,b),d.transform(b[0],b[1],b[4],b[5],b[12],
b[13])}++A;break;case 5:D=H[1];E=H[2];P=H[3];W=H[4]*g;L=H[5]*g;N=H[6];F=H[7]*g;O=H[8];for(Q=H[9];D<E;D+=2){H=z[D]+W;R=z[D+1]+L;if(1!=F||0!==N)ah(G,H,R,F,F,N,-H,-R),d.transform(G[0],G[1],G[4],G[5],G[12],G[13]);U=P.split("\n");ca=U.length;1<ca?(Z=Math.round(1.5*d.measureText("M").width),R-=(ca-1)/2*Z):Z=0;for(da=0;da<ca;da++)Y=U[da],Q&&d.strokeText(Y,H,R),O&&d.fillText(Y,H,R),R+=Z;if(1!=F||0!==N)Eb(G,b),d.transform(b[0],b[1],b[4],b[5],b[12],b[13])}++A;break;case 6:if(void 0!==v&&(D=H[1],D=v(D)))return D;
++A;break;case 7:d.fill();++A;break;case 8:D=H[1];E=H[2];H=z[D];R=z[D+1];N=H+.5|0;F=R+.5|0;if(N!==J||F!==K)d.moveTo(H,R),J=N,K=F;for(D+=2;D<E;D+=2)if(H=z[D],R=z[D+1],N=H+.5|0,F=R+.5|0,N!==J||F!==K)d.lineTo(H,R),J=N,K=F;++A;break;case 9:d.fillStyle=H[1];++A;break;case 10:J=void 0!==H[7]?H[7]:!0;K=H[2];d.strokeStyle=H[1];d.lineWidth=J?K*g:K;d.lineCap=H[3];d.lineJoin=H[4];d.miterLimit=H[5];Cf&&d.setLineDash(H[6]);K=J=NaN;++A;break;case 11:d.font=H[1];d.textAlign=H[2];d.textBaseline=H[3];++A;break;case 12:d.stroke();
++A;break;default:$a("Unknown canvas render instruction"),++A}}}function Pj(b){var d=b.a;d.reverse();var g,k=d.length,p,q,u=-1;for(g=0;g<k;++g)if(p=d[g],q=p[0],6==q)u=g;else if(0==q){p[2]=g;p=b.a;for(q=g;u<q;){var v=p[u];p[u]=p[q];p[q]=v;++u;--q}u=-1}}function Qj(b,d){b.P[2]=b.b.length;b.P=null;b.V[2]=b.a.length;b.V=null;var g=[6,d];b.b.push(g);b.a.push(g)}Lj.prototype.fd=bb;Lj.prototype.Fd=function(){return this.oa};
function Rj(b,d,g){Lj.call(this,b,d,g);this.s=this.ca=null;this.M=this.$=this.G=this.B=this.da=this.Z=this.w=this.u=this.l=this.j=this.g=void 0}M(Rj,Lj);Rj.prototype.Ed=function(b,d){if(this.s){Nj(this,d);var g=b.a,k=this.f.length,g=Mj(this,g,0,g.length,b.F,!1);this.b.push([4,k,g,this.s,this.g,this.j,this.l,this.u,this.w,this.Z,this.da,this.B,this.G,this.$,this.M]);this.a.push([4,k,g,this.ca,this.g,this.j,this.l,this.u,this.w,this.Z,this.da,this.B,this.G,this.$,this.M]);Qj(this,d)}};
Rj.prototype.Dd=function(b,d){if(this.s){Nj(this,d);var g=b.a,k=this.f.length,g=Mj(this,g,0,g.length,b.F,!1);this.b.push([4,k,g,this.s,this.g,this.j,this.l,this.u,this.w,this.Z,this.da,this.B,this.G,this.$,this.M]);this.a.push([4,k,g,this.ca,this.g,this.j,this.l,this.u,this.w,this.Z,this.da,this.B,this.G,this.$,this.M]);Qj(this,d)}};Rj.prototype.fd=function(){Pj(this);this.j=this.g=void 0;this.s=this.ca=null;this.M=this.$=this.B=this.da=this.Z=this.w=this.u=this.G=this.l=void 0};
Rj.prototype.md=function(b){var d=b.i,g=b.j,k=b.b,p=b.a,q=b.lb();this.g=d[0];this.j=d[1];this.ca=k;this.s=p;this.l=g[1];this.u=b.s;this.w=q[0];this.Z=q[1];this.da=b.u;this.B=b.ha();this.G=b.l;this.$=b.B;this.M=g[0]};function Sj(b,d,g){Lj.call(this,b,d,g);this.g={zc:void 0,uc:void 0,vc:null,wc:void 0,xc:void 0,yc:void 0,Ld:0,strokeStyle:void 0,lineCap:void 0,U:null,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}}M(Sj,Lj);
function Tj(b,d,g,k,p){var q=b.f.length;d=Mj(b,d,g,k,p,!1);q=[8,q,d];b.b.push(q);b.a.push(q);return k}B=Sj.prototype;B.Fd=function(){this.h||(this.h=Vb(this.oa),0<this.i&&Ub(this.h,this.H*(this.i+1)/2,this.h));return this.h};
function Uj(b){var d=b.g,g=d.strokeStyle,k=d.lineCap,p=d.U,q=d.lineJoin,u=d.lineWidth,v=d.miterLimit;d.zc==g&&d.uc==k&&cd(d.vc,p)&&d.wc==q&&d.xc==u&&d.yc==v||(d.Ld!=b.f.length&&(b.b.push([12]),d.Ld=b.f.length),b.b.push([10,g,u,k,q,v,p],[1]),d.zc=g,d.uc=k,d.vc=p,d.wc=q,d.xc=u,d.yc=v)}
B.ue=function(b,d){var g=this.g,k=g.lineWidth;void 0!==g.strokeStyle&&void 0!==k&&(Uj(this),Nj(this,d),this.a.push([10,g.strokeStyle,g.lineWidth,g.lineCap,g.lineJoin,g.miterLimit,g.U],[1]),g=b.a,Tj(this,g,0,g.length,b.F),this.a.push([12]),Qj(this,d))};
B.ve=function(b,d){var g=this.g,k=g.lineWidth;if(void 0!==g.strokeStyle&&void 0!==k){Uj(this);Nj(this,d);this.a.push([10,g.strokeStyle,g.lineWidth,g.lineCap,g.lineJoin,g.miterLimit,g.U],[1]);var g=b.Ac(),k=b.a,p=b.F,q=0,u,v;u=0;for(v=g.length;u<v;++u)q=Tj(this,k,q,g[u],p);this.a.push([12]);Qj(this,d)}};B.fd=function(){this.g.Ld!=this.f.length&&this.b.push([12]);Pj(this);this.g=null};
B.Ub=function(b,d){var g=d.h;this.g.strokeStyle=nh(g?g:ej);g=d.a;this.g.lineCap=void 0!==g?g:"round";g=d.j;this.g.U=g?g:dj;g=d.f;this.g.lineJoin=void 0!==g?g:"round";g=d.i;this.g.lineWidth=void 0!==g?g:1;g=d.b;this.g.miterLimit=void 0!==g?g:10;this.g.lineWidth>this.i&&(this.i=this.g.lineWidth,this.h=null)};
function Vj(b,d,g){Lj.call(this,b,d,g);this.g={qe:void 0,zc:void 0,uc:void 0,vc:null,wc:void 0,xc:void 0,yc:void 0,fillStyle:void 0,strokeStyle:void 0,lineCap:void 0,U:null,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}}M(Vj,Lj);
function Wj(b,d,g,k,p){var q=b.g,u=[1];b.b.push(u);b.a.push(u);var v,u=0;for(v=k.length;u<v;++u){var w=k[u],z=b.f.length;g=Mj(b,d,g,w,p,!0);g=[8,z,g];z=[3];b.b.push(g,z);b.a.push(g,z);g=w}d=[7];b.a.push(d);void 0!==q.fillStyle&&b.b.push(d);void 0!==q.strokeStyle&&(q=[12],b.b.push(q),b.a.push(q));return g}B=Vj.prototype;
B.se=function(b,d){var g=this.g,k=g.strokeStyle;if(void 0!==g.fillStyle||void 0!==k){Xj(this);Nj(this,d);this.a.push([9,nh(cj)]);void 0!==g.strokeStyle&&this.a.push([10,g.strokeStyle,g.lineWidth,g.lineCap,g.lineJoin,g.miterLimit,g.U]);var p=b.a,k=this.f.length;Mj(this,p,0,p.length,b.F,!1);p=[1];k=[2,k];this.b.push(p,k);this.a.push(p,k);k=[7];this.a.push(k);void 0!==g.fillStyle&&this.b.push(k);void 0!==g.strokeStyle&&(g=[12],this.b.push(g),this.a.push(g));Qj(this,d)}};
B.xe=function(b,d){var g=this.g,k=g.strokeStyle;if(void 0!==g.fillStyle||void 0!==k)Xj(this),Nj(this,d),this.a.push([9,nh(cj)]),void 0!==g.strokeStyle&&this.a.push([10,g.strokeStyle,g.lineWidth,g.lineCap,g.lineJoin,g.miterLimit,g.U]),g=b.Ac(),k=Sd(b),Wj(this,k,0,g,b.F),Qj(this,d)};
B.we=function(b,d){var g=this.g,k=g.strokeStyle;if(void 0!==g.fillStyle||void 0!==k){Xj(this);Nj(this,d);this.a.push([9,nh(cj)]);void 0!==g.strokeStyle&&this.a.push([10,g.strokeStyle,g.lineWidth,g.lineCap,g.lineJoin,g.miterLimit,g.U]);var g=b.b,k=Fj(b),p=b.F,q=0,u,v;u=0;for(v=g.length;u<v;++u)q=Wj(this,k,q,g[u],p);Qj(this,d)}};B.fd=function(){Pj(this);this.g=null;var b=this.Ka;if(0!==b){var d=this.f,g,k;g=0;for(k=d.length;g<k;++g)d[g]=b*Math.round(d[g]/b)}};
B.Fd=function(){this.h||(this.h=Vb(this.oa),0<this.i&&Ub(this.h,this.H*(this.i+1)/2,this.h));return this.h};
B.Ub=function(b,d){var g=this.g;if(b){var k=b.a;g.fillStyle=bj(k?k:cj)}else g.fillStyle=void 0;d?(k=d.h,g.strokeStyle=nh(k?k:ej),k=d.a,g.lineCap=void 0!==k?k:"round",k=d.j,g.U=k?k.slice():dj,k=d.f,g.lineJoin=void 0!==k?k:"round",k=d.i,g.lineWidth=void 0!==k?k:1,k=d.b,g.miterLimit=void 0!==k?k:10,g.lineWidth>this.i&&(this.i=g.lineWidth,this.h=null)):(g.strokeStyle=void 0,g.lineCap=void 0,g.U=null,g.lineJoin=void 0,g.lineWidth=void 0,g.miterLimit=void 0)};
function Xj(b){var d=b.g,g=d.fillStyle,k=d.strokeStyle,p=d.lineCap,q=d.U,u=d.lineJoin,v=d.lineWidth,w=d.miterLimit;void 0!==g&&d.qe!=g&&(b.b.push([9,g]),d.qe=d.fillStyle);void 0===k||d.zc==k&&d.uc==p&&d.vc==q&&d.wc==u&&d.xc==v&&d.yc==w||(b.b.push([10,k,v,p,u,w,q]),d.zc=k,d.uc=p,d.vc=q,d.wc=u,d.xc=v,d.yc=w)}function Yj(b,d,g){Lj.call(this,b,d,g);this.$=this.G=this.B=null;this.s="";this.da=this.Z=this.w=this.u=0;this.l=this.j=this.g=null}M(Yj,Lj);
function Zj(b,d,g,k,p){if(""!==b.s&&b.l&&(b.g||b.j)){if(b.g){var q=b.g,u=b.B;if(!u||u.fillStyle!=q.fillStyle){var v=[9,q.fillStyle];b.b.push(v);b.a.push(v);u?u.fillStyle=q.fillStyle:b.B={fillStyle:q.fillStyle}}}b.j&&(q=b.j,u=b.G,u&&u.lineCap==q.lineCap&&u.U==q.U&&u.lineJoin==q.lineJoin&&u.lineWidth==q.lineWidth&&u.miterLimit==q.miterLimit&&u.strokeStyle==q.strokeStyle||(v=[10,q.strokeStyle,q.lineWidth,q.lineCap,q.lineJoin,q.miterLimit,q.U,!1],b.b.push(v),b.a.push(v),u?(u.lineCap=q.lineCap,u.U=q.U,
u.lineJoin=q.lineJoin,u.lineWidth=q.lineWidth,u.miterLimit=q.miterLimit,u.strokeStyle=q.strokeStyle):b.G={lineCap:q.lineCap,U:q.U,lineJoin:q.lineJoin,lineWidth:q.lineWidth,miterLimit:q.miterLimit,strokeStyle:q.strokeStyle}));q=b.l;u=b.$;u&&u.font==q.font&&u.textAlign==q.textAlign&&u.textBaseline==q.textBaseline||(v=[11,q.font,q.textAlign,q.textBaseline],b.b.push(v),b.a.push(v),u?(u.font=q.font,u.textAlign=q.textAlign,u.textBaseline=q.textBaseline):b.$={font:q.font,textAlign:q.textAlign,textBaseline:q.textBaseline});
Nj(b,p);q=b.f.length;d=Mj(b,d,0,g,k,!1);d=[5,q,d,b.s,b.u,b.w,b.Z,b.da,!!b.g,!!b.j];b.b.push(d);b.a.push(d);Qj(b,p)}}
Yj.prototype.Fb=function(b){if(b){var d=b.a;d?(d=d.a,d=bj(d?d:cj),this.g?this.g.fillStyle=d:this.g={fillStyle:d}):this.g=null;var g=b.R();if(g){var d=g.h,k=g.a,p=g.j,q=g.f,u=g.i,g=g.b,k=void 0!==k?k:"round",p=p?p.slice():dj,q=void 0!==q?q:"round",u=void 0!==u?u:1,g=void 0!==g?g:10,d=nh(d?d:ej);if(this.j){var v=this.j;v.lineCap=k;v.U=p;v.lineJoin=q;v.lineWidth=u;v.miterLimit=g;v.strokeStyle=d}else this.j={lineCap:k,U:p,lineJoin:q,lineWidth:u,miterLimit:g,strokeStyle:d}}else this.j=null;var w=b.jb,
d=b.f,k=b.b,p=b.ha(),u=b.g,g=b.I(),q=b.h,v=b.i;b=void 0!==w?w:"10px sans-serif";q=void 0!==q?q:"center";v=void 0!==v?v:"middle";this.l?(w=this.l,w.font=b,w.textAlign=q,w.textBaseline=v):this.l={font:b,textAlign:q,textBaseline:v};this.s=void 0!==g?g:"";this.u=void 0!==d?d:0;this.w=void 0!==k?k:0;this.Z=void 0!==p?p:0;this.da=void 0!==u?u:1}else this.s=""};function ak(b,d,g,k){this.w=b;this.i=d;this.u=g;this.j=k;this.f={};this.l=pf(1,1);this.s=yb()}
function bk(b){for(var d in b.f){var g=b.f[d],k;for(k in g)g[k].fd()}}ak.prototype.h=function(b,d,g,k,p){var q=this.s;ah(q,.5,.5,1/d,-1/d,-g,-b[0],-b[1]);var u=this.l;u.clearRect(0,0,1,1);var v;void 0!==this.j&&(v=Sb(),Tb(v,b),Ub(v,d*this.j,v));return ck(this,u,q,g,k,function(b){if(0<u.getImageData(0,0,1,1).data[3]){if(b=p(b))return b;u.clearRect(0,0,1,1)}},v)};
ak.prototype.a=function(b,d){var g=void 0!==b?b.toString():"0",k=this.f[g];void 0===k&&(k={},this.f[g]=k);g=k[d];void 0===g&&(g=new dk[d](this.w,this.i,this.u),k[d]=g);return g};ak.prototype.g=function(){return xa(this.f)};
ak.prototype.b=function(b,d,g,k,p,q){var u=Object.keys(this.f).map(Number);u.sort(Zc);if(!1!==q){var v=this.i;q=v[0];var w=v[1],z=v[2],v=v[3];q=[q,w,q,v,z,v,z,w];qd(q,0,8,2,g,q);b.save();b.beginPath();b.moveTo(q[0],q[1]);b.lineTo(q[2],q[3]);b.lineTo(q[4],q[5]);b.lineTo(q[6],q[7]);b.closePath();b.clip()}var A,C;q=0;for(w=u.length;q<w;++q)for(A=this.f[u[q].toString()],z=0,v=Kj.length;z<v;++z)C=A[Kj[z]],void 0!==C&&Oj(C,b,d,g,k,p,C.b,void 0);b.restore()};
function ck(b,d,g,k,p,q,u){var v=Object.keys(b.f).map(Number);v.sort(function(b,d){return d-b});var w,z,A,C,D;w=0;for(z=v.length;w<z;++w)for(C=b.f[v[w].toString()],A=Kj.length-1;0<=A;--A)if(D=C[Kj[A]],void 0!==D&&(D=Oj(D,d,1,g,k,p,D.a,q,u)))return D}var dk={Image:Rj,LineString:Sj,Polygon:Vj,Text:Yj};function ek(b,d){return I(b)-I(d)}function fk(b,d){var g=.5*b/d;return g*g}function gk(b,d,g,k,p,q){var u;(u=g.g)&&u.$h(p,q);if(p=(0,g.b)(d))k=td(p,k),(0,hk[k.ka()])(b,k,g,d);return!1}
var hk={Point:function(b,d,g,k){var p=g.g;if(p){var q=b.a(g.a,"Image");q.md(p);q.Ed(d,k)}if(p=g.I())b=b.a(g.a,"Text"),b.Fb(p),Zj(b,d.a,2,2,k)},LineString:function(b,d,g,k){var p=g.R();if(p){var q=b.a(g.a,"LineString");q.Ub(null,p);q.ue(d,k)}if(p=g.I())b=b.a(g.a,"Text"),b.Fb(p),Zj(b,Dj(d),2,2,k)},Polygon:function(b,d,g,k){var p=g.f,q=g.R();if(p||q){var u=b.a(g.a,"Polygon");u.Ub(p,q);u.xe(d,k)}if(p=g.I())b=b.a(g.a,"Text"),b.Fb(p),Zj(b,Td(d),2,2,k)},MultiPoint:function(b,d,g,k){var p=g.g;if(p){var q=
b.a(g.a,"Image");q.md(p);q.Dd(d,k)}if(p=g.I())b=b.a(g.a,"Text"),b.Fb(p),g=d.a,Zj(b,g,g.length,d.F,k)},MultiLineString:function(b,d,g,k){var p=g.R();if(p){var q=b.a(g.a,"LineString");q.Ub(null,p);q.ve(d,k)}if(p=g.I())b=b.a(g.a,"Text"),b.Fb(p),d=Ej(d),Zj(b,d,d.length,2,k)},MultiPolygon:function(b,d,g,k){var p=g.f,q=g.R();if(q||p){var u=b.a(g.a,"Polygon");u.Ub(p,q);u.we(d,k)}if(p=g.I())b=b.a(g.a,"Text"),b.Fb(p),d=Gj(d),Zj(b,d,d.length,2,k)},GeometryCollection:function(b,d,g,k){d=d.Qf();var p,q;p=0;for(q=
d.length;p<q;++p)(0,hk[d[p].ka()])(b,d[p],g,k)},Circle:function(b,d,g,k){var p=g.f,q=g.R();if(p||q){var u=b.a(g.a,"Polygon");u.Ub(p,q);u.se(d,k)}if(p=g.I())b=b.a(g.a,"Text"),b.Fb(p),Zj(b,Cj(d),2,2,k)}};var ik=!me()||ge("iPhone")&&!ge("iPod")&&!ge("iPad")||ge("iPad")||ge("iPod");function jk(b,d,g,k){var p;p=Gc(d,b)(g,void 0,g.length);g=d.dc(k,g);d=yc(d);void 0!==d&&(g*=d);d=yc(b);void 0!==d&&(g/=d);b=b.dc(g,p)/g;isFinite(b)&&0<b&&(g/=b);return g}function kk(b,d,g,k){b=g-b;d=k-d;var p=Math.sqrt(b*b+d*d);return[Math.round(g+b/p),Math.round(k+d/p)]}
function lk(b,d,g,k,p,q,u,v,w,z,A){var C=pf(Math.round(g*b),Math.round(g*d));if(0===w.length)return C.canvas;C.scale(g,g);var D=Sb();w.forEach(function(b){b=b.D;b[0]<D[0]&&(D[0]=b[0]);b[2]>D[2]&&(D[2]=b[2]);b[1]<D[1]&&(D[1]=b[1]);b[3]>D[3]&&(D[3]=b[3])});var E=pf(Math.round(g*hc(D)/k),Math.round(g*ic(D)/k)),G=g/k;w.forEach(function(b){E.drawImage(b.Ra,z,z,b.Ra.width-2*z,b.Ra.height-2*z,(b.D[0]-D[0])*G,-(b.D[3]-D[3])*G,hc(b.D)*G,ic(b.D)*G)});var J=ec(u);v.g.forEach(function(b){var d=b.source,p=b.target,
u=d[1][0],v=d[1][1],w=d[2][0],z=d[2][1];b=(p[0][0]-J[0])/q;var A=-(p[0][1]-J[1])/q,G=(p[1][0]-J[0])/q,L=-(p[1][1]-J[1])/q,U=(p[2][0]-J[0])/q,ca=-(p[2][1]-J[1])/q,p=d[0][0],d=d[0][1],u=u-p,v=v-d,w=w-p,z=z-d;a:{u=[[u,v,0,0,G-b],[w,z,0,0,U-b],[0,0,u,v,L-A],[0,0,w,z,ca-A]];v=u.length;for(w=0;w<v;w++);for(w=0;w<v;w++){for(var z=w,Z=Math.abs(u[w][w]),da=w+1;da<v;da++){var Y=Math.abs(u[da][w]);Y>Z&&(Z=Y,z=da)}if(0===Z){u=null;break a}Z=u[z];u[z]=u[w];u[w]=Z;for(z=w+1;z<v;z++)for(Z=-u[z][w]/u[w][w],da=w;da<
v+1;da++)u[z][da]=w==da?0:u[z][da]+Z*u[w][da]}w=Array(v);for(z=v-1;0<=z;z--)for(w[z]=u[z][v]/u[z][z],Z=z-1;0<=Z;Z--)u[Z][v]-=u[Z][z]*w[z];u=w}u&&(C.save(),C.beginPath(),ik?(w=(b+G+U)/3,z=(A+L+ca)/3,v=kk(w,z,b,A),G=kk(w,z,G,L),U=kk(w,z,U,ca),C.moveTo(v[0],v[1]),C.lineTo(G[0],G[1]),C.lineTo(U[0],U[1])):(C.moveTo(b,A),C.lineTo(G,L),C.lineTo(U,ca)),C.closePath(),C.clip(),C.transform(u[0],u[2],u[1],u[3],b,A),C.translate(D[0]-p,D[3]-d),C.scale(k/g,-k/g),C.drawImage(E.canvas,0,0),C.restore())});A&&(C.save(),
C.strokeStyle="black",C.lineWidth=1,v.g.forEach(function(b){var d=b.target;b=(d[0][0]-J[0])/q;var g=-(d[0][1]-J[1])/q,k=(d[1][0]-J[0])/q,p=-(d[1][1]-J[1])/q,u=(d[2][0]-J[0])/q,d=-(d[2][1]-J[1])/q;C.beginPath();C.moveTo(b,g);C.lineTo(k,p);C.lineTo(u,d);C.closePath();C.stroke()}),C.restore());return C.canvas};function mk(b,d,g,k,p){this.b=b;this.h=d;var q={},u=Gc(this.h,this.b);this.f=function(b){var d=b[0]+"/"+b[1];q[d]||(q[d]=u(b));return q[d]};this.i=k;this.u=p*p;this.g=[];this.l=!1;this.s=this.b.bc&&!!k&&!!this.b.J()&&hc(k)==hc(this.b.J());this.a=this.b.J()?hc(this.b.J()):null;this.j=this.h.J()?hc(this.h.J()):null;b=ec(g);d=[g[2],g[3]];k=[g[2],g[1]];g=dc(g);p=this.f(b);var v=this.f(d),w=this.f(k),z=this.f(g);nk(this,b,d,k,g,p,v,w,z,10);if(this.l){var A=Infinity;this.g.forEach(function(b){A=Math.min(A,
b.source[0][0],b.source[1][0],b.source[2][0])});this.g.forEach(function(b){if(Math.max(b.source[0][0],b.source[1][0],b.source[2][0])-A>this.a/2){var d=[[b.source[0][0],b.source[0][1]],[b.source[1][0],b.source[1][1]],[b.source[2][0],b.source[2][1]]];d[0][0]-A>this.a/2&&(d[0][0]-=this.a);d[1][0]-A>this.a/2&&(d[1][0]-=this.a);d[2][0]-A>this.a/2&&(d[2][0]-=this.a);Math.max(d[0][0],d[1][0],d[2][0])-Math.min(d[0][0],d[1][0],d[2][0])<this.a/2&&(b.source=d)}},this)}q={}}
function nk(b,d,g,k,p,q,u,v,w,z){var A=Rb([q,u,v,w]),C=b.a?hc(A)/b.a:null,D=b.b.bc&&.5<C&&1>C,E=!1;if(0<z){if(b.h.b&&b.j)var G=Rb([d,g,k,p]),E=E|.25<hc(G)/b.j;!D&&b.b.b&&C&&(E|=.25<C)}if(E||!b.i||mc(A,b.i)){if(!(E||isFinite(q[0])&&isFinite(q[1])&&isFinite(u[0])&&isFinite(u[1])&&isFinite(v[0])&&isFinite(v[1])&&isFinite(w[0])&&isFinite(w[1])))if(0<z)E=!0;else return;if(0<z&&(E||(C=b.f([(d[0]+k[0])/2,(d[1]+k[1])/2]),A=D?(Kb(q[0],b.a)+Kb(v[0],b.a))/2-Kb(C[0],b.a):(q[0]+v[0])/2-C[0],C=(q[1]+v[1])/2-C[1],
E=A*A+C*C>b.u),E)){Math.abs(d[0]-k[0])<=Math.abs(d[1]-k[1])?(D=[(g[0]+k[0])/2,(g[1]+k[1])/2],A=b.f(D),C=[(p[0]+d[0])/2,(p[1]+d[1])/2],E=b.f(C),nk(b,d,g,D,C,q,u,A,E,z-1),nk(b,C,D,k,p,E,A,v,w,z-1)):(D=[(d[0]+g[0])/2,(d[1]+g[1])/2],A=b.f(D),C=[(k[0]+p[0])/2,(k[1]+p[1])/2],E=b.f(C),nk(b,d,D,C,p,q,A,E,w,z-1),nk(b,D,g,k,C,A,u,v,E,z-1));return}if(D){if(!b.s)return;b.l=!0}b.g.push({source:[q,v,w],target:[d,k,p]});b.g.push({source:[q,u,v],target:[d,g,k]})}}
function ok(b){var d=Sb();b.g.forEach(function(b){b=b.source;Tb(d,b[0]);Tb(d,b[1]);Tb(d,b[2])});return d};function pk(b,d,g,k,p,q){this.u=d;this.s=b.J();var u=d.J(),v=u?lc(g,u):g,u=jk(b,d,jc(v),k);this.i=new mk(b,d,v,this.s,.5*u);this.b=k;this.a=g;b=ok(this.i);this.j=(this.Ya=q(b,u,p))?this.Ya.h:1;this.Oc=this.g=null;p=2;q=[];this.Ya&&(p=0,q=this.Ya.kb());Ag.call(this,g,k,this.j,p,q)}M(pk,Ag);pk.prototype.aa=function(){1==this.state&&(Aa(this.Oc),this.Oc=null);pk.Aa.aa.call(this)};pk.prototype.f=function(){return this.g};
pk.prototype.Lc=function(){var b=this.Ya.W();2==b&&(this.g=lk(hc(this.a)/this.b,ic(this.a)/this.b,this.j,this.Ya.O(),0,this.b,this.a,this.i,[{D:this.Ya.J(),Ra:this.Ya.f()}],0));this.state=b;this.A()};pk.prototype.load=function(){if(0==this.state){this.state=1;this.A();var b=this.Ya.W();2==b||3==b?this.Lc():(this.Oc=S(this.Ya,"change",function(){var b=this.Ya.W();if(2==b||3==b)Aa(this.Oc),this.Oc=null,this.Lc()},this),this.Ya.load())}};function qk(b){Nc.call(this,{xa:b.xa,D:b.D,Fa:b.Fa,ba:b.ba,state:b.state});this.Tb=void 0!==b.yb?b.yb:null;this.a=null;this.i=0}M(qk,Nc);function rk(b,d,g,k,p){var q=b.l;if(q&&p&&!Fc(q,p)){if(b.a){if(b.i==b.f&&Fc(b.a.u,p)&&b.a.O()==g&&b.a.h==k&&ac(b.a.J(),d))return b.a;b.a.qa();b.a=null}b.a=new pk(q,p,d,g,k,function(b){return sk(this,b)}.bind(b));b.i=b.f;return b.a}q&&(p=q);return sk(b,d)}
qk.prototype.g=function(b){b=b.target;switch(b.W()){case 1:T(this,new tk(uk,b));break;case 2:T(this,new tk(vk,b));break;case 3:T(this,new tk(wk,b))}};function xk(b,d){b.f().src=d}function tk(b,d){db.call(this,b);this.Ra=d}M(tk,db);var uk="imageloadstart",vk="imageloadend",wk="imageloaderror";function yk(b){lb.call(this);this.va=void 0;this.b="geometry";this.a=null;this.h=void 0;this.g=null;S(this,ob(this.b),this.cd,this);void 0!==b&&(b instanceof pd||!b?zk(this,b):mb(this,b))}M(yk,lb);B=yk.prototype;B.clone=function(){var b=new yk(ta({},this.$));Ak(b,this.b);var d=this.C();d&&zk(b,d.clone());(d=this.a)&&Bk(b,d);return b};B.C=function(){return this.get(this.b)};B.ya=function(){return this.va};B.Yf=function(){this.A()};
B.cd=function(){this.g&&(Aa(this.g),this.g=null);var b=this.C();b&&(this.g=S(b,"change",this.Yf,this));this.A()};function zk(b,d){b.set(b.b,d)}function Bk(b,d){b.a=d;b.h=d?Ck(d):void 0;b.A()}function Ak(b,d){Fa(b,ob(b.b),b.cd,b);b.b=d;S(b,ob(b.b),b.cd,b);b.cd()}function Ck(b){if(!ka(b)){var d;d=Array.isArray(b)?b:[b];b=function(){return d}}return b};function Dk(b,d,g){return function(k,p,q){var u=new XMLHttpRequest;u.open("GET",ka(b)?b(k,p,q):b,!0);"arraybuffer"==d.ka()&&(u.responseType="arraybuffer");u.onload=function(){if(200<=u.status&&300>u.status){var b=d.ka(),k;"json"==b||"text"==b?k=u.responseText:"xml"==b?(k=u.responseXML,k||(b=u.responseText,k=(new DOMParser).parseFromString(b,"application/xml"))):"arraybuffer"==b?k=u.response:$a("unexpected format type");k?g.call(this,d.Mi(k,{Hi:q}),d.Ni(k)):$a("undefined or null source")}}.bind(this);
u.send()}}function Ek(b,d){return Dk(b,d,function(b){this.zb(b)})};function Fk(){return[[-Infinity,-Infinity,Infinity,Infinity]]};var Gk;
(function(){var b={ye:{}};(function(){function d(b,g){if(!(this instanceof d))return new d(b,g);this.td=Math.max(4,b||9);this.fe=Math.max(2,Math.ceil(.4*this.td));g&&this.lf(g);this.clear()}function g(b,d){b.pa=k(b,0,b.children.length,d)}function k(b,d,g,k){for(var q=[Infinity,Infinity,-Infinity,-Infinity],u;d<g;d++)u=b.children[d],p(q,b.Ca?k(u):u.pa);return q}function p(b,d){b[0]=Math.min(b[0],d[0]);b[1]=Math.min(b[1],d[1]);b[2]=Math.max(b[2],d[2]);b[3]=Math.max(b[3],d[3])}function q(b,d){return b.pa[0]-d.pa[0]}
function u(b,d){return b.pa[1]-d.pa[1]}function v(b){return(b[2]-b[0])*(b[3]-b[1])}function w(b){return b[2]-b[0]+(b[3]-b[1])}function z(b,d){return b[0]<=d[0]&&b[1]<=d[1]&&d[2]<=b[2]&&d[3]<=b[3]}function A(b,d){return d[0]<=b[2]&&d[1]<=b[3]&&d[2]>=b[0]&&d[3]>=b[1]}function C(b,d,g,k,p){for(var q=[d,g],u;q.length;)g=q.pop(),d=q.pop(),g-d<=k||(u=d+Math.ceil((g-d)/k/2)*k,D(b,d,g,u,p),q.push(d,u,u,g))}function D(b,d,g,k,p){for(var q,u,v,w,z;g>d;){600<g-d&&(q=g-d+1,u=k-d+1,v=Math.log(q),w=.5*Math.exp(2*
v/3),z=.5*Math.sqrt(v*w*(q-w)/q)*(0>u-q/2?-1:1),v=Math.max(d,Math.floor(k-u*w/q+z)),u=Math.min(g,Math.floor(k+(q-u)*w/q+z)),D(b,v,u,k,p));q=b[k];u=d;w=g;E(b,d,k);for(0<p(b[g],q)&&E(b,d,g);u<w;){E(b,u,w);u++;for(w--;0>p(b[u],q);)u++;for(;0<p(b[w],q);)w--}0===p(b[d],q)?E(b,d,w):(w++,E(b,w,g));w<=k&&(d=w+1);k<=w&&(g=w-1)}}function E(b,d,g){var k=b[d];b[d]=b[g];b[g]=k}d.prototype={all:function(){return this.be(this.data,[])},search:function(b){var d=this.data,g=[],k=this.Va;if(!A(b,d.pa))return g;for(var p=
[],q,u,v,w;d;){q=0;for(u=d.children.length;q<u;q++)v=d.children[q],w=d.Ca?k(v):v.pa,A(b,w)&&(d.Ca?g.push(v):z(b,w)?this.be(v,g):p.push(v));d=p.pop()}return g},load:function(b){if(!b||!b.length)return this;if(b.length<this.fe){for(var d=0,g=b.length;d<g;d++)this.Ha(b[d]);return this}b=this.de(b.slice(),0,b.length-1,0);this.data.children.length?this.data.height===b.height?this.ge(this.data,b):(this.data.height<b.height&&(d=this.data,this.data=b,b=d),this.ee(b,this.data.height-b.height-1,!0)):this.data=
b;return this},Ha:function(b){b&&this.ee(b,this.data.height-1);return this},clear:function(){this.data={children:[],height:1,pa:[Infinity,Infinity,-Infinity,-Infinity],Ca:!0};return this},remove:function(b){if(!b)return this;for(var d=this.data,g=this.Va(b),k=[],p=[],q,u,v,w;d||k.length;){d||(d=k.pop(),u=k[k.length-1],q=p.pop(),w=!0);if(d.Ca&&(v=d.children.indexOf(b),-1!==v)){d.children.splice(v,1);k.push(d);this.kf(k);break}w||d.Ca||!z(d.pa,g)?u?(q++,d=u.children[q],w=!1):d=null:(k.push(d),p.push(q),
q=0,u=d,d=d.children[0])}return this},Va:function(b){return b},xd:function(b,d){return b[0]-d[0]},yd:function(b,d){return b[1]-d[1]},toJSON:function(){return this.data},be:function(b,d){for(var g=[];b;)b.Ca?d.push.apply(d,b.children):g.push.apply(g,b.children),b=g.pop();return d},de:function(b,d,k,p){var q=k-d+1,u=this.td,v;if(q<=u)return v={children:b.slice(d,k+1),height:1,pa:null,Ca:!0},g(v,this.Va),v;p||(p=Math.ceil(Math.log(q)/Math.log(u)),u=Math.ceil(q/Math.pow(u,p-1)));v={children:[],height:p,
pa:null,Ca:!1};var q=Math.ceil(q/u),u=q*Math.ceil(Math.sqrt(u)),w,z,A;for(C(b,d,k,u,this.xd);d<=k;d+=u)for(z=Math.min(d+u-1,k),C(b,d,z,q,this.yd),w=d;w<=z;w+=q)A=Math.min(w+q-1,z),v.children.push(this.de(b,w,A,p-1));g(v,this.Va);return v},jf:function(b,d,g,k){for(var p,q,u,w,z,A,C,D;;){k.push(d);if(d.Ca||k.length-1===g)break;C=D=Infinity;p=0;for(q=d.children.length;p<q;p++)u=d.children[p],z=v(u.pa),A=u.pa,A=(Math.max(A[2],b[2])-Math.min(A[0],b[0]))*(Math.max(A[3],b[3])-Math.min(A[1],b[1]))-z,A<D?
(D=A,C=z<C?z:C,w=u):A===D&&z<C&&(C=z,w=u);d=w}return d},ee:function(b,d,g){var k=this.Va;g=g?b.pa:k(b);var k=[],q=this.jf(g,this.data,d,k);q.children.push(b);for(p(q.pa,g);0<=d;)if(k[d].children.length>this.td)this.mf(k,d),d--;else break;this.ff(g,k,d)},mf:function(b,d){var k=b[d],p=k.children.length,q=this.fe;this.gf(k,q,p);p=this.hf(k,q,p);p={children:k.children.splice(p,k.children.length-p),height:k.height,pa:null,Ca:!1};k.Ca&&(p.Ca=!0);g(k,this.Va);g(p,this.Va);d?b[d-1].children.push(p):this.ge(k,
p)},ge:function(b,d){this.data={children:[b,d],height:b.height+1,pa:null,Ca:!1};g(this.data,this.Va)},hf:function(b,d,g){var p,q,u,w,z,A,C;z=A=Infinity;for(p=d;p<=g-d;p++)q=k(b,0,p,this.Va),u=k(b,p,g,this.Va),w=Math.max(0,Math.min(q[2],u[2])-Math.max(q[0],u[0]))*Math.max(0,Math.min(q[3],u[3])-Math.max(q[1],u[1])),q=v(q)+v(u),w<z?(z=w,C=p,A=q<A?q:A):w===z&&q<A&&(A=q,C=p);return C},gf:function(b,d,g){var k=b.Ca?this.xd:q,p=b.Ca?this.yd:u,v=this.ce(b,d,g,k);d=this.ce(b,d,g,p);v<d&&b.children.sort(k)},
ce:function(b,d,g,q){b.children.sort(q);q=this.Va;var u=k(b,0,d,q),v=k(b,g-d,g,q),z=w(u)+w(v),A,C;for(A=d;A<g-d;A++)C=b.children[A],p(u,b.Ca?q(C):C.pa),z+=w(u);for(A=g-d-1;A>=d;A--)C=b.children[A],p(v,b.Ca?q(C):C.pa),z+=w(v);return z},ff:function(b,d,g){for(;0<=g;g--)p(d[g].pa,b)},kf:function(b){for(var d=b.length-1,k;0<=d;d--)0===b[d].children.length?0<d?(k=b[d-1].children,k.splice(k.indexOf(b[d]),1)):this.clear():g(b[d],this.Va)},lf:function(b){var d=["return a"," - b",";"];this.xd=new Function("a",
"b",d.join(b[0]));this.yd=new Function("a","b",d.join(b[1]));this.Va=new Function("a","return [a"+b.join(", a")+"];")}};"undefined"!==typeof b?b.ye=d:"undefined"!==typeof self?self.a=d:window.a=d})();Gk=b.ye})();function Hk(b){this.Ta=Gk(b);this.f={};this.a=0}B=Hk.prototype;B.Ha=function(b,d){if(this.a)throw Error("Can not insert value while reading");var g=[b[0],b[1],b[2],b[3],d];this.Ta.Ha(g);this.f[I(d)]=g};B.load=function(b,d){if(this.a)throw Error("Can not insert values while reading");for(var g=Array(d.length),k=0,p=d.length;k<p;k++){var q=b[k],u=d[k],q=[q[0],q[1],q[2],q[3],u];g[k]=q;this.f[I(u)]=q}this.Ta.load(g)};
B.remove=function(b){if(this.a)throw Error("Can not remove value while reading");b=I(b);var d=this.f[b];delete this.f[b];return null!==this.Ta.remove(d)};function Ik(b,d,g){var k=I(g);if(!ac(b.f[k].slice(0,4),d)){if(b.a)throw Error("Can not update extent while reading");b.remove(g);b.Ha(d,g)}}B.getAll=function(){return this.Ta.all().map(function(b){return b[4]})};function Jk(b,d){return b.Ta.search(d).map(function(b){return b[4]})}B.forEach=function(b,d){++this.a;try{return Kk(this.getAll(),b,d)}finally{--this.a}};
function Lk(b,d,g,k){++b.a;try{return Kk(Jk(b,d),g,k)}finally{--b.a}}function Kk(b,d,g){for(var k,p=0,q=b.length;p<q&&!(k=d.call(g,b[p]));p++);return k}B.clear=function(){this.Ta.clear();this.f={}};B.J=function(){return this.Ta.data.pa};function Mk(b){b=b||{};Nc.call(this,{xa:b.xa,Fa:b.Fa,ba:void 0,state:"ready",Na:void 0!==b.Na?b.Na:!0});this.V=bb;this.Ja=b.format;this.ca=b.url;void 0!==b.Dg?this.V=b.Dg:void 0!==this.ca&&(this.V=Ek(this.ca,this.Ja));this.bb=void 0!==b.Rh?b.Rh:Fk;var d=void 0!==b.pd?b.pd:!0;this.a=d?new Hk:null;this.M=new Hk;this.h={};this.g={};this.u={};this.w={};this.j=null;var g,k;b.Qa instanceof qb?(g=b.Qa,k=g.a):Array.isArray(b.Qa)&&(k=b.Qa);d||void 0!==g||(g=new qb(k));void 0!==k&&Nk(this,k);void 0!==g&&Ok(this,
g)}M(Mk,Nc);B=Mk.prototype;B.rc=function(b){Pk(this,b);this.A()};function Pk(b,d){var g=I(d).toString();if(Qk(b,g,d)){Rk(b,g,d);var k=d.C();k?(g=k.J(),b.a&&b.a.Ha(g,d)):b.h[g]=d;T(b,new Sk("addfeature",d))}}function Rk(b,d,g){b.w[d]=[S(g,"change",b.Se,b),S(g,"propertychange",b.Se,b)]}function Qk(b,d,g){var k=!0,p=g.ya();void 0!==p?p.toString()in b.g?k=!1:b.g[p.toString()]=g:b.u[d]=g;return k}B.zb=function(b){Nk(this,b);this.A()};
function Nk(b,d){var g,k,p,q,u=[],v=[],w=[];k=0;for(p=d.length;k<p;k++)q=d[k],g=I(q).toString(),Qk(b,g,q)&&v.push(q);k=0;for(p=v.length;k<p;k++){q=v[k];g=I(q).toString();Rk(b,g,q);var z=q.C();z?(g=z.J(),u.push(g),w.push(q)):b.h[g]=q}b.a&&b.a.load(u,w);k=0;for(p=v.length;k<p;k++)T(b,new Sk("addfeature",v[k]))}
function Ok(b,d){var g=!1;S(b,"addfeature",function(b){g||(g=!0,d.push(b.fa),g=!1)});S(b,"removefeature",function(b){g||(g=!0,d.remove(b.fa),g=!1)});S(d,"add",function(b){g||(b=b.element,g=!0,this.rc(b),g=!1)},b);S(d,"remove",function(b){g||(b=b.element,g=!0,this.Sb(b),g=!1)},b);b.j=d}
B.clear=function(b){if(b){for(var d in this.w)this.w[d].forEach(Aa);this.j||(this.w={},this.g={},this.u={})}else if(this.a){this.a.forEach(this.gd,this);for(var g in this.h)this.gd(this.h[g])}this.j&&this.j.clear();this.a&&this.a.clear();this.M.clear();this.h={};T(this,new Sk("clear"));this.A()};B.Lb=function(b,d,g){if(this.a)return Lk(this.a,b,d,g);if(this.j)return this.j.forEach(d,g)};B.ma=function(){var b;this.j?b=this.j.a:this.a&&(b=this.a.getAll(),xa(this.h)||ad(b,wa(this.h)));return b};
B.J=function(){return this.a.J()};B.Se=function(b){b=b.target;var d=I(b).toString(),g=b.C();g?(g=g.J(),d in this.h?(delete this.h[d],this.a&&this.a.Ha(g,b)):this.a&&Ik(this.a,g,b)):d in this.h||(this.a&&this.a.remove(b),this.h[d]=b);g=b.ya();void 0!==g?(g=g.toString(),d in this.u?(delete this.u[d],this.g[g]=b):this.g[g]!==b&&(Tk(this,b),this.g[g]=b)):d in this.u||(Tk(this,b),this.u[d]=b);this.A();T(this,new Sk("changefeature",b))};
function Uk(b,d,g,k){var p=b.M;d=b.bb(d,g);var q,u;q=0;for(u=d.length;q<u;++q){var v=d[q];Lk(p,v,function(b){return Wb(b.D,v)})||(b.V.call(b,v,g,k),p.Ha(v,{D:v.slice()}))}}B.Sb=function(b){var d=I(b).toString();d in this.h?delete this.h[d]:this.a&&this.a.remove(b);this.gd(b);this.A()};B.gd=function(b){var d=I(b).toString();this.w[d].forEach(Aa);delete this.w[d];var g=b.ya();void 0!==g?delete this.g[g.toString()]:delete this.u[d];T(this,new Sk("removefeature",b))};
function Tk(b,d){for(var g in b.g)if(b.g[g]===d){delete b.g[g];break}}function Sk(b,d){db.call(this,b);this.fa=d}M(Sk,db);function Vk(b){Hj.call(this,b);this.b=null;this.u=yb()}M(Vk,Hj);Vk.prototype.Db=function(b,d,g,k){var p=this.a;return p.ea().P(b,d.L.H,d.L.rotation,d.Xb,function(b){return g.call(k,b,p)})};
Vk.prototype.l=function(b,d){var g=b.ga,k=b.L,p=k.T,q=k.H,u=this.a.ea(),v=b.la,w=b.D;void 0!==d.D&&(w=lc(w,d.D));v[0]||v[1]||gc(w)||(k=rk(u,w,q,g,k.ba))&&fh(this,k)&&(this.b=k);if(this.b){var k=this.b,v=k.J(),w=k.O(),z=k.h,q=g*w/(q*z);ah(this.u,g*b.size[0]/2,g*b.size[1]/2,q,q,0,z*(v[0]-p[0])/w,z*(p[1]-v[3])/w);hh(b.xa,k.kb());ih(b,u)}return!!this.b};function Wk(b){Hj.call(this,b);this.h=pf();this.g=null;this.B=Sb();this.s=yb()}M(Wk,Hj);
Wk.prototype.j=function(b,d,g){var k=b.ga,p=b.L,q=p.T,u=p.ba,v=p.rotation,w=b.size,z=Math.round(k*w[0]/2),A=Math.round(k*w[1]/2),C=k/p.H,D=this.a,E=D.ea(),G=E.ad(u),p=Jj(this,b,0);Ij(this,"precompose",g,b,p);var w=g,D=hb(D,"render"),J,K,N,F;if(v||D)w=this.h,J=w.canvas,N=E.i/k,k=g.canvas.width*N,K=g.canvas.height*N,F=Math.round(Math.sqrt(k*k+K*K)),J.width!=F?J.width=J.height=F:w.clearRect(0,0,F,F),J=(F-k)/2/N,K=(F-K)/2/N,C*=N,z=Math.round(N*(z+J)),A=Math.round(N*(A+K));k=w.globalAlpha;w.globalAlpha=
d.opacity;var H=E.mb(u),O=this.g,Q;d=E.Id(u)&&1==d.opacity;d||(O.reverse(),Q=[]);for(var P=0,R=O.length;P<R;++P){var W=O[P],L=W.na,U=Lg(H,L,this.B),ca=L[0],Z=dc(Lg(H,Tg(H,q,ca))),L=Math.round(hc(U)*C),da=Math.round(ic(U)*C),Y=Math.round((U[0]-Z[0])*C/L)*L+z+Math.round((Z[0]-q[0])*C),U=Math.round((Z[1]-U[3])*C/da)*da+A+Math.round((q[1]-Z[1])*C);if(!d){Z=[Y,U,Y+L,U+da];w.save();for(var va=0,Ra=Q.length;va<Ra;++va){var Bb=Q[va];mc(Z,Bb)&&(w.beginPath(),w.moveTo(Z[0],Z[1]),w.lineTo(Z[0],Z[3]),w.lineTo(Z[2],
Z[3]),w.lineTo(Z[2],Z[1]),w.moveTo(Bb[0],Bb[1]),w.lineTo(Bb[2],Bb[1]),w.lineTo(Bb[2],Bb[3]),w.lineTo(Bb[0],Bb[3]),w.closePath(),w.clip())}Q.push(Z)}ca=Yg(E,ca,u);w.drawImage(W.nb(),G,G,ca[0],ca[1],Y,U,L,da);d||w.restore()}D&&(u=J-z/N+z,z=K-A/N+A,q=ah(this.s,F/2-u,F/2-z,C,-C,-v,-q[0]+u/C,-q[1]-z/C),Ij(this,"render",w,b,q));(v||D)&&g.drawImage(w.canvas,-Math.round(J),-Math.round(K),F/N,F/N);w.globalAlpha=k;Ij(this,"postcompose",g,b,p)};
Wk.prototype.l=function(b,d){function g(b){b=b.W();return 2==b||4==b||3==b&&!E}var k=b.ga,p=b.L,q=p.ba,u=this.a,v=u.ea(),w=v.mb(q),z=Sg(w,p.H),A=w.O(z),C=p.T;A==p.H?(C=kh(C,A,b.size),p=kc(C,A,p.rotation,b.size)):p=b.D;void 0!==d.D&&(p=lc(p,d.D));if(gc(p))return!1;A=Og(w,p,A);C={};C[z]={};var D=this.i(v,q,C),E=Wc(u),G=Sb(),J=new Ic(0,0,0,0),K,N,F,H;for(F=A.a;F<=A.f;++F)for(H=A.b;H<=A.g;++H)K=mh(v,z,F,H,k,q),!g(K)&&K.a&&(K=K.a),g(K)?C[z][K.na.toString()]=K:(N=Kg(w,K.na,D,J,G),N||(K=Ng(w,K.na,J,G))&&
D(z+1,K));D=Object.keys(C).map(Number);D.sort(Zc);var G=[],O,J=0;for(F=D.length;J<F;++J)for(O in K=D[J],H=C[K],H)K=H[O],2==K.W()&&G.push(K);this.g=G;jh(b.Sc,v,z,A);lh(b,v,w,k,q,p,z,u.get("preload"));gh(b,v);ih(b,v);return!0};function Xk(b){Hj.call(this,b);this.g=!1;this.M=-1;this.$=NaN;this.B=Sb();this.h=this.G=null;this.s=pf()}M(Xk,Hj);
Xk.prototype.j=function(b,d,g){var k=b.D,p=b.ga,q=d.Gc?b.Xb:{},u=b.L,v=u.ba,u=u.rotation,w=v.J(),z=this.a.ea(),A=Jj(this,b,0);Ij(this,"precompose",g,b,A);var C=this.h;if(C&&!C.g()){var D;hb(this.a,"render")?(this.s.canvas.width=g.canvas.width,this.s.canvas.height=g.canvas.height,D=this.s):D=g;var E=D.globalAlpha;D.globalAlpha=d.opacity;d=b.size[0]*p;var G=b.size[1]*p;fj(D,-u,d/2,G/2);C.b(D,p,A,u,q);if(z.qd&&v.bc&&!Wb(w,k)){for(var v=k[0],z=hc(w),J=0;v<w[0];)--J,A=z*J,A=Jj(this,b,A),C.b(D,p,A,u,q),
v+=z;J=0;for(v=k[2];v>w[2];)++J,A=z*J,A=Jj(this,b,A),C.b(D,p,A,u,q),v-=z;A=Jj(this,b,0)}fj(D,u,d/2,G/2);D!=g&&(Ij(this,"render",D,b,A),g.drawImage(D.canvas,0,0));D.globalAlpha=E}Ij(this,"postcompose",g,b,A)};Xk.prototype.Db=function(b,d,g,k){if(this.h){var p=this.a,q={};return this.h.h(b,d.L.H,d.L.rotation,{},function(b){var d=I(b).toString();if(!(d in q))return q[d]=!0,g.call(k,b,p)})}};Xk.prototype.P=function(){eh(this)};
Xk.prototype.l=function(b){function d(b){var d,k=b.h;k?d=k.call(b,z):(k=g.i)&&(d=k(b,z));if(d){if(d){k=!1;if(Array.isArray(d))for(var p=0,q=d.length;p<q;++p)k=gk(D,b,d[p],fk(z,A),this.P,this)||k;else k=gk(D,b,d,fk(z,A),this.P,this)||k;b=k}else b=!1;this.g=this.g||b}}var g=this.a,k=g.ea();hh(b.xa,k.kb());ih(b,k);var p=b.la[0],q=b.la[1],u=g.j,v=g.l;if(!this.g&&!u&&p||!v&&q)return!0;var w=b.D,v=b.L,p=v.ba,z=v.H,A=b.ga,q=g.f,C=g.a,u=g.get("renderOrder");void 0===u&&(u=ek);w=Ub(w,C*z);C=v.ba.J();k.qd&&
v.ba.bc&&!Wb(C,b.D)&&(b=Math.max(hc(w)/2,hc(C)),w[0]=C[0]-b,w[2]=C[2]+b);if(!this.g&&this.$==z&&this.M==q&&this.G==u&&Wb(this.B,w))return!0;this.h=null;this.g=!1;var D=new ak(.5*z/A,w,z,g.a);Uk(k,w,z,p);if(u){var E=[];k.Lb(w,function(b){E.push(b)},this);E.sort(u);E.forEach(d,this)}else k.Lb(w,d,this);bk(D);this.$=z;this.M=q;this.G=u;this.B=w;this.h=D;return!0};function Yk(b,d){var g=/\{z\}/g,k=/\{x\}/g,p=/\{y\}/g,q=/\{-y\}/g;return function(u){if(u)return b.replace(g,u[0].toString()).replace(k,u[1].toString()).replace(p,function(){return(-u[2]-1).toString()}).replace(q,function(){var b=d.a?d.a[u[0]]:null;return(b.g-b.b+1+u[2]).toString()})}}function Zk(b,d){for(var g=b.length,k=Array(g),p=0;p<g;++p)k[p]=Yk(b[p],d);return $k(k)}function $k(b){return 1===b.length?b[0]:function(d,g,k){if(d)return b[Kb((d[1]<<d[0])+d[2],b.length)](d,g,k)}}function al(){};function bl(b){Wg.call(this,{xa:b.xa,Xc:b.Xc,D:b.D,Fa:b.Fa,Ic:b.Ic,ba:b.ba,state:b.state,Da:b.Da,Qc:b.Qc,Na:b.Na});this.oc=b.oc;this.Gb=this.g?this.g.bind(this):al;this.pc=null;if(b.pc){var d=b.pc;this.pc=d;cl(this,this.g?this.g.bind(this):Zk(d,this.Da))}else if(b.url){var d=b.url,g=[],k=/\{(\d)-(\d)\}/.exec(d)||/\{([a-z])-([a-z])\}/.exec(d);if(k){var p=k[2].charCodeAt(0),q;for(q=k[1].charCodeAt(0);q<=p;++q)g.push(d.replace(k[0],String.fromCharCode(q)))}else g.push(d);d=this.pc=g;cl(this,this.g?this.g.bind(this):
Zk(d,this.Da))}b.Gb&&cl(this,b.Gb)}M(bl,Wg);bl.prototype.j=function(b){switch(b.target.W()){case 1:T(this,new $g("tileloadstart"));break;case 2:T(this,new $g("tileloadend"));break;case 3:T(this,new $g("tileloaderror"))}};function cl(b,d){b.a.clear();b.Gb=d;b.A()}bl.prototype.bf=function(b,d,g){b=this.bd(b,d,g);Dg(this.a,b)&&this.a.get(b)};function dl(b,d){qh.call(this,0,d);this.g=pf();pf();this.a=this.g.canvas;this.a.style.width="100%";this.a.style.height="100%";this.a.className="ol-unselectable";Te(b,this.a,0);this.f=!0;this.h=yb()}M(dl,qh);dl.prototype.Bd=function(b){if(b instanceof aj)return new Vk(b);if(b instanceof Vc)return new Wk(b);if(b instanceof uj)return new Xk(b);$a("unexpected layer configuration");return null};
function el(b,d,g){var k=b.Ba(),p=b.g;if(hb(k,d)){var q=g.D,u=g.ga,v=g.L.rotation,w=g.ga,z=g.L,A=z.H;b=ah(b.h,b.a.width/2,b.a.height/2,w/A,-w/A,-z.rotation,-z.T[0],-z.T[1]);new vj(p,u,q,b,v);T(k,new Sc(d,k,0,g))}}dl.prototype.ka=function(){return"canvas"};
dl.prototype.jd=function(b){if(b){var d=this.g,g=b.ga,k=Math.round(b.size[0]*g),g=Math.round(b.size[1]*g);this.a.width!=k||this.a.height!=g?(this.a.width=k,this.a.height=g):d.clearRect(0,0,k,g);var p=b.L.rotation;rh(b);el(this,"precompose",b);var q=b.Ob;dd(q);fj(d,p,k/2,g/2);var u=b.L.H,v,w,z,A;v=0;for(w=q.length;v<w;++v)A=q[v],z=A.Bb,z=th(this,z),Uc(A,u)&&"ready"==A.Wd&&z.l(b,A)&&z.j(b,A,d);fj(d,-p,k/2,g/2);el(this,"postcompose",b);this.f||(ef(this.a,!0),this.f=!0);uh(this,b);b.gb.push(sh)}else this.f&&
(ef(this.a,!1),this.f=!1)};function fl(b,d){dh.call(this,b);this.target=d}M(fl,dh);fl.prototype.Yc=bb;fl.prototype.Me=bb;function gl(b){var d=document.createElement("DIV");d.style.position="absolute";fl.call(this,b,d);this.b=null;this.g=Ab()}M(gl,fl);gl.prototype.Db=function(b,d,g,k){var p=this.a;return p.ea().P(b,d.L.H,d.L.rotation,d.Xb,function(b){return g.call(k,b,p)})};gl.prototype.Yc=function(){Se(this.target);this.b=null};
gl.prototype.Md=function(b,d){var g=b.L,k=g.T,p=g.H,q=g.rotation,u=this.b,v=this.a.ea(),w=b.la,z=b.D;void 0!==d.D&&(z=lc(z,d.D));w[0]||w[1]||gc(z)||(g=rk(v,z,p,b.ga,g.ba))&&fh(this,g)&&(u=g);u&&(w=u.J(),z=u.O(),g=yb(),ah(g,b.size[0]/2,b.size[1]/2,z/p,z/p,q,(w[0]-k[0])/z,(k[1]-w[3])/z),u!=this.b&&(k=u.f(this),k.style.maxWidth="none",k.style.position="absolute",Se(this.target),this.target.appendChild(k),this.b=u),bh(g,this.g)||(tf(this.target,g),Cb(this.g,g)),hh(b.xa,u.kb()),ih(b,v));return!0};function hl(b){var d=document.createElement("DIV");d.style.position="absolute";fl.call(this,b,d);this.g=!0;this.j=1;this.h=0;this.b={}}M(hl,fl);hl.prototype.Yc=function(){Se(this.target);this.h=0};
hl.prototype.Md=function(b,d){if(!d.visible)return this.g&&(ef(this.target,!1),this.g=!1),!0;var g=b.ga,k=b.L,p=k.ba,q=this.a,u=q.ea(),v=u.mb(p),w=u.ad(p),z=Sg(v,k.H),A=v.O(z),C=k.T,D;A==k.H?(C=kh(C,A,b.size),D=kc(C,A,k.rotation,b.size)):D=b.D;void 0!==d.D&&(D=lc(D,d.D));var A=Og(v,D,A),E={};E[z]={};var G=this.i(u,p,E),J=Wc(q),K=Sb(),N=new Ic(0,0,0,0),F,H,O,Q;for(O=A.a;O<=A.f;++O)for(Q=A.b;Q<=A.g;++Q)F=mh(u,z,O,Q,g,p),H=F.W(),H=2==H||4==H||3==H&&!J,!H&&F.a&&(F=F.a),H=F.W(),2==H?E[z][F.na.toString()]=
F:4==H||3==H&&!J||(H=Kg(v,F.na,G,N,K),H||(F=Ng(v,F.na,N,K))&&G(z+1,F));var P;if(this.h!=u.f){for(P in this.b)J=this.b[+P],Ue(J.target);this.b={};this.h=u.f}K=Object.keys(E).map(Number);K.sort(Zc);var G={},R;O=0;for(Q=K.length;O<Q;++O){P=K[O];P in this.b?J=this.b[P]:(J=Tg(v,C,P),J=new il(v,J),G[P]=!0,this.b[P]=J);P=E[P];for(R in P){F=J;H=P[R];var W=w,L=H.na,U=L[0],ca=L[1],Z=L[2],L=L.toString();if(!(L in F.f)){var U=Qb(Rg(F.h,U),F.l),da=H.nb(F),Y=da.style;Y.maxWidth="none";var va=void 0,Ra=void 0;0<
W?(va=document.createElement("DIV"),Ra=va.style,Ra.overflow="hidden",Ra.width=U[0]+"px",Ra.height=U[1]+"px",Y.position="absolute",Y.left=-W+"px",Y.top=-W+"px",Y.width=U[0]+2*W+"px",Y.height=U[1]+2*W+"px",va.appendChild(da)):(Y.width=U[0]+"px",Y.height=U[1]+"px",va=da,Ra=Y);Ra.position="absolute";Ra.left=(ca-F.b[1])*U[0]+"px";Ra.top=(F.b[2]-Z)*U[1]+"px";F.a||(F.a=document.createDocumentFragment());F.a.appendChild(va);F.f[L]=H}}J.a&&(J.target.appendChild(J.a),J.a=null)}w=Object.keys(this.b).map(Number);
w.sort(Zc);O=yb();R=0;for(K=w.length;R<K;++R)if(P=w[R],J=this.b[P],P in E)if(F=J.O(),Q=J.lb(),ah(O,b.size[0]/2,b.size[1]/2,F/k.H,F/k.H,k.rotation,(Q[0]-C[0])/F,(C[1]-Q[1])/F),J.setTransform(O),P in G){for(--P;0<=P;--P)if(P in this.b){Q=this.b[P].target;Q.parentNode&&Q.parentNode.insertBefore(J.target,Q.nextSibling);break}0>P&&Te(this.target,J.target,0)}else{if(!b.la[0]&&!b.la[1]){H=Mg(J.h,D,J.b[0],N);P=[];F=Q=void 0;for(F in J.f)Q=J.f[F],W=Q.na,Jc(H,W[1],W[2])||P.push(Q);W=H=void 0;H=0;for(W=P.length;H<
W;++H)Q=P[H],F=Q.na.toString(),Ue(Q.nb(J)),delete J.f[F]}}else Ue(J.target),delete this.b[P];d.opacity!=this.j&&(this.j=this.target.style.opacity=d.opacity);d.visible&&!this.g&&(ef(this.target,!0),this.g=!0);jh(b.Sc,u,z,A);lh(b,u,v,g,p,D,z,q.get("preload"));gh(b,u);ih(b,u);return!0};
function il(b,d){this.target=document.createElement("DIV");this.target.style.position="absolute";this.target.style.width="100%";this.target.style.height="100%";this.h=b;this.b=d;this.i=ec(Lg(b,d));this.j=b.O(d[0]);this.f={};this.a=null;this.g=Ab();this.l=[0,0]}il.prototype.lb=function(){return this.i};il.prototype.O=function(){return this.j};il.prototype.setTransform=function(b){bh(b,this.g)||(tf(this.target,b),Cb(this.g,b))};function jl(b){this.h=pf();var d=this.h.canvas;d.style.maxWidth="none";d.style.position="absolute";fl.call(this,b,d);this.b=!1;this.j=-1;this.u=NaN;this.l=Sb();this.g=this.s=null;this.G=yb();this.B=yb()}M(jl,fl);B=jl.prototype;B.Yc=function(){var b=this.h.canvas;b.width=b.width;this.j=0};
B.Me=function(b,d){var g=b.L,k=g.T,p=g.rotation,q=g.H,g=b.ga,u=b.size[0],v=b.size[1],w=u*g,z=v*g,k=ah(this.G,g*u/2,g*v/2,g/q,-g/q,-p,-k[0],-k[1]),q=this.h;q.canvas.width=w;q.canvas.height=z;u=ah(this.B,0,0,1/g,1/g,0,-(w-u)/2*g,-(z-v)/2*g);tf(q.canvas,u);kl(this,"precompose",b,k);(u=this.g)&&!u.g()&&(q.globalAlpha=d.opacity,u.b(q,g,k,p,d.Gc?b.Xb:{}),kl(this,"render",b,k));kl(this,"postcompose",b,k)};
function kl(b,d,g,k){var p=b.h;b=b.a;hb(b,d)&&(new vj(p,g.ga,g.D,k,g.L.rotation),T(b,new Sc(d,b,0,g)))}B.Db=function(b,d,g,k){if(this.g){var p=this.a,q={};return this.g.h(b,d.L.H,d.L.rotation,{},function(b){var d=I(b).toString();if(!(d in q))return q[d]=!0,g.call(k,b,p)})}};B.Ne=function(){eh(this)};
B.Md=function(b){function d(b){var d,k=b.h;k?d=k.call(b,w):(k=g.i)&&(d=k(b,w));if(d){if(d){k=!1;if(Array.isArray(d))for(var p=0,q=d.length;p<q;++p)k=gk(A,b,d[p],fk(w,z),this.Ne,this)||k;else k=gk(A,b,d,fk(w,z),this.Ne,this)||k;b=k}else b=!1;this.b=this.b||b}}var g=this.a,k=g.ea();hh(b.xa,k.kb());ih(b,k);var p=b.la[0],q=b.la[1],u=g.j,v=g.l;if(!this.b&&!u&&p||!v&&q)return!0;var q=b.D,u=b.L,p=u.ba,w=u.H,z=b.ga;b=g.f;v=g.a;u=g.get("renderOrder");void 0===u&&(u=ek);q=Ub(q,v*w);if(!this.b&&this.u==w&&this.j==
b&&this.s==u&&Wb(this.l,q))return!0;this.g=null;this.b=!1;var A=new ak(.5*w/z,q,w,g.a);Uk(k,q,w,p);if(u){var C=[];k.Lb(q,function(b){C.push(b)},this);C.sort(u);C.forEach(d,this)}else k.Lb(q,d,this);bk(A);this.u=w;this.j=b;this.s=u;this.l=q;this.g=A;return!0};function ll(b,d){qh.call(this,0,d);this.g=pf();var g=this.g.canvas;g.style.position="absolute";g.style.width="100%";g.style.height="100%";g.className="ol-unselectable";Te(b,g,0);this.h=yb();this.a=document.createElement("DIV");this.a.className="ol-unselectable";g=this.a.style;g.position="absolute";g.width="100%";g.height="100%";S(this.a,"touchstart",fb);Te(b,this.a,0);this.f=!0}M(ll,qh);ll.prototype.aa=function(){Ue(this.a);ll.Aa.aa.call(this)};
ll.prototype.Bd=function(b){if(b instanceof aj)b=new gl(b);else if(b instanceof Vc)b=new hl(b);else if(b instanceof uj)b=new jl(b);else return $a("unexpected layer configuration"),null;return b};function ml(b,d,g){var k=b.Ba();if(hb(k,d)){var p=g.D,q=g.ga,u=g.L,v=u.rotation,w=b.g,z=w.canvas;ah(b.h,z.width/2,z.height/2,q/u.H,-q/u.H,-u.rotation,-u.T[0],-u.T[1]);new vj(w,q,p,b.h,v);T(k,new Sc(d,k,0,g))}}ll.prototype.ka=function(){return"dom"};
ll.prototype.jd=function(b){if(b){var d=this.Ba();if(hb(d,"precompose")||hb(d,"postcompose")){var d=this.g.canvas,g=b.ga;d.width=b.size[0]*g;d.height=b.size[1]*g}ml(this,"precompose",b);d=b.Ob;dd(d);var g=b.L.H,k,p,q,u;k=0;for(p=d.length;k<p;++k)u=d[k],q=u.Bb,q=th(this,q),Te(this.a,q.target,k),Uc(u,g)&&"ready"==u.Wd?q.Md(b,u)&&q.Me(b,u):q.Yc();var d=b.Fc,v;for(v in this.b)v in d||(q=this.b[v],Ue(q.target));this.f||(ef(this.a,!0),this.f=!0);rh(b);uh(this,b);b.gb.push(sh);ml(this,"postcompose",b)}else this.f&&
(ef(this.a,!1),this.f=!1)};function nl(b){this.a=b}nl.prototype.ea=function(){return this.a};function ol(b){this.a=b}M(ol,nl);ol.prototype.ka=function(){return 35632};function pl(b){this.a=b}M(pl,nl);pl.prototype.ka=function(){return 35633};function ql(){this.a="precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n"}M(ql,ol);ea(ql);
function rl(){this.a="varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0., 0.);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n"}
M(rl,pl);ea(rl);function sl(b,d){this.l=b.getUniformLocation(d,"u_offsetRotateMatrix");this.s=b.getUniformLocation(d,"u_offsetScaleMatrix");this.i=b.getUniformLocation(d,"u_opacity");this.j=b.getUniformLocation(d,"u_projectionMatrix");this.a=b.getAttribLocation(d,"a_offsets");this.f=b.getAttribLocation(d,"a_opacity");this.g=b.getAttribLocation(d,"a_position");this.b=b.getAttribLocation(d,"a_rotateWithView");this.h=b.getAttribLocation(d,"a_texCoord")};function tl(b){this.a=void 0!==b?b:[]};function ul(b,d){this.j=b;this.a=d;this.f={};this.h={};this.g={};this.s=this.u=this.i=this.l=null;(this.b=0<=sa.indexOf("OES_element_index_uint"))&&d.getExtension("OES_element_index_uint");S(this.j,"webglcontextlost",this.w,this);S(this.j,"webglcontextrestored",this.Z,this)}M(ul,cb);
function vl(b,d,g){var k=b.a,p=g.a,q=String(I(g));if(q in b.f)k.bindBuffer(d,b.f[q].buffer);else{var u=k.createBuffer();k.bindBuffer(d,u);var v;34962==d?v=new Float32Array(p):34963==d?v=b.b?new Uint32Array(p):new Uint16Array(p):$a();k.bufferData(d,v,35044);b.f[q]={Gi:g,buffer:u}}}function wl(b,d){var g=b.a,k=String(I(d)),p=b.f[k];g.isContextLost()||g.deleteBuffer(p.buffer);delete b.f[k]}
ul.prototype.aa=function(){Ga(this.j);var b=this.a;if(!b.isContextLost()){for(var d in this.f)b.deleteBuffer(this.f[d].buffer);for(d in this.g)b.deleteProgram(this.g[d]);for(d in this.h)b.deleteShader(this.h[d]);b.deleteFramebuffer(this.i);b.deleteRenderbuffer(this.s);b.deleteTexture(this.u)}};
function xl(b){if(!b.i){var d=b.a,g=d.createFramebuffer();d.bindFramebuffer(d.FRAMEBUFFER,g);var k=yl(d,1,1),p=d.createRenderbuffer();d.bindRenderbuffer(d.RENDERBUFFER,p);d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,1,1);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,k,0);d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,p);d.bindTexture(d.TEXTURE_2D,null);d.bindRenderbuffer(d.RENDERBUFFER,null);d.bindFramebuffer(d.FRAMEBUFFER,null);b.i=g;
b.u=k;b.s=p}return b.i}function zl(b,d){var g=String(I(d));if(g in b.h)return b.h[g];var k=b.a,p=k.createShader(d.ka());k.shaderSource(p,d.ea());k.compileShader(p);return b.h[g]=p}function Al(b,d,g){var k=I(d)+"/"+I(g);if(k in b.g)return b.g[k];var p=b.a,q=p.createProgram();p.attachShader(q,zl(b,d));p.attachShader(q,zl(b,g));p.linkProgram(q);return b.g[k]=q}ul.prototype.w=function(){ua(this.f);ua(this.h);ua(this.g);this.s=this.u=this.i=this.l=null};ul.prototype.Z=function(){};
function Bl(b,d){if(d==b.l)return!1;b.a.useProgram(d);b.l=d;return!0}function Cl(b,d,g){var k=b.createTexture();b.bindTexture(b.TEXTURE_2D,k);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);void 0!==d&&b.texParameteri(3553,10242,d);void 0!==g&&b.texParameteri(3553,10243,g);return k}function yl(b,d,g){var k=Cl(b,void 0,void 0);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,d,g,0,b.RGBA,b.UNSIGNED_BYTE,null);return k}
function Dl(b,d){var g=Cl(b,33071,33071);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,d);return g};function El(b,d){this.B=this.da=void 0;this.s=jc(d);this.Z=[];this.i=[];this.$=void 0;this.h=[];this.g=[];this.P=this.M=void 0;this.f=[];this.G=this.l=null;this.V=void 0;this.bb=Ab();this.pb=Ab();this.oa=this.ca=void 0;this.qb=Ab();this.ab=this.ua=this.ja=void 0;this.Ka=[];this.j=[];this.a=[];this.w=null;this.b=[];this.u=[];this.Ja=void 0}M(El,Rc);
function Fl(b,d){var g=b.w,k=b.l,p=b.Ka,q=b.j,u=d.a;return function(){if(!u.isContextLost()){var b,w;b=0;for(w=p.length;b<w;++b)u.deleteTexture(p[b]);b=0;for(w=q.length;b<w;++b)u.deleteTexture(q[b])}wl(d,g);wl(d,k)}}
function Gl(b,d,g,k){var p=b.da,q=b.B,u=b.$,v=b.M,w=b.P,z=b.V,A=b.ca,C=b.oa,D=b.ja?1:0,E=b.ua,G=b.ab,J=b.Ja,K=Math.cos(E),E=Math.sin(E),N=b.f.length,F=b.a.length,H,O,Q,P,R,W;for(H=0;H<g;H+=k)R=d[H]-b.s[0],W=d[H+1]-b.s[1],O=F/8,Q=-G*p,P=-G*(u-q),b.a[F++]=R,b.a[F++]=W,b.a[F++]=Q*K-P*E,b.a[F++]=Q*E+P*K,b.a[F++]=A/w,b.a[F++]=(C+u)/v,b.a[F++]=z,b.a[F++]=D,Q=G*(J-p),P=-G*(u-q),b.a[F++]=R,b.a[F++]=W,b.a[F++]=Q*K-P*E,b.a[F++]=Q*E+P*K,b.a[F++]=(A+J)/w,b.a[F++]=(C+u)/v,b.a[F++]=z,b.a[F++]=D,Q=G*(J-p),P=G*q,
b.a[F++]=R,b.a[F++]=W,b.a[F++]=Q*K-P*E,b.a[F++]=Q*E+P*K,b.a[F++]=(A+J)/w,b.a[F++]=C/v,b.a[F++]=z,b.a[F++]=D,Q=-G*p,P=G*q,b.a[F++]=R,b.a[F++]=W,b.a[F++]=Q*K-P*E,b.a[F++]=Q*E+P*K,b.a[F++]=A/w,b.a[F++]=C/v,b.a[F++]=z,b.a[F++]=D,b.f[N++]=O,b.f[N++]=O+1,b.f[N++]=O+2,b.f[N++]=O,b.f[N++]=O+2,b.f[N++]=O+3}El.prototype.Dd=function(b,d){this.b.push(this.f.length);this.u.push(d);var g=b.a;Gl(this,g,g.length,b.F)};
El.prototype.Ed=function(b,d){this.b.push(this.f.length);this.u.push(d);var g=b.a;Gl(this,g,g.length,b.F)};function Hl(b,d,g,k){var p,q,u,v=d.length;for(u=0;u<v;++u)p=d[u],q=I(p).toString(),q in g?p=g[q]:(p=Dl(k,p),g[q]=p),b[u]=p}
function Il(b,d,g,k,p,q,u,v,w,z,A){var C=d.a;vl(d,34962,b.w);vl(d,34963,b.l);var D=ql.Nb(),E=rl.Nb(),E=Al(d,D,E);b.G?D=b.G:(D=new sl(C,E),b.G=D);Bl(d,E);C.enableVertexAttribArray(D.g);C.vertexAttribPointer(D.g,2,5126,!1,32,0);C.enableVertexAttribArray(D.a);C.vertexAttribPointer(D.a,2,5126,!1,32,8);C.enableVertexAttribArray(D.h);C.vertexAttribPointer(D.h,2,5126,!1,32,16);C.enableVertexAttribArray(D.f);C.vertexAttribPointer(D.f,1,5126,!1,32,24);C.enableVertexAttribArray(D.b);C.vertexAttribPointer(D.b,
1,5126,!1,32,28);E=b.qb;ah(E,0,0,2/(k*q[0]),2/(k*q[1]),-p,-(g[0]-b.s[0]),-(g[1]-b.s[1]));g=b.pb;k=2/q[0];q=2/q[1];Db(g);g[0]=k;g[5]=q;g[10]=1;g[15]=1;q=b.bb;Db(q);0!==p&&Hb(q,-p);C.uniformMatrix4fv(D.j,!1,E);C.uniformMatrix4fv(D.s,!1,g);C.uniformMatrix4fv(D.l,!1,q);C.uniform1f(D.i,u);var G;if(void 0===w)Jl(b,C,d,v,b.Ka,b.Z);else{if(z)a:{p=d.b?5125:5123;d=d.b?4:2;q=b.b.length-1;for(u=b.j.length-1;0<=u;--u)for(C.bindTexture(3553,b.j[u]),z=0<u?b.i[u-1]:0,E=b.i[u];0<=q&&b.b[q]>=z;){G=b.b[q];g=b.u[q];
k=I(g).toString();if(void 0===v[k]&&g.C()&&(void 0===A||mc(A,g.C().J()))&&(C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),C.drawElements(4,E-G,p,G*d),E=w(g))){b=E;break a}E=G;q--}b=void 0}else C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),Jl(b,C,d,v,b.j,b.i),b=(b=w(null))?b:void 0;G=b}C.disableVertexAttribArray(D.g);C.disableVertexAttribArray(D.a);C.disableVertexAttribArray(D.h);C.disableVertexAttribArray(D.f);C.disableVertexAttribArray(D.b);return G}
function Jl(b,d,g,k,p,q){var u=g.b?5125:5123;g=g.b?4:2;if(xa(k)){var v;b=0;k=p.length;for(v=0;b<k;++b){d.bindTexture(3553,p[b]);var w=q[b];d.drawElements(4,w-v,u,v*g);v=w}}else{v=0;var z,w=0;for(z=p.length;w<z;++w){d.bindTexture(3553,p[w]);for(var A=0<w?q[w-1]:0,C=q[w],D=A;v<b.b.length&&b.b[v]<=C;){var E=I(b.u[v]).toString();void 0!==k[E]?(D!==A&&d.drawElements(4,A-D,u,D*g),A=D=v===b.b.length-1?C:b.b[v+1]):A=v===b.b.length-1?C:b.b[v+1];v++}D!==A&&d.drawElements(4,A-D,u,D*g)}}}
El.prototype.md=function(b){var d=b.i,g=b.a,k=b.w,p=b.b,q=b.s,u=b.lb(),v=b.u,w=b.ha(),z=b.j;b=b.l;var A;0===this.h.length?this.h.push(g):(A=this.h[this.h.length-1],I(A)!=I(g)&&(this.Z.push(this.f.length),this.h.push(g)));0===this.g.length?this.g.push(p):(A=this.g[this.g.length-1],I(A)!=I(p)&&(this.i.push(this.f.length),this.g.push(p)));this.da=d[0];this.B=d[1];this.$=z[1];this.M=k[1];this.P=k[0];this.V=q;this.ca=u[0];this.oa=u[1];this.ua=w;this.ja=v;this.ab=b;this.Ja=z[0]};
function Kl(b,d,g){this.j=d;this.l=b;this.i=g;this.f={}}function Ll(b,d){var g=[],k;for(k in b.f)g.push(Fl(b.f[k],d));return function(){for(var b=g.length,d,k=0;k<b;k++)d=g[k].apply(this,arguments);return d}}
function Ml(b,d){for(var g in b.f){var k=b.f[g],p=d,q=p.a;k.Z.push(k.f.length);k.i.push(k.f.length);k.w=new tl(k.a);vl(p,34962,k.w);k.l=new tl(k.f);vl(p,34963,k.l);p={};Hl(k.Ka,k.h,p,q);Hl(k.j,k.g,p,q);k.da=void 0;k.B=void 0;k.$=void 0;k.h=null;k.g=null;k.M=void 0;k.P=void 0;k.f=null;k.V=void 0;k.ca=void 0;k.oa=void 0;k.ja=void 0;k.ua=void 0;k.ab=void 0;k.a=null;k.Ja=void 0}}Kl.prototype.a=function(b,d){var g=this.f[d];void 0===g&&(g=new Nl[d](this.l,this.j),this.f[d]=g);return g};
Kl.prototype.g=function(){return xa(this.f)};Kl.prototype.b=function(b,d,g,k,p,q,u,v){var w,z;q=0;for(w=Kj.length;q<w;++q)z=this.f[Kj[q]],void 0!==z&&Il(z,b,d,g,k,p,u,v,void 0,!1)};function Ol(b,d,g,k,p,q,u,v,w){var z=Pl,A,C;for(A=Kj.length-1;0<=A;--A)if(C=b.f[Kj[A]],void 0!==C&&(C=Il(C,d,g,k,p,z,q,u,v,!0,w)))return C}
Kl.prototype.h=function(b,d,g,k,p,q,u,v,w,z){var A=d.a;A.bindFramebuffer(A.FRAMEBUFFER,xl(d));var C;void 0!==this.i&&(C=Ub($b(b),k*this.i));return Ol(this,d,b,k,p,v,w,function(b){var d=new Uint8Array(4);A.readPixels(0,0,1,1,A.RGBA,A.UNSIGNED_BYTE,d);if(0<d[3]&&(b=z(b)))return b},C)};var Nl={Image:El},Pl=[1,1];function Ql(){this.a="precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n"}M(Ql,ol);ea(Ql);
function Rl(){this.a="varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n"}M(Rl,pl);ea(Rl);
function Sl(b,d){this.b=b.getUniformLocation(d,"u_opacity");this.g=b.getUniformLocation(d,"u_projectionMatrix");this.i=b.getUniformLocation(d,"u_texCoordMatrix");this.h=b.getUniformLocation(d,"u_texture");this.a=b.getAttribLocation(d,"a_position");this.f=b.getAttribLocation(d,"a_texCoord")};function Tl(b,d){dh.call(this,d);this.g=b;this.ca=new tl([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);this.j=this.Za=null;this.l=void 0;this.G=yb();this.V=Ab();this.u=null}M(Tl,dh);
function Ul(b,d,g){var k=b.g.g;if(void 0===b.l||b.l!=g){d.gb.push(ra(function(b,d,g){b.isContextLost()||(b.deleteFramebuffer(d),b.deleteTexture(g))},k,b.j,b.Za));d=yl(k,g,g);var p=k.createFramebuffer();k.bindFramebuffer(36160,p);k.framebufferTexture2D(36160,36064,3553,d,0);b.Za=d;b.j=p;b.l=g}else k.bindFramebuffer(36160,b.j)}
Tl.prototype.Oe=function(b,d,g){Vl(this,"precompose",b);vl(g,34962,this.ca);var k=g.a,p=Ql.Nb(),q=Rl.Nb(),p=Al(g,p,q);this.u?q=this.u:this.u=q=new Sl(k,p);Bl(g,p)&&(k.enableVertexAttribArray(q.a),k.vertexAttribPointer(q.a,2,5126,!1,16,0),k.enableVertexAttribArray(q.f),k.vertexAttribPointer(q.f,2,5126,!1,16,8),k.uniform1i(q.h,0));k.uniformMatrix4fv(q.i,!1,this.G);k.uniformMatrix4fv(q.g,!1,this.V);k.uniform1f(q.b,d.opacity);k.bindTexture(3553,this.Za);k.drawArrays(5,0,4);Vl(this,"postcompose",b)};
function Vl(b,d,g){b=b.a;hb(b,d)&&T(b,new Sc(d,b,0,g))}Tl.prototype.w=function(){this.j=this.Za=null;this.l=void 0};function Wl(b,d){Tl.call(this,b,d);this.b=null}M(Wl,Tl);function Xl(b,d){var g=d.f();return Dl(b.g.g,g)}Wl.prototype.Db=function(b,d,g,k){var p=this.a;return p.ea().P(b,d.L.H,d.L.rotation,d.Xb,function(b){return g.call(k,b,p)})};
Wl.prototype.Nd=function(b,d){var g=this.g.g,k=b.ga,p=b.L,q=p.T,u=p.H,v=p.rotation,w=this.b,z=this.Za,A=this.a.ea(),C=b.la,D=b.D;void 0!==d.D&&(D=lc(D,d.D));C[0]||C[1]||gc(D)||(p=rk(A,D,u,k,p.ba))&&fh(this,p)&&(w=p,z=Xl(this,p),this.Za&&b.gb.push(ra(function(b,d){b.isContextLost()||b.deleteTexture(d)},g,this.Za)));w&&(g=this.g.h.j,Yl(this,g.width,g.height,k,q,u,v,w.J()),k=this.G,Db(k),Gb(k,1,-1),Fb(k,0,-1),this.b=w,this.Za=z,hh(b.xa,w.kb()),ih(b,A));return!0};
function Yl(b,d,g,k,p,q,u,v){d*=q;g*=q;b=b.V;Db(b);Gb(b,2*k/d,2*k/g);Hb(b,-u);Fb(b,v[0]-p[0],v[1]-p[1]);Gb(b,(v[2]-v[0])/2,(v[3]-v[1])/2);Fb(b,1,1)};function Zl(){this.a="precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n"}M(Zl,ol);ea(Zl);function $l(){this.a="varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n"}M($l,pl);ea($l);
function am(b,d){this.b=b.getUniformLocation(d,"u_texture");this.g=b.getUniformLocation(d,"u_tileOffset");this.a=b.getAttribLocation(d,"a_position");this.f=b.getAttribLocation(d,"a_texCoord")};function bm(b,d){Tl.call(this,b,d);this.M=Zl.Nb();this.ja=$l.Nb();this.b=null;this.$=new tl([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]);this.B=this.h=null;this.s=-1;this.P=[0,0]}M(bm,Tl);bm.prototype.aa=function(){wl(this.g.h,this.$);bm.Aa.aa.call(this)};bm.prototype.i=function(b,d,g){var k=this.g;return function(p,q){return Xg(b,d,p,q,function(b){var d=Dg(k.f,b.getKey());d&&(g[p]||(g[p]={}),g[p][b.na.toString()]=b);return d})}};bm.prototype.w=function(){bm.Aa.w.call(this);this.b=null};
bm.prototype.Nd=function(b,d,g){var k=this.g,p=g.a,q=b.L,u=q.ba,v=this.a,w=v.ea(),z=w.mb(u),A=Sg(z,q.H),C=z.O(A),D=Yg(w,A,u),E=D[0]/Qb(Rg(z,A),this.P)[0],G=C/E,J=w.ad(u),K=q.T,N;C==q.H?(K=kh(K,C,b.size),N=kc(K,C,q.rotation,b.size)):N=b.D;C=Og(z,N,C);if(this.h&&Kc(this.h,C)&&this.s==w.f)G=this.B;else{var F=[C.f-C.a+1,C.g-C.b+1],H=Math.pow(2,Math.ceil(Math.log(Math.max(F[0]*D[0],F[1]*D[1]))/Math.LN2)),F=G*H,O=z.lb(A),Q=O[0]+C.a*D[0]*G,G=O[1]+C.b*D[1]*G,G=[Q,G,Q+F,G+F];Ul(this,b,H);p.viewport(0,0,H,
H);p.clearColor(0,0,0,0);p.clear(16384);p.disable(3042);H=Al(g,this.M,this.ja);Bl(g,H);this.b||(this.b=new am(p,H));vl(g,34962,this.$);p.enableVertexAttribArray(this.b.a);p.vertexAttribPointer(this.b.a,2,5126,!1,16,0);p.enableVertexAttribArray(this.b.f);p.vertexAttribPointer(this.b.f,2,5126,!1,16,8);p.uniform1i(this.b.b,0);g={};g[A]={};var P=this.i(w,u,g),R=Wc(v),H=!0,Q=Sb(),W=new Ic(0,0,0,0),L,U,ca;for(U=C.a;U<=C.f;++U)for(ca=C.b;ca<=C.g;++ca){O=mh(w,A,U,ca,E,u);if(void 0!==d.D&&(L=Lg(z,O.na,Q),
!mc(L,d.D)))continue;L=O.W();L=2==L||4==L||3==L&&!R;!L&&O.a&&(O=O.a);L=O.W();if(2==L){if(Dg(k.f,O.getKey())){g[A][O.na.toString()]=O;continue}}else if(4==L||3==L&&!R)continue;H=!1;L=Kg(z,O.na,P,W,Q);L||(O=Ng(z,O.na,W,Q))&&P(A+1,O)}d=Object.keys(g).map(Number);d.sort(Zc);for(var P=new Float32Array(4),Z,da,Y,R=0,W=d.length;R<W;++R)for(Z in da=g[d[R]],da)O=da[Z],L=Lg(z,O.na,Q),U=2*(L[2]-L[0])/F,ca=2*(L[3]-L[1])/F,Y=2*(L[0]-G[0])/F-1,L=2*(L[1]-G[1])/F-1,xb(P,U,ca,Y,L),p.uniform4fv(this.b.g,P),cm(k,O,
D,J*E),p.drawArrays(5,0,4);H?(this.h=C,this.B=G,this.s=w.f):(this.B=this.h=null,this.s=-1,b.sb=!0)}jh(b.Sc,w,A,C);var va=k.j;lh(b,w,z,E,u,N,A,v.get("preload"),function(b){var d;(d=2!=b.W()||Dg(k.f,b.getKey()))||(d=b.getKey()in va.mc);d||va.enqueue([b,Qg(z,b.na),z.O(b.na[0]),D,J*E])},this);gh(b,w);ih(b,w);p=this.G;Db(p);Fb(p,(K[0]-G[0])/(G[2]-G[0]),(K[1]-G[1])/(G[3]-G[1]));0!==q.rotation&&Hb(p,q.rotation);Gb(p,b.size[0]*q.H/(G[2]-G[0]),b.size[1]*q.H/(G[3]-G[1]));Fb(p,-.5,-.5);return!0};function dm(b,d){Tl.call(this,b,d);this.h=!1;this.P=-1;this.M=NaN;this.B=Sb();this.s=this.b=this.$=null}M(dm,Tl);B=dm.prototype;B.Oe=function(b,d,g){this.s=d;var k=b.L,p=this.b;p&&!p.g()&&p.b(g,k.T,k.H,k.rotation,b.size,b.ga,d.opacity,d.Gc?b.Xb:{})};B.aa=function(){var b=this.b;b&&(Ll(b,this.g.h)(),this.b=null);dm.Aa.aa.call(this)};
B.Db=function(b,d,g,k){if(this.b&&this.s){var p=d.L,q=this.a,u={};return this.b.h(b,this.g.h,p.T,p.H,p.rotation,d.size,d.ga,this.s.opacity,{},function(b){var d=I(b).toString();if(!(d in u))return u[d]=!0,g.call(k,b,q)})}};B.Pe=function(){eh(this)};
B.Nd=function(b,d,g){function k(b){var d,g=b.h;g?d=g.call(b,z):(g=p.i)&&(d=g(b,z));if(d){if(d){g=!1;if(Array.isArray(d))for(var k=0,q=d.length;k<q;++k)g=gk(D,b,d[k],fk(z,A),this.Pe,this)||g;else g=gk(D,b,d,fk(z,A),this.Pe,this)||g;b=g}else b=!1;this.h=this.h||b}}var p=this.a;d=p.ea();hh(b.xa,d.kb());ih(b,d);var q=b.la[0],u=b.la[1],v=p.j,w=p.l;if(!this.h&&!v&&q||!w&&u)return!0;var u=b.D,v=b.L,q=v.ba,z=v.H,A=b.ga,v=p.f,C=p.a,w=p.get("renderOrder");void 0===w&&(w=ek);u=Ub(u,C*z);if(!this.h&&this.M==
z&&this.P==v&&this.$==w&&Wb(this.B,u))return!0;this.b&&b.gb.push(Ll(this.b,g));this.h=!1;var D=new Kl(.5*z/A,u,p.a);Uk(d,u,z,q);if(w){var E=[];d.Lb(u,function(b){E.push(b)},this);E.sort(w);E.forEach(k,this)}else d.Lb(u,k,this);Ml(D,g);this.M=z;this.P=v;this.$=w;this.B=u;this.b=D;return!0};function em(b,d){qh.call(this,0,d);this.a=document.createElement("CANVAS");this.a.style.width="100%";this.a.style.height="100%";this.a.className="ol-unselectable";Te(b,this.a,0);this.w=this.Z=0;this.da=pf();this.l=!0;this.g=vf(this.a,{antialias:!0,depth:!1,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0});this.h=new ul(this.a,this.g);S(this.a,"webglcontextlost",this.ah,this);S(this.a,"webglcontextrestored",this.bh,this);this.f=new Cg;this.u=null;this.j=new vh(function(b){var d=
b[1];b=b[2];var p=d[0]-this.u[0],d=d[1]-this.u[1];return 65536*Math.log(b)+Math.sqrt(p*p+d*d)/b}.bind(this),function(b){return b[0].getKey()});this.G=function(){if(0!==this.j.a.length){zh(this.j);var b=wh(this.j);cm(this,b[0],b[3],b[4])}return!1}.bind(this);this.i=0;fm(this)}M(em,qh);
function cm(b,d,g,k){var p=b.g,q=d.getKey();if(Dg(b.f,q))b=b.f.get(q),p.bindTexture(3553,b.Za),9729!=b.Ge&&(p.texParameteri(3553,10240,9729),b.Ge=9729),9729!=b.Je&&(p.texParameteri(3553,10240,9729),b.Je=9729);else{var u=p.createTexture();p.bindTexture(3553,u);if(0<k){var v=b.da.canvas,w=b.da;b.Z!==g[0]||b.w!==g[1]?(v.width=g[0],v.height=g[1],b.Z=g[0],b.w=g[1]):w.clearRect(0,0,g[0],g[1]);w.drawImage(d.nb(),k,k,g[0],g[1],0,0,g[0],g[1]);p.texImage2D(3553,0,6408,6408,5121,v)}else p.texImage2D(3553,0,
6408,6408,5121,d.nb());p.texParameteri(3553,10240,9729);p.texParameteri(3553,10241,9729);p.texParameteri(3553,10242,33071);p.texParameteri(3553,10243,33071);b.f.set(q,{Za:u,Ge:9729,Je:9729})}}B=em.prototype;B.Bd=function(b){if(b instanceof aj)return new Wl(this,b);if(b instanceof Vc)return new bm(this,b);if(b instanceof uj)return new dm(this,b);$a("unexpected layer configuration");return null};function gm(b,d,g){b=b.Ba();hb(b,d)&&T(b,new Sc(d,b,0,g))}
B.aa=function(){var b=this.g;b.isContextLost()||this.f.forEach(function(d){d&&b.deleteTexture(d.Za)});this.h.qa();em.Aa.aa.call(this)};B.Lf=function(b,d){for(var g=this.g,k;1024<this.f.g-this.i;){if(k=this.f.a.$b)g.deleteTexture(k.Za);else if(+this.f.a.Kd==d.index)break;else--this.i;this.f.pop()}};B.ka=function(){return"webgl"};B.ah=function(b){b.preventDefault();this.f.clear();this.i=0;b=this.b;for(var d in b)b[d].w()};B.bh=function(){fm(this);this.Ba().S()};
function fm(b){b=b.g;b.activeTexture(33984);b.blendFuncSeparate(770,771,1,771);b.disable(2884);b.disable(2929);b.disable(3089);b.disable(2960)}
B.jd=function(b){var d=this.h,g=this.g;if(g.isContextLost())return!1;if(!b)return this.l&&(ef(this.a,!1),this.l=!1),!1;this.u=b.focus;this.f.set((-b.index).toString(),null);++this.i;gm(this,"precompose",b);var k=[],p=b.Ob;dd(p);var q=b.L.H,u,v,w,z;u=0;for(v=p.length;u<v;++u)z=p[u],Uc(z,q)&&"ready"==z.Wd&&(w=th(this,z.Bb),w.Nd(b,z,d)&&k.push(z));p=b.size[0]*b.ga;q=b.size[1]*b.ga;if(this.a.width!=p||this.a.height!=q)this.a.width=p,this.a.height=q;g.bindFramebuffer(36160,null);g.clearColor(0,0,0,0);
g.clear(16384);g.enable(3042);g.viewport(0,0,this.a.width,this.a.height);u=0;for(v=k.length;u<v;++u)z=k[u],w=th(this,z.Bb),w.Oe(b,z,d);this.l||(ef(this.a,!0),this.l=!0);rh(b);1024<this.f.g-this.i&&b.gb.push(this.Lf.bind(this));0!==this.j.a.length&&(b.gb.push(this.G),b.sb=!0);gm(this,"postcompose",b);uh(this,b);b.gb.push(sh)};
B.Le=function(b,d,g,k,p,q){var u;if(this.g.isContextLost())return!1;var v=d.L,w=d.Ob,z;for(z=w.length-1;0<=z;--z){u=w[z];var A=u.Bb;if(Uc(u,v.H)&&p.call(q,A)&&(u=th(this,A).Db(b,d,g,k)))return u}};var hm=["canvas","webgl","dom"];
function im(b){lb.call(this);var d=jm(b);this.pb=void 0!==b.Bg?b.Bg:!1;this.qb=void 0!==b.Cg?b.Cg:!1;this.Jb=void 0!==b.ga?b.ga:Bf;this.Ib=d.jc;this.Ja=function(){this.j=void 0;this.Eh.call(this,Date.now())}.bind(this);this.Ka=yb();this.ac=yb();this.bb=0;this.b=null;this.ja=Sb();this.w=this.G=null;this.a=document.createElement("DIV");this.a.className="ol-viewport"+(Ef?" ol-touch":"");this.a.style.position="relative";this.a.style.overflow="hidden";this.a.style.width="100%";this.a.style.height="100%";
this.a.style.msTouchAction="none";this.a.style.f="none";this.u=document.createElement("DIV");this.u.className="ol-overlaycontainer";this.a.appendChild(this.u);this.s=document.createElement("DIV");this.s.className="ol-overlaycontainer-stopevent";b=["click","dblclick","mousedown","touchstart","mspointerdown",wg,"mousewheel","wheel"];for(var g=0,k=b.length;g<k;++g)S(this.s,b[g],eb);this.a.appendChild(this.s);this.ca=new og(this);for(var p in zg)S(this.ca,zg[p],this.ze,this);this.V=d.Ec;this.l=null;S(this.a,
"wheel",this.fc,this);S(this.a,"mousewheel",this.fc,this);this.h=d.controls;this.Sa=d.gc;this.i=d.Jc;this.Ue={};this.P=new d.Fh(this.a,this);this.M=null;this.B=[];this.oa=[];this.ua=new Ah(this.Tf.bind(this),this.og.bind(this));this.sd={};S(this,ob("layergroup"),this.Zf,this);S(this,ob("view"),this.pg,this);S(this,ob("size"),this.lg,this);S(this,ob("target"),this.ng,this);mb(this,d.values);this.h.forEach(function(b){b.ta(this)},this);S(this.h,"add",function(b){b.element.ta(this)},this);S(this.h,"remove",
function(b){b.element.ta(null)},this);this.Sa.forEach(function(b){b.ta(this)},this);S(this.Sa,"add",function(b){b.element.ta(this)},this);S(this.Sa,"remove",function(b){b.element.ta(null)},this);this.i.forEach(this.he,this);S(this.i,"add",function(b){this.he(b.element)},this);S(this.i,"remove",function(b){var d=b.element.ya();void 0!==d&&delete this.Ue[d.toString()];b.element.ta(null)},this)}M(im,lb);B=im.prototype;B.rb=function(b){this.Sa.push(b)};function km(b,d){lm(b).get("layers").push(d)}
B.he=function(b){var d=b.ya();void 0!==d&&(this.Ue[d.toString()]=b);b.ta(this)};B.cb=function(b){this.S();Array.prototype.push.apply(this.B,arguments)};B.aa=function(){this.ca.qa();this.P.qa();Fa(this.a,"wheel",this.fc,this);Fa(this.a,"mousewheel",this.fc,this);void 0!==this.g&&(aa.removeEventListener("resize",this.g,!1),this.g=void 0);this.j&&(aa.cancelAnimationFrame(this.j),this.j=void 0);this.set("target",null);im.Aa.aa.call(this)};
function mm(b,d,g,k,p){if(b.b)return d=b.Pa(d),b.P.Le(d,b.b,g,void 0!==k?k:null,void 0!==p?p:nd,null)}function nm(b){b=b.get("target");return void 0!==b?Le(b):null}B.Pa=function(b){var d=this.b;return d?(b=b.slice(),ch(d.Ve,b,b)):null};function lm(b){return b.get("layergroup")}function om(b){return lm(b).get("layers")}function ki(b,d){var g=b.b;if(g){var k=d.slice(0,2);return ch(g.cc,k,k)}return null}function pi(b){return b.get("size")}function V(b){return b.get("view")}
B.Tf=function(b,d,g,k){var p=this.b;if(!(p&&d in p.Tc&&p.Tc[d][b.na.toString()]))return Infinity;b=g[0]-p.focus[0];g=g[1]-p.focus[1];return 65536*Math.log(k)+Math.sqrt(b*b+g*g)/k};B.fc=function(b,d){var g=new mg(d||b.type,this,b);this.ze(g)};B.ze=function(b){if(this.b){this.M=b.b;b.Mb=this.b;var d=this.Sa.a,g;if(!1!==T(this,b))for(g=d.length-1;0<=g;g--){var k=d[g];if(k.get("active")&&!k.handleEvent(b))break}}};
B.kg=function(){var b=this.b,d=this.ua;if(0!==d.a.length){var g=16,k=g;if(b){var p=b.la;p[0]&&(g=this.pb?8:0,k=2);p[1]&&(g=this.qb?8:0,k=2)}if(d.g<g){zh(d);for(var p=0,q,u;d.g<g&&p<k&&0<d.a.length;)q=wh(d)[0],u=q.getKey(),0!==q.W()||u in d.b||(d.b[u]=!0,++d.g,++p,q.load())}}d=this.oa;g=0;for(k=d.length;g<k;++g)d[g](this,b);d.length=0};B.lg=function(){this.S()};
B.ng=function(){var b;this.get("target")&&(b=nm(this));if(this.l){for(var d=0,g=this.l.length;d<g;++d)Aa(this.l[d]);this.l=null}b?(b.appendChild(this.a),b=this.V?this.V:b,this.l=[S(b,"keydown",this.fc,this),S(b,"keypress",this.fc,this)],this.g||(this.g=this.Zd.bind(this),aa.addEventListener("resize",this.g,!1))):(Ue(this.a),void 0!==this.g&&(aa.removeEventListener("resize",this.g,!1),this.g=void 0));this.Zd()};B.og=function(){this.S()};B.qg=function(){this.S()};
B.pg=function(){this.G&&(Aa(this.G),this.G=null);var b=V(this);b&&(this.G=S(b,"propertychange",this.qg,this));this.S()};B.$f=function(){this.S()};B.ag=function(){this.S()};B.Zf=function(){this.w&&(this.w.forEach(Aa),this.w=null);var b=lm(this);b&&(this.w=[S(b,"propertychange",this.ag,this),S(b,"change",this.$f,this)]);this.S()};B.S=function(){void 0===this.j&&(this.j=aa.requestAnimationFrame(this.Ja))};
B.Eh=function(b){var d,g,k,p=pi(this),q=V(this),u=null;if(d=void 0!==p&&0<p[0]&&0<p[1]&&q)d=!!Wd(q)&&void 0!==q.O();if(d){var u=q.b.slice(),v=lm(this).Hd(),w={};d=0;for(g=v.length;d<g;++d)w[I(v[d].Bb)]=v[d];k=q.W();u={sb:!1,xa:{},cc:this.Ka,D:null,focus:this.M?this.M:k.T,index:this.bb++,Fc:w,Ob:v,jc:ta({},this.Ib),ga:this.Jb,Ve:this.ac,gb:[],size:p,Xb:this.sd,Sh:this.ua,time:b,Sc:{},L:k,la:u,Tc:{}}}if(u){b=this.B;d=p=0;for(g=b.length;d<g;++d)q=b[d],q(this,u)&&(b[p++]=q);b.length=p;u.D=kc(k.T,k.H,
k.rotation,u.size)}this.b=u;this.P.jd(u);u&&(u.sb&&this.S(),Array.prototype.push.apply(this.oa,u.gb),0!==this.B.length||u.la[0]||u.la[1]||ac(u.D,this.ja)||(T(this,new kf("moveend",this,u)),Vb(u.D,this.ja)));T(this,new kf("postrender",this,u));d=k=this.kg;this&&(d=qa(k,this));!ka(aa.setImmediate)||aa.Window&&aa.Window.prototype&&!ge("Edge")&&aa.Window.prototype.setImmediate==aa.setImmediate?(pe||(pe=qe()),pe(d)):aa.setImmediate(d)};
B.Zd=function(){var b=nm(this);if(b){var d=Ke(b),g=se&&b.currentStyle;if(g&&"CSS1Compat"==Ie(d).a.compatMode&&"auto"!=g.width&&"auto"!=g.height&&!g.boxSizing)d=ff(b,g.width,"width","pixelWidth"),b=ff(b,g.height,"height","pixelHeight"),b=new He(d,b);else{g=new He(b.offsetWidth,b.offsetHeight);if(se)var d=gf(b,"paddingLeft"),k=gf(b,"paddingRight"),p=gf(b,"paddingTop"),q=gf(b,"paddingBottom"),d=new Xe(p,k,q,d);else d=af(b,"paddingLeft"),k=af(b,"paddingRight"),p=af(b,"paddingTop"),q=af(b,"paddingBottom"),
d=new Xe(parseFloat(p),parseFloat(k),parseFloat(q),parseFloat(d));!se||9<=Number(Ee)?(k=af(b,"borderLeftWidth"),p=af(b,"borderRightWidth"),q=af(b,"borderTopWidth"),b=af(b,"borderBottomWidth"),b=new Xe(parseFloat(q),parseFloat(p),parseFloat(b),parseFloat(k))):(k=jf(b,"borderLeft"),p=jf(b,"borderRight"),q=jf(b,"borderTop"),b=jf(b,"borderBottom"),b=new Xe(q,p,b,k));b=new He(g.width-b.left-d.left-d.right-b.right,g.height-b.top-d.top-d.bottom-b.bottom)}this.set("size",[b.width,b.height])}else this.set("size",
void 0)};
function jm(b){var d=null;void 0!==b.Ec&&(d="string"===typeof b.Ec?document.getElementById(b.Ec):b.Ec);var g={},k={};if(void 0===b.Fa||"boolean"===typeof b.Fa&&b.Fa)k["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC"]="http://openlayers.org/";
else{var p=b.Fa;"string"===typeof p?k[p]="":la(p)&&(k[p.src]=p.href)}p=b.ic instanceof Oi?b.ic:new Oi({ic:b.ic});g.layergroup=p;g.target=b.target;g.view=void 0!==b.view?b.view:new Ud;var p=qh,q;void 0!==b.Kc?Array.isArray(b.Kc)?q=b.Kc:"string"===typeof b.Kc?q=[b.Kc]:$a("Incorrect format for renderer option"):q=hm;var u,v;u=0;for(v=q.length;u<v;++u){var w=q[u];if("canvas"==w){if(Df){p=dl;break}}else if("dom"==w){p=ll;break}else if("webgl"==w&&wf){p=em;break}}void 0!==b.controls?q=Array.isArray(b.controls)?
new qb(b.controls.slice()):b.controls:(q={},u=new qb,(void 0!==q.zoom?q.zoom:1)&&u.push(new Mh(q.Ri)),(void 0!==q.rotate?q.rotate:1)&&u.push(new Kh(q.Pi)),(void 0!==q.rf?q.rf:1)&&u.push(new Ch(q.Di)),q=u);if(void 0!==b.gc)u=Array.isArray(b.gc)?new qb(b.gc.slice()):b.gc;else{u={};v=new qb;w=new Nh;(void 0!==u.qf?u.qf:1)&&v.push(new li);(void 0!==u.Bf?u.Bf:1)&&v.push(new Th({Kb:u.ji,duration:u.rd}));(void 0!==u.Cf?u.Cf:1)&&v.push(new gi({zg:w}));(void 0!==u.oh?u.oh:1)&&v.push(new Gi);(void 0!==u.ph?
u.ph:1)&&v.push(new Ki({duration:u.rd}));if(void 0!==u.yg?u.yg:1)v.push(new Ai),v.push(new Ci({Kb:u.ji,duration:u.rd}));(void 0!==u.Ig?u.Ig:1)&&v.push(new Ei({duration:u.rd}));(void 0!==u.Oh?u.Oh:1)&&v.push(new zi({duration:u.rd}));u=v}b=void 0!==b.Jc?Array.isArray(b.Jc)?new qb(b.Jc.slice()):b.Jc:new qb;return{controls:q,gc:u,Ec:d,jc:k,Jc:b,Fh:p,values:g}}vc(Ti);vc($i);$i.forEach(function(b){Ti.forEach(function(d){wc(b,d,Ui);wc(d,b,Vi)})});function X(b,d){lb.call(this);var g=d||{};this.va=b||-1;try{this.va=parseInt(this.va)}catch(k){b=-1}this.Ua=pm.ne(g.server||"");this.a=pm.hc(this.Ua)?!0:!1;this.a||-1===window.location.href.indexOf("haveMadeCrossOriginLogin_")||(this.a=!0);this.Zc="ome_viewer";"string"===typeof g.yf&&(this.Zc=g.yf);this.v=this.Wa=null;this.$a=new qm;this.Ea=this.o=null;this.De(g.webglue);this.g=function(b,d){if(!(0>b.va)){var g={server:b.Ua,uri:"/webgateway/imgData/"+b.va,jsonp:!0,success:function(g){if("string"===
typeof g)try{g=JSON.parse(g)}catch(q){console.error("Failed to parse json response!")}if("object"!==typeof g)console.error("Image Request did not receive proper response!");else if(b.Wa=g,"undefined"===typeof b.Wa.size)console.error("Image Info does not contain size info!");else{var u=null;g=b.Wa.size;if(b.Wa.zoomLevelScaling){u=[];for(r in b.Wa.zoomLevelScaling)u.push(1/b.Wa.zoomLevelScaling[r]);u=u.reverse()}var z=u?u.length:-1,A=[g.width/2,-g.height/2],C=new rc({code:"OMERO",units:"pixels",D:[0,
0,g.width,g.height]}),D=[],E;for(E in b.Wa.channels){var G=b.Wa.channels[E];D.push({active:G.active,color:G.color,min:G.window.min,max:G.window.max,start:G.window.start,end:G.window.end})}E=new rm({Kh:b.Ua,uri:"/webgateway/render_image_region",Ra:b.va,width:g.width,height:g.height,sh:1<g.z?parseInt(g.z/2):0,wd:D,yb:1<z?u:[1],Vh:b.Wa.tile_size?b.Wa.tile_size:null});g=new Ud({ba:C,T:A,D:[0,-g.height,g.width,0],yb:sm(u),H:1<z?u[0]:1});z=tm();u=new qb;for(inter in z)u.push(z[inter].ref),b.$a.set(inter,
z[inter]);z=um();A=new qb;for(contr in z)A.push(z[contr].ref),b.$a.set(contr,z[contr]);b.o=new im({Fa:!1,controls:A,gc:u,Kc:"canvas",ic:[new Vc({source:E,Qd:Infinity})],target:b.Zc,view:g});"function"===typeof d&&d.call(b)}},error:function(d){console.error("Error retrieving image info for id: "+b.va+(d&&0<d.length?"\\n"+d:""))}};if(b.Ea){var u=pm.tc(g.uri);g.url=g.server.full+"/"+u.full;g.context=this;delete g.jsonp;pm.hc(g.server)||(g.dataType="jsonp");b.Ea.request(g)}else pm.Mc(g)}};pm.hc(this.Ua)||
this.a?this.g(this):pm.He(this.Ua)}M(X,lb);B=X.prototype;B.gh=function(){var b=Le(this.Zc);b&&Ye(b,"visibility","visible")};B.rg=function(){var b=Le(this.Zc);b&&Ye(b,"visibility","hidden")};B.me=function(b,d){var g=this.qa("boolean"===typeof d?d:!1);this.va=b;try{this.va=parseInt(this.va)}catch(k){}pm.hc(this.Ua)||this.a?this.g(this,function(){this.Ea&&vm(this);for(c in g){var b=g[c];wm(this,b.key,b.type)}}):pm.He(this.Ua)};
B.Uc=function(b){this.o instanceof im&&!(this.v instanceof xm)&&(this.v=new xm(this,b),km(this.o,new uj({source:this.v})),ym(this.v,[zm.SELECT]),this.b=S(V(this.o),"change:rotation",function(){var b=Am(this);b&&b.A()},this))};
B.Ze=function(b,d){var g=Bm(this);if(g){var k=b||!1;if(ga(d)&&0!==d.length){if(g=Am(this),"boolean"!==typeof k&&(k=!0),ga(d))for(var p in d){var q=d[p],u=q.indexOf(":");if(!(1>u)){var v=q.substring(0,u),q=q.substring(u+1);try{v=parseInt(v),q=parseInt(q)}catch(w){continue}g.g&&g.g[""+v+":"+q]instanceof yk&&(g.g[""+v+":"+q].visible=k);g.A()}}}else g.set("visible",k)}};
B.Sd=function(b){var d=!1;"boolean"===typeof b&&(d=b);!d&&this.v instanceof xm&&(ym(this.v,[zm.DEFAULT]),this.v.qa(),this.v=null);"undefined"!==typeof this.b&&this.b&&Aa(this.b);if(Bm(this))for(b=sb(om(this.o)),d&&--b,d=b-1;0<d;d--)b=om(this.o).item(d),b.set("source",null),b.b=null,ub(om(this.o),d)};B.Nh=function(b,d){if(Bm(this)){var g=Am(this);"boolean"===typeof b&&(g.ld=b,g.A());g=Am(this);"boolean"===typeof d&&(g.Eb=d,g.A())}};
B.rb=function(b,d){if(la(d)){var g=Cm.get(b,null);null!=g&&d instanceof g.clazz&&this.o instanceof im&&"string"===typeof b&&null==this.$a.get(b,null)&&(this.o.rb(d),this.$a.set(b,{type:"interaction",ref:d,defaults:!1,links:[]}))}else wm(this,b,"interaction")};B.dh=function(b){wm(this,b,"control")};
function wm(b,d,g,k){if(b.o instanceof im&&"string"===typeof d&&"string"===typeof g&&null==b.$a.get(d,null)){var p=!0;"boolean"===typeof k&&(p=k);k="control"===g?Dm.get(d,null):Cm.get(d,null);if(null!=k&&(newComponent=new k.clazz(k.options),"control"===g?b.o.h.push(newComponent):b.o.rb(newComponent),b.$a.set(d,{type:g,ref:newComponent,defaults:k.defaults,links:k.links}),p))for(link in k.links)wm(b,k.links[link],"control"===g?"interaction":"control",!1)}}
B.hd=function(b,d){if(this.o instanceof im&&"string"===typeof b){var g=this.$a.get(b,null);if(null!=g){var k=!0;"boolean"===typeof d&&(k=d);"control"===g.type?this.o.h.remove(g.ref):this.o.Sa.remove(g.ref);"function"===typeof g.ref.aa&&"function"===typeof g.ref.qa&&g.ref.qa();this.$a.remove(b);if(k)for(link in g.links)this.hd(g.links[link],!1)}}};
B.Ye=function(b,d){if("string"===typeof b&&0!==b.length){var g=b.substr(0,1).toLowerCase(),k=Em(this),p=Fm.get(g,null);if(null!==k&&null!=p&&p.settable){var g=Array.prototype.slice.call(arguments,1),q=0;try{for(c in"x"===b&&(b="width"),"y"===b&&(b="height"),q=this.Wa.size[b],g){"string"===typeof g[c]&&(g[c]=parseInt(g[c]));if("number"!==typeof g[c]||0>g[c])return;g[c]=parseInt(g[c]);if(g[c]>q)return}}catch(u){return}p="set"+p.method;try{k[p]("c"!==b?g[0]:g)}catch(u){return}if(Bm(this)){g=Am(this);
g.N&&Gm(g.N);g.o.Sd(!0);p=[];q=g.a.getAll();for(f in q)2!==q[f].state||"number"===typeof q[f].theZ&&-1!==q[f].theZ||"number"===typeof q[f].theT&&-1!==q[f].theT||"number"===typeof q[f].theC&&-1!==q[f].theC||p.push(q[f]);g.clear();q=Hm(g);ga(q)||(q=[]);q=q.concat(p);0<q.length&&g.zb(q)}Im(k)}}};B.Gd=function(b){if("string"===typeof b&&0!==b.length){var d=b.substr(0,1).toLowerCase();b=Em(this);if(null!=b&&(d=Fm.get(d,null),null!=d)){d="get"+d.method;try{return b[d]()}catch(g){return null}}}};
B.pf=function(b){var d=Em(this);d&&"function"===typeof b&&(d.Pd=b,Im(d))};B.Ch=function(){var b=Em(this);b&&(b.Pd=null,Im(b))};function Bm(b){return!(b.o instanceof im)||2>sb(om(b.o))?null:om(b.o).item(sb(om(b.o))-1)}function Em(b){return(b=b.o instanceof im&&0!=sb(om(b.o))?om(b.o).item(0):null)?b.ea():null}function Am(b){return(b=Bm(b))?b.ea():null}B.ya=function(){return this.va};B.Sf=function(){return this.Ua};B.Ud=function(b){Bm(this)&&ym(Am(this),b)};
B.Nf=function(b,d,g,k){ga(k)&&0!==k.length||(k=V(this.o).g.J());b=Jm(b,d,k,g);if(null!==b)if(Bm(this)){for(s in b)d=b[s],V(this.o).O(),g=V(this.o).ha(),d.C()instanceof Km&&0!==g&&!Am(this).Eb&&d.C().rotate(-g),Lm(d,this.v);Am(this).zb(b)}else this.Uc({features:b})};function Mm(b){return b.o instanceof im?b.o&&V(b.o)&&V(b.o).W()?(V(b.o).W(),kc(Wd(V(b.o)),V(b.o).O(),V(b.o).ha(),pi(b.o))):V(b.o)&&V(b.o).g?(b=V(b.o).g.J(),[b[0],-b[3],b[2],-b[1]]):null:null}
B.nf=function(b){null===Am(this)&&this.Uc();"boolean"!==typeof b&&(b=!1);b!==this.v.i&&(this.v.i=b,this.v.N&&(Gm(this.v.N),b=this.$a.get("boxSelect",null))&&(b=b.ref,Nm(b),b.l()),nm(this.o).style="",this.v.i?Om(this.v):(this.B=null,this.v.j=null,this.v.b=null,this.v.G=0))};B.Hg=function(b){this.v instanceof xm&&"object"===typeof b&&null!==b&&Pm(b,this.v)};
B.hh=function(b,d){if(this.v instanceof xm){d="boolean"===typeof d?d:!0;var g="boolean"===typeof b&&b&&this.v.N?this.v.N.ma():new qb(this.v.ma()),g=Qm(g,d);null!==g&&0!==g.count&&Rm(this.v,g)}};B.Jf=function(b){this.v instanceof xm&&this.v.N instanceof Sm&&this.v.N.b(b)};
B.fh=function(b){if(this.v instanceof xm&&"string"===typeof b&&0!==b.length){var d=this.v.s.slice();this.Ud([Tm]);if(this.v.ib instanceof Um){if(d=this.v.ib,"string"===typeof b&&0!==b.length){var g=null;switch(b.toLowerCase()){case "point":g=Um.prototype.Gf;break;case "polygon":g=Um.prototype.Hf;break;case "ellipse":g=Um.prototype.Df;break;case "line":g=Um.prototype.Ff;break;case "rectangle":g=Um.prototype.If;break;case "label":g=Um.prototype.Ef;break;default:console.error("shape type not supported"),
ym(d.v,d.Rd)}g&&g.call(d)}}else this.Ud(d),console.error("Could not get instance of Draw")}};B.qa=function(b){this.Sd();"boolean"!==typeof b&&(b=!1);var d=b?[]:null;this.o instanceof im&&(b&&viewer_state?(this.$a.forEach(function(b,k){this.hd(k);"object"===typeof b&&b.defaults&&d.push({key:k,type:b.type})},this),this.$a.clear()):(this.$a.clear(),this.o.h.clear(),this.o.Sa.clear()),(b=Em(this))&&b.qa(),om(this.o).clear(),this.o.i.clear(),this.o.qa());this.o=this.Wa=null;return d};
B.Af=function(){this.qa();this.Ea&&Vm(this);this.Ea=null};B.De=function(b){if("object"===typeof b&&null!==b){try{b instanceof ome.glue.WebGlue&&(this.Ea=b),Wm()}catch(d){console.info("The injected object was not of type ome.glue.WebGlue or the web glue js include has not happened yet!")}this.Ea&&vm(this)}};
B.eh=function(b,d,g){if(null!==Em(this)){var k=Em(this);"number"!==typeof b||"number"!==typeof d||"number"!==typeof g||0>b||b>=k.hb.length||d>g||d<k.hb[b].min||g>k.hb[b].max||(k.hb[b].start=d,k.hb[b].end=g,Im(k))}};ba("ome.ol3.Viewer",X,OME);X.prototype.show=X.prototype.gh;X.prototype.hide=X.prototype.rg;X.prototype.addControl=X.prototype.dh;X.prototype.addInteraction=X.prototype.rb;X.prototype.removeInteractionOrControl=X.prototype.hd;X.prototype.changeToImage=X.prototype.me;
X.prototype.addPostTileLoadHook=X.prototype.pf;X.prototype.removePostTileLoadHook=X.prototype.Ch;X.prototype.setDimensionIndex=X.prototype.Ye;X.prototype.getDimensionIndex=X.prototype.Gd;X.prototype.getId=X.prototype.ya;X.prototype.getServer=X.prototype.Sf;X.prototype.addRegions=X.prototype.Uc;X.prototype.removeRegions=X.prototype.Sd;X.prototype.setRegionsVisibility=X.prototype.Ze;X.prototype.setTextBehaviorForRegions=X.prototype.Nh;X.prototype.setRegionsModes=X.prototype.Ud;
X.prototype.generateShapes=X.prototype.Nf;X.prototype.activateClustering=X.prototype.nf;X.prototype.modifyRegionsStyle=X.prototype.Hg;X.prototype.storeRegions=X.prototype.hh;X.prototype.enableRegionsContextMenu=X.prototype.Jf;X.prototype.drawShape=X.prototype.fh;X.prototype.destroyViewer=X.prototype.Af;X.prototype.injectWebGlue=X.prototype.De;X.prototype.changeChannelRange=X.prototype.eh;var Xm=ve?"webkitfullscreenchange":ue?"mozfullscreenchange":se?"MSFullscreenChange":"fullscreenchange";function Ym(){var b=Ie().a,d=b.body;return!!(d.webkitRequestFullscreen||d.mozRequestFullScreen&&b.mozFullScreenEnabled||d.msRequestFullscreen&&b.msFullscreenEnabled||d.requestFullscreen&&b.fullscreenEnabled)}
function Zm(b){b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen?b.msRequestFullscreen():b.requestFullscreen&&b.requestFullscreen()}function $m(){var b=Ie().a;return!!(b.webkitIsFullScreen||b.mozFullScreen||b.msFullscreenElement||b.fullscreenElement)};function an(b){b=b?b:{};this.a=void 0!==b.className?b.className:"ol-full-screen";var d=void 0!==b.label?b.label:"\u2922";this.b="string"===typeof d?document.createTextNode(d):d;d=void 0!==b.Ag?b.Ag:"\u00d7";this.g="string"===typeof d?document.createTextNode(d):d;d=b.Rc?b.Rc:"Toggle full-screen";d=Oe("BUTTON",{"class":this.a+"-"+$m(),type:"button",title:d},this.b);S(d,"click",this.u,this);var g=this.a+" ol-unselectable ol-control "+(Ym()?"":"ol-unsupported"),d=Oe("DIV",g,d);Bh.call(this,{element:d,
target:b.target});this.l=void 0!==b.keys?b.keys:!1;this.i=b.source}M(an,Bh);an.prototype.u=function(b){b.preventDefault();Ym()&&(b=this.Ba())&&($m()?(b=Ie().a,b.webkitCancelFullScreen?b.webkitCancelFullScreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.msExitFullscreen?b.msExitFullscreen():b.exitFullscreen&&b.exitFullscreen()):(b=this.i?Le(this.i):nm(b),this.l?b.mozRequestFullScreenWithKeys?b.mozRequestFullScreenWithKeys():b.webkitRequestFullscreen?b.webkitRequestFullscreen():Zm(b):Zm(b)))};
an.prototype.j=function(){var b=this.element.firstElementChild,d=this.Ba();$m()?(b.className=this.a+"-true",Ve(this.g,this.b)):(b.className=this.a+"-false",Ve(this.b,this.g));d&&d.Zd()};an.prototype.ta=function(b){an.Aa.ta.call(this,b);b&&this.h.push(S(aa.document,Xm,this.j,this))};function qm(b,d){this.tb={};this.Ga=[];this.a=0;var g=arguments.length;if(1<g){if(g%2)throw Error("Uneven number of arguments");for(var k=0;k<g;k+=2)this.set(arguments[k],arguments[k+1])}else if(b){var p;if(b instanceof qm)for(k=bn(b),cn(b),p=[],g=0;g<b.Ga.length;g++)p.push(b.tb[b.Ga[g]]);else{var g=[],q=0;for(k in b)g[q++]=k;k=g;g=[];q=0;for(p in b)g[q++]=b[p];p=g}for(g=0;g<k.length;g++)this.set(k[g],p[g])}}function bn(b){cn(b);return b.Ga.concat()}B=qm.prototype;
B.clear=function(){this.tb={};this.a=this.Ga.length=0};B.remove=function(b){return Object.prototype.hasOwnProperty.call(this.tb,b)?(delete this.tb[b],this.a--,this.Ga.length>2*this.a&&cn(this),!0):!1};
function cn(b){if(b.a!=b.Ga.length){for(var d=0,g=0;d<b.Ga.length;){var k=b.Ga[d];Object.prototype.hasOwnProperty.call(b.tb,k)&&(b.Ga[g++]=k);d++}b.Ga.length=g}if(b.a!=b.Ga.length){for(var p={},g=d=0;d<b.Ga.length;)k=b.Ga[d],Object.prototype.hasOwnProperty.call(p,k)||(b.Ga[g++]=k,p[k]=1),d++;b.Ga.length=g}}B.get=function(b,d){return Object.prototype.hasOwnProperty.call(this.tb,b)?this.tb[b]:d};
B.set=function(b,d){Object.prototype.hasOwnProperty.call(this.tb,b)||(this.a++,this.Ga.push(b));this.tb[b]=d};B.forEach=function(b,d){for(var g=bn(this),k=0;k<g.length;k++){var p=g[k],q=this.get(p);b.call(d,q,p,this)}};B.clone=function(){return new qm(this)};var dn=[2.25,2,1.75,1.5,1.25,1,.75,.5,.25],Fm=new qm({x:{method:"Width",settable:!1},width:{method:"Width",settable:!1},y:{method:"Height",settable:!1},height:{method:"Width",settable:!1},z:{method:"Plane",settable:!0},t:{method:"Time",settable:!0},c:{method:"Channels",settable:!0}}),Dm=new qm({attribution:{clazz:Ch,options:{},defaults:!0,enabled:!1,links:[]},zoom:{clazz:Mh,options:{},defaults:!0,enabled:!0,links:[]},rotate:{clazz:Kh,options:{},defaults:!0,enabled:!1,links:["shiftRotate"]},fullscreen:{clazz:an,
options:{},defaults:!0,enabled:!1,links:[]}}),Cm=new qm({dragPan:{clazz:gi,options:{kinetic:new Nh},defaults:!0,enabled:!0,links:[]},pinchZoom:{clazz:Ki,options:{zoomDuration:null},defaults:!0,enabled:!0,links:[]},mouseWheelZoom:{clazz:Ei,options:{zoomDuration:null},defaults:!0,enabled:!0,links:[]},keyboardPan:{clazz:Ai,options:{},defaults:!0,enabled:!1,links:[]},keyboardZoom:{clazz:Ci,options:{zoomDuration:null,zoomDelta:null},defaults:!0,enabled:!1,links:[]},shiftDragZoom:{clazz:zi,options:{zoomDuration:null},
defaults:!0,enabled:!1,links:[]},doubleClickZoom:{clazz:Th,options:{zoomDuration:null,zoomDelta:null},defaults:!0,enabled:!1,links:[]},pinchRotate:{clazz:Gi,options:{},defaults:!0,enabled:!1,links:["rotate"]},shiftRotate:{clazz:en,options:{},defaults:!0,enabled:!1,links:["rotate"]},boxSelect:{clazz:fn,options:{},defaults:!1,enabled:!1,links:[]}});
function um(){var b={};Dm.forEach(function(d,g){if(d.defaults&&d.enabled)try{b[g]={type:"control",ref:new d.clazz(d.options),defaults:d.defaults}}catch(k){console.error("Failed to construct control: "+k)}});return b}function tm(){var b={};Cm.forEach(function(d,g){if(d.defaults&&d.enabled)try{b[g]={type:"interaction",ref:new d.clazz(d.options),defaults:d.defaults}}catch(k){console.error("Failed to construct interaction: "+k)}});return b}var Tm=4,zm={DEFAULT:0,SELECT:1,TRANSLATE:2,MODIFY:3,DRAW:Tm};
ba("ome.ol3.REGIONS_MODE",zm,OME);var gn=Ua()&&!ne()?3E3:ke()||ge("Safari")&&!(me()||ge("Coast")||ke()||ge("Edge")||ge("Silk")||ge("Android"))?1500:oe()||le()&&(ge("Trident")||ge("MSIE")||ne())?500:250;function hn(b,d,g,k,p){Bg.call(this,b,d);this.j=g;this.b=new Image;null!==k&&(this.b.crossOrigin=k);this.f={};this.i=null;this.l=p}M(hn,Bg);B=hn.prototype;B.aa=function(){1==this.state&&jn(this);this.a&&this.a.qa();this.state=5;this.A();hn.Aa.aa.call(this)};B.nb=function(b){if(void 0!==b){var d=I(b);if(d in this.f)return this.f[d];b=xa(this.f)?this.b:this.b.cloneNode(!1);return this.f[d]=b}return this.b};B.getKey=function(){return this.j};B.Xg=function(){this.state=3;jn(this);this.A()};
B.Yg=function(){this.state=this.b.naturalWidth&&this.b.naturalHeight?2:4;jn(this);this.A()};B.load=function(){0==this.state&&(this.state=1,this.A(),this.i=[S(this.b,"error",this.Xg,this,!0),S(this.b,"load",this.Yg,this,!0)],this.l(this,this.j))};function jn(b){b.i.forEach(Aa);b.i=null};function kn(b,d,g,k,p){hn.call(this,b,d,g,k,p);this.f={}}M(kn,hn);kn.prototype.h=function(b,d){if("object"!==typeof b||"number"!==typeof b.width||"number"!==typeof b.height)return null;var g=b.width,k=b.height;ga(d)&&(g=d[0],k=d[1]);g=pf(g,k);g.drawImage(b,0,0);return g};
kn.prototype.nb=function(b){b=kn.Aa.nb.call(this,b);var d=I(b);if(d in this.f)return this.f[d];if(2==this.state){var g=this.source.Da.Yb;if(g=b.width!==g[0]||b.height!==g[1]?this.h(b,g):this.h(b))b=g.canvas;try{var k=this.source.Pd;"function"!==typeof k&&(k=null);var p=k?k.call(this,b):b;null===p&&(p=b);return this.f[d]=p}catch(q){return console.error("Error running post tile load hook: "+q),b}}else return b};kn.prototype.getRenderedTileAsContext=kn.prototype.h;function ln(b,d,g){rd.call(this);mn(this,b,d?d:0,g)}M(ln,rd);B=ln.prototype;B.clone=function(){var b=new ln(null);ud(b,this.g,this.a.slice());b.A();return b};B.Hc=function(b,d){var g=this.a,k=b-g[0],g=d-g[1];return k*k+g*g<=nn(this)};function Cj(b){return b.a.slice(0,b.F)}B.zd=function(b){var d=this.a,g=d[this.F]-d[0];return Zb(d[0]-g,d[1]-g,d[0]+g,d[1]+g,b)};B.Bc=function(){return Math.sqrt(nn(this))};function nn(b){var d=b.a[b.F]-b.a[0];b=b.a[b.F+1]-b.a[1];return d*d+b*b}B.ka=function(){return"Circle"};
B.eb=function(b){var d=this.J();return mc(b,d)?(d=Cj(this),b[0]<=d[0]&&b[2]>=d[0]||b[1]<=d[1]&&b[3]>=d[1]?!0:cc(b,this.ua,this)):!1};function mn(b,d,g,k){if(d){vd(b,k,d,0);b.a||(b.a=[]);k=b.a;d=xd(k,d);k[d++]=k[0]+g;var p;g=1;for(p=b.F;g<p;++g)k[d++]=k[g];k.length=d}else ud(b,"XY",null);b.A()}B.Td=function(b){this.a[this.F]=this.a[0]+b;this.A()};function on(b,d,g,k,p){var q=NaN,u=NaN,v=(g-d)/k;if(0===v)$a("n cannot be 0");else if(1==v)q=b[d],u=b[d+1];else if(2==v)q=.5*b[d]+.5*b[d+k],u=.5*b[d+1]+.5*b[d+k+1];else{var u=b[d],v=b[d+1],w=0,q=[0],z;for(z=d+k;z<g;z+=k){var A=b[z],C=b[z+1],w=w+Math.sqrt((A-u)*(A-u)+(C-v)*(C-v));q.push(w);u=A;v=C}g=.5*w;w=0;z=q.length;for(A=!1;w<z;)u=w+(z-w>>1),v=+Zc(q[u],g),0>v?w=u+1:(z=u,A=!v);u=A?w:~w;0>u?(g=(g-q[-u-2])/(q[-u-1]-q[-u-2]),d+=(-u-2)*k,q=b[d],q=q+g*(b[d+k]-q),u=b[d+1],u=u+g*(b[d+k+1]-u)):(q=b[d+u*
k],u=b[d+u*k+1])}return p?(p[0]=q,p[1]=u,p):[q,u]};function pn(b,d){rd.call(this);this.b=null;this.h=-1;this.wa(b,d)}M(pn,rd);B=pn.prototype;B.clone=function(){var b=new pn(null);ud(b,this.g,this.a.slice());b.A();return b};B.sa=function(){return Ad(this.a,0,this.a.length,this.F)};function Dj(b){if(b.h!=b.f){var d;d=on(b.a,0,b.a.length,b.F,b.b);b.b=d;b.h=b.f}return b.b}B.ec=function(b){var d=[];d.length=Cd(this.a,0,this.a.length,this.F,b,d,0);b=new pn(null);ud(b,"XY",d);b.A();return b};B.ka=function(){return"LineString"};
B.eb=function(b){return Ld(this.a,0,this.a.length,this.F,b)};B.wa=function(b,d){b?(vd(this,d,b,1),this.a||(this.a=[]),this.a.length=yd(this.a,0,b,this.F)):ud(this,"XY",null);this.A()};function qn(b,d){rd.call(this);this.b=[];this.wa(b,d)}M(qn,rd);B=qn.prototype;B.clone=function(){var b=new qn(null),d=this.b.slice();ud(b,this.g,this.a.slice());b.b=d;b.A();return b};B.sa=function(){return Bd(this.a,0,this.b,this.F)};B.Ac=function(){return this.b};function Ej(b){var d=[],g=b.a,k=0,p=b.b;b=b.F;var q,u;q=0;for(u=p.length;q<u;++q){var v=p[q],k=on(g,k,v,b);ad(d,k);k=v}return d}
B.ec=function(b){var d=[],g=[],k=this.a,p=this.b,q=this.F,u=0,v=0,w,z;w=0;for(z=p.length;w<z;++w){var A=p[w],v=Cd(k,u,A,q,b,d,v);g.push(v);u=A}d.length=v;b=new qn(null);ud(b,"XY",d);b.b=g;b.A();return b};B.ka=function(){return"MultiLineString"};B.eb=function(b){a:{var d=this.a,g=this.b,k=this.F,p=0,q,u;q=0;for(u=g.length;q<u;++q){if(Ld(d,p,g[q],k,b)){b=!0;break a}p=g[q]}b=!1}return b};
B.wa=function(b,d){if(b){vd(this,d,b,2);this.a||(this.a=[]);var g=zd(this.a,0,b,this.F,this.b);this.a.length=0===g.length?0:g[g.length-1]}else g=this.b,ud(this,"XY",null),this.b=g;this.A()};function rn(b,d){rd.call(this);this.wa(b,d)}M(rn,rd);B=rn.prototype;B.clone=function(){var b=new rn(null);ud(b,this.g,this.a.slice());b.A();return b};B.sa=function(){return Ad(this.a,0,this.a.length,this.F)};B.ka=function(){return"MultiPoint"};B.eb=function(b){var d=this.a,g=this.F,k,p,q,u;k=0;for(p=d.length;k<p;k+=g)if(q=d[k],u=d[k+1],Xb(b,q,u))return!0;return!1};B.wa=function(b,d){b?(vd(this,d,b,1),this.a||(this.a=[]),this.a.length=yd(this.a,0,b,this.F)):ud(this,"XY",null);this.A()};function sn(b,d){rd.call(this);this.b=[];this.i=-1;this.j=null;this.l=-1;this.h=null;this.wa(b,d)}M(sn,rd);B=sn.prototype;B.clone=function(){for(var b=new sn(null),d=this.b.length,g=Array(d),k=0;k<d;++k)g[k]=this.b[k].slice();ud(b,this.g,this.a.slice());b.b=g;b.A();return b};B.Hc=function(b,d){var g;a:{g=Fj(this);var k=this.b,p=0;if(0!==k.length){var q,u;q=0;for(u=k.length;q<u;++q){var v=k[q];if(Id(g,p,v,this.F,b,d)){g=!0;break a}p=v[v.length-1]}}g=!1}return g};
B.sa=function(b){var d;void 0!==b?(d=Fj(this).slice(),Qd(d,this.b,this.F,b)):d=this.a;b=d;d=this.b;var g=this.F,k=0,p=[],q=0,u,v;u=0;for(v=d.length;u<v;++u){var w=d[u];p[q++]=Bd(b,k,w,g,p[q]);k=w[w.length-1]}p.length=q;return p};
function Gj(b){if(b.i!=b.f){var d=b.a,g=b.b,k=b.F,p=0,q=[],u,v,w=Sb();u=0;for(v=g.length;u<v;++u){var z=g[u],w=bc(Zb(Infinity,Infinity,-Infinity,-Infinity,void 0),d,p,z[0],k);q.push((w[0]+w[2])/2,(w[1]+w[3])/2);p=z[z.length-1]}d=Fj(b);g=b.b;k=b.F;p=0;u=[];v=0;for(w=g.length;v<w;++v)z=g[v],u=Jd(d,p,z,k,q,2*v,u),p=z[z.length-1];b.j=u;b.i=b.f}return b.j}
function Fj(b){if(b.l!=b.f){var d=b.a,g;a:{g=b.b;var k,p;k=0;for(p=g.length;k<p;++k)if(!Od(d,g[k],b.F,void 0)){g=!1;break a}g=!0}g?b.h=d:(b.h=d.slice(),b.h.length=Qd(b.h,b.b,b.F));b.l=b.f}return b.h}B.ec=function(b){var d=[],g=[],k=this.a,p=this.b,q=this.F;b=Math.sqrt(b);var u=0,v=0,w,z;w=0;for(z=p.length;w<z;++w){var A=p[w],C=[],v=Dd(k,u,A,q,b,d,v,C);g.push(C);u=A[A.length-1]}d.length=v;k=new sn(null);ud(k,"XY",d);k.b=g;k.A();return k};B.ka=function(){return"MultiPolygon"};
B.eb=function(b){a:{var d=Fj(this),g=this.b,k=this.F,p=0,q,u;q=0;for(u=g.length;q<u;++q){var v=g[q];if(Md(d,p,v,k,b)){b=!0;break a}p=v[v.length-1]}b=!1}return b};B.wa=function(b,d){if(b){vd(this,d,b,3);this.a||(this.a=[]);var g=this.a,k=this.F,p=this.b,q=0,p=p?p:[],u=0,v,w;v=0;for(w=b.length;v<w;++v)q=zd(g,q,b[v],k,p[u]),p[u++]=q,q=q[q.length-1];p.length=u;0===p.length?this.a.length=0:(g=p[p.length-1],this.a.length=0===g.length?0:g[g.length-1])}else g=this.b,ud(this,"XY",null),this.b=g;this.A()};function tn(b,d){db.call(this,b);this.fa=d}M(tn,db);
function un(b){di.call(this,{ub:vn,handleEvent:wn,vb:xn});this.V=null;this.u=!1;this.Ib=b.source?b.source:null;this.K=b.Qa?b.Qa:null;this.sd=b.Ph?b.Ph:12;this.M=b.type;this.b=yn(this.M);this.pb=b.Gg?b.Gg:this.b===zn?3:2;this.ua=b.Fg?b.Fg:Infinity;var d=b.Of;if(!d)if("Circle"===this.M)d=function(b,d){var g=d?d:new ln([NaN,NaN]);mn(g,b[0],Math.sqrt(Pb(b[0],b[1])));return g};else{var g,d=this.b;d===An?g=Fd:d===Bn?g=pn:d===zn&&(g=Rd);d=function(b,d){var q=d;q?q.wa(b):q=new g(b);return q}}this.w=d;this.G=
this.j=this.a=this.l=this.h=this.i=null;this.ef=b.pe?b.pe*b.pe:36;this.ca=new uj({source:new Mk({pd:!1,Na:b.Na?b.Na:!1}),style:b.style?b.style:Cn()});this.qb=b.Ii;this.La=b.Oa?b.Oa:Zh;this.ja=b.Mf?b.Mf:ai;S(this,ob("active"),this.ac,this)}M(un,di);function Cn(){var b=tj();return function(d){return b[d.C().ka()]}}un.prototype.ta=function(b){un.Aa.ta.call(this,b);this.ac()};
function wn(b){this.b!==Bn&&this.b!==zn||!this.ja(b)||(this.u=!0);var d=!this.u;this.u&&b.type===yg?(Dn(this,b),d=!1):b.type===xg?d=En(this,b):b.type===rg&&(d=!1);return ei.call(this,b)&&d}function vn(b){return this.La(b)?(this.V=b.f,!0):this.u?(this.V=b.f,this.i||Fn(this,b),!0):!1}function xn(b){this.u=!1;var d=this.V,g=b.f,k=d[0]-g[0],d=d[1]-g[1],g=!0;k*k+d*d<=this.ef&&(En(this,b),this.i?this.b===Gn?Hn(this):In(this,b)?Hn(this):Dn(this,b):(Fn(this,b),this.b===An&&Hn(this)),g=!1);return g}
function En(b,d){if(b.i){var g=d.b,k=b.h.C(),p;b.b===An?p=b.a:b.b===zn?(p=b.a[0],p=p[p.length-1],In(b,d)&&(g=b.i.slice())):(p=b.a,p=p[p.length-1]);p[0]=g[0];p[1]=g[1];b.w(b.a,k);b.l&&b.l.C().wa(g);k instanceof Rd&&b.b!==zn?(b.j||(b.j=new yk(new pn(null))),0>=k.b.length?k=null:(g=new Ed(null),ud(g,k.g,k.a.slice(0,k.b[0])),g.A(),k=g),g=b.j.C(),ud(g,k.g,k.a),g.A()):b.G&&(g=b.j.C(),g.wa(b.G));Jn(b)}else k=d.b.slice(),b.l?b.l.C().wa(k):(b.l=new yk(new Fd(k)),Jn(b));return!0}
function In(b,d){var g=!1;if(b.h){var k=!1,p=[b.i];b.b===Bn?k=b.a.length>b.pb:b.b===zn&&(k=b.a[0].length>b.pb,p=[b.a[0][0],b.a[0][b.a[0].length-2]]);if(k)for(var k=d.map,q=0,u=p.length;q<u;q++){var v=p[q],w=ki(k,v),z=d.f,g=z[0]-w[0],w=z[1]-w[1],z=b.u&&b.ja(d)?1:b.sd;if(g=Math.sqrt(g*g+w*w)<=z){b.i=v;break}}}return g}
function Fn(b,d){var g=d.b;b.i=g;b.b===An?b.a=g.slice():b.b===zn?(b.a=[[g.slice(),g.slice()]],b.G=b.a[0]):(b.a=[g.slice(),g.slice()],b.b===Gn&&(b.G=b.a));b.G&&(b.j=new yk(new pn(b.G)));g=b.w(b.a);b.h=new yk;b.qb&&Ak(b.h,b.qb);zk(b.h,g);Jn(b);T(b,new tn("drawstart",b.h))}function Dn(b,d){var g=d.b,k=b.h.C(),p,q;if(b.b===Bn)b.i=g.slice(),q=b.a,q.push(g.slice()),p=q.length>b.ua,b.w(q,k);else if(b.b===zn){q=b.a[0];q.push(g.slice());if(p=q.length>b.ua)b.i=q[0];b.w(b.a,k)}Jn(b);p&&Hn(b)}
function Hn(b){var d=Kn(b),g=b.a,k=d.C();b.b===Bn?(g.pop(),b.w(g,k)):b.b===zn&&(g[0].pop(),g[0].push(g[0][0]),b.w(g,k));"MultiPoint"===b.M?zk(d,new rn([g])):"MultiLineString"===b.M?zk(d,new qn([g])):"MultiPolygon"===b.M&&zk(d,new sn([g]));T(b,new tn("drawend",d));b.K&&b.K.push(d);b.Ib&&b.Ib.rc(d)}function Kn(b){b.i=null;var d=b.h;d&&(b.h=null,b.l=null,b.j=null,b.ca.ea().clear(!0));return d}un.prototype.B=od;
function Jn(b){var d=[];b.h&&d.push(b.h);b.j&&d.push(b.j);b.l&&d.push(b.l);b=b.ca.ea();b.clear(!0);b.zb(d)}un.prototype.ac=function(){var b=this.Ba(),d=this.get("active");b&&d||Kn(this);this.ca.ta(d?b:null)};function yn(b){var d;"Point"===b||"MultiPoint"===b?d=An:"LineString"===b||"MultiLineString"===b?d=Bn:"Polygon"===b||"MultiPolygon"===b?d=zn:"Circle"===b&&(d=Gn);return d}var An="Point",Bn="LineString",zn="Polygon",Gn="Circle";function Um(b,d){this.v=d;this.Rd=b;this.ob=null}M(Um,{});
function Ln(b,d,g,k){if("string"===typeof d&&"string"===typeof g&&0!==d.length&&0!==g.length){var p="function"===typeof onDrawEnd?onDrawEnd:null;b.ob&&b.v.o.o.Sa.remove(b.ob);b.ob=new un({source:b.v,type:d,Of:"function"===typeof k?k:null});"point"===g&&(b.ob.mode=b.mode=An);b.v.o.o.rb(b.ob);jb(b.ob,function(b){p&&p.call(this,b);if(b.fa instanceof yk){var d=b.fa,k="-1:"+I(b.fa);d.va=k;d.A();b.fa.state=2;b.fa.type=g;d=V(this.v.o.o).ha();b.fa.C()instanceof Km&&0!==d&&!this.v.Eb&&b.fa.C().rotate(-d);
d="label"===g?new Mn({text:"new label",font:"normal 10px sans-serif",stroke:new lj({color:"rgba(51, 153, 204, 0.9)",width:1})}):null;Bk(b.fa,new nj({fill:null===d?new gj({color:"rgba(255,255,255,0.5)"}):null,stroke:null===d?new lj({color:"rgba(51, 153, 204, 0.9)",width:1}):null,text:d}));Lm(b.fa,this.v)}this.v.N&&Gm(this.v.N);this.ob&&(this.v.o.o.Sa.remove(this.ob),ym(this.v,this.Rd))},b)}}B=Um.prototype;B.Hf=function(){Ln(this,"Polygon","polygon")};B.Ff=function(){Ln(this,"LineString","polyline")};
B.Gf=function(){Ln(this,"Point","point",function(b){return new ln(b,2)})};B.If=function(){Ln(this,"Circle","rectangle",function(b,d){var g=b[0],k=b[1],p=Math.abs(k[0]-g[0]),q=Math.abs(g[1]-k[1]);0===p&&(p=1);0===q&&(q=1);g=new Nn(k[0]<g[0]?k[0]:g[0],k[1]>g[1]?k[1]:g[1],p,q);d&&(k=On(g),ga(k),Pn(d,k[0],k[1]),d.Wb(Qn(g)),k=Rn(g),Pn(d,null,null,null,k));return g})};B.Ef=function(){Ln(this,"Circle","label",function(b){var d=Sn("new label","normal 10px sans-serif");return new Km(b[0][0],b[0][1],d)})};
B.Df=function(){Ln(this,"Circle","ellipse",function(b,d){var g=b[0],k=b[1],g=new Tn(g[0],g[1],Math.abs(g[0]-k[0]),Math.abs(g[1]-k[1]));d&&(d.wa(g.sa()),d.Td(g.Bc()));return g})};B.qa=function(){this.ob&&(this.v.o.o.Sa.remove(this.ob),this.Rd=null);this.v=null};function en(){li.call(this);this.La=ai}M(en,li);function Un(b){lb.call(this);this.va=b.id;this.j=void 0!==b.vg?b.vg:!0;this.l=void 0!==b.Qh?b.Qh:!0;this.b=document.createElement("DIV");this.b.className="ol-overlay-container";this.b.style.position="absolute";this.Vc=void 0!==b.Vc?b.Vc:!1;this.h=void 0!==b.tf?b.tf:{};this.i=void 0!==b.uf?b.uf:20;this.a={Wc:"",ed:"",kd:"",od:"",visible:!0};this.g=null;S(this,ob("element"),this.Vf,this);S(this,ob("map"),this.fg,this);S(this,ob("offset"),this.gg,this);S(this,ob("position"),this.ig,this);S(this,ob("positioning"),
this.jg,this);void 0!==b.element&&this.set("element",b.element);this.set("offset",void 0!==b.offset?b.offset:[0,0]);this.set("positioning",void 0!==b.zh?b.zh:"top-left");void 0!==b.position&&Vn(this,b.position)}M(Un,lb);B=Un.prototype;B.ya=function(){return this.va};B.Ba=function(){return this.get("map")};B.Vf=function(){Se(this.b);var b=this.get("element");b&&this.b.appendChild(b)};
B.fg=function(){this.g&&(Ue(this.b),Aa(this.g),this.g=null);var b=this.Ba();b&&(this.g=S(b,"postrender",this.S,this),Wn(this),b=this.l?b.s:b.u,this.j?Te(b,this.b,0):b.appendChild(this.b))};B.S=function(){Wn(this)};B.gg=function(){Wn(this)};
B.ig=function(){Wn(this);if(void 0!==this.get("position")&&this.Vc){var b=this.Ba();if(void 0!==b&&nm(b)){var d=Xn(nm(b),pi(b)),g=this.get("element"),k=g.offsetWidth,p=g.currentStyle||aa.getComputedStyle(g),k=k+(parseInt(p.marginLeft,10)+parseInt(p.marginRight,10)),p=g.offsetHeight,q=g.currentStyle||aa.getComputedStyle(g),p=p+(parseInt(q.marginTop,10)+parseInt(q.marginBottom,10)),u=Xn(g,[k,p]),g=this.i;Wb(d,u)||(k=u[0]-d[0],p=d[2]-u[2],q=u[1]-d[1],u=d[3]-u[3],d=[0,0],0>k?d[0]=k-g:0>p&&(d[0]=Math.abs(p)+
g),0>q?d[1]=q-g:0>u&&(d[1]=Math.abs(u)+g),0===d[0]&&0===d[1])||(g=Wd(V(b)),k=ki(b,g),d=[k[0]+d[0],k[1]+d[1]],this.h&&(this.h.source=g,b.cb(Hh(this.h))),Xd(V(b),b.Pa(d)))}}};B.jg=function(){Wn(this)};B.ta=function(b){this.set("map",b)};function Vn(b,d){b.set("position",d)}
function Xn(b,d){var g=Ke(b),k=new Ge(0,0),p;p=g?Ke(g):document;p=!se||9<=Number(Ee)||"CSS1Compat"==Ie(p).a.compatMode?p.documentElement:p.body;if(b!=p){p=bf(b);var q=Ie(g).a,g=q.scrollingElement?q.scrollingElement:ve||"CSS1Compat"!=q.compatMode?q.body||q.documentElement:q.documentElement,q=q.parentWindow||q.defaultView,g=se&&Ce("10")&&q.pageYOffset!=g.scrollTop?new Ge(g.scrollLeft,g.scrollTop):new Ge(q.pageXOffset||g.scrollLeft,q.pageYOffset||g.scrollTop);k.x=p.left+g.x;k.y=p.top+g.y}return[k.x,
k.y,k.x+d[0],k.y+d[1]]}function Yn(b,d){b.a.visible!==d&&(ef(b.b,d),b.a.visible=d)}
function Wn(b){var d=b.Ba(),g=b.get("position");if(void 0!==d&&d.b&&void 0!==g){var g=ki(d,g),k=pi(d),d=b.b.style,p=b.get("offset"),q=b.get("positioning"),u=p[0],p=p[1];if("bottom-right"==q||"center-right"==q||"top-right"==q)""!==b.a.ed&&(b.a.ed=d.left=""),u=Math.round(k[0]-g[0]-u)+"px",b.a.kd!=u&&(b.a.kd=d.right=u);else{""!==b.a.kd&&(b.a.kd=d.right="");if("bottom-center"==q||"center-center"==q||"top-center"==q)u-=cf(b.b).width/2;u=Math.round(g[0]+u)+"px";b.a.ed!=u&&(b.a.ed=d.left=u)}if("bottom-left"==
q||"bottom-center"==q||"bottom-right"==q)""!==b.a.od&&(b.a.od=d.top=""),g=Math.round(k[1]-g[1]-p)+"px",b.a.Wc!=g&&(b.a.Wc=d.bottom=g);else{""!==b.a.Wc&&(b.a.Wc=d.bottom="");if("center-left"==q||"center-center"==q||"center-right"==q)p-=cf(b.b).height/2;g=Math.round(g[1]+p)+"px";b.a.od!=g&&(b.a.od=d.top=g)}Yn(b,!0)}else Yn(b,!1)};function Sm(b){this.v=b;Ph.call(this,{});this.handleEvent=Zn;this.La=function(d){return Wh.call(b.N,d)};this.K=new qb;this.g=!1;this.a=null;var d=Bm(this.v.o);this.Fe=function(b){return 0<=[d].indexOf(b)};this.$c=nd;this.g&&Sm.prototype.b.call(this,!0)}M(Sm,Ph);function Gm(b){b.ma().forEach(function(b){b.selected=!1},b);b.ma().clear();b.v.A()}
Sm.prototype.h=function(b){var d=null;b=[b.offsetX,b.offsetY];$n(b,this.o.o,this.Hb,this.N,function(b,k){if(this.$c(b,k))return d=b,!0},this.N.Fe);ao(this.N,b,d)};
function Zn(b){if(!this.La(b)||b.h||b instanceof ng&&b.a instanceof MouseEvent&&"number"===typeof b.a.which&&3===b.a.which)return!0;var d=null;$n(b.f,b.map,this.v.Hb,this,function(b,g){if(this.$c(b,g))return d=b,!0},this.Fe);var g=d&&d.selected;if(null===d||!ai(b))if(Gm(this),null===d)return;g?(d.selected=!1,this.ma().remove(d)):(d.selected=!0,this.ma().push(d));!(d instanceof bo)&&d.cluster instanceof bo&&(d.cluster.selected=!1,d.cluster.group_selected=!1,this.ma().remove(d.cluster));this.v.A();
return"pointermove"==b.type}
function ao(b,d,g){if(ga(d)&&2===d.length&&g instanceof yk&&b.a instanceof Un){var k=Oe("DIV",{id:"ome_context_menu"});if(null!==k){d=b.v.o.o.Pa([d[0]-10,d[1]-10]);var p=b.a,q=Oe("SPAN",{"class":"title"},g instanceof bo?"Cluster: "+g.K.length:"Feature: "+g.ya()),u=Oe("A",{href:"#","class":"close"},"\u2716");u.onclick=function(){Vn(p,void 0);return!1};q=Oe("DIV",{"class":"header"},q,u);k.appendChild(q);g instanceof bo?co(b,k,"(Un)Select Cluster Features",function(){if(g instanceof bo){var b=!0===("boolean"===
typeof g.group_selected?g.group_selected:!1)?!1:!0;g.group_selected=b;g.selected=!1;this.v.N.ma().remove(g);for(f in g.K)(g.K[f].selected=b)?(this.v.N.ma().remove(g.K[f]),this.v.N.ma().push(g.K[f])):this.v.N.ma().remove(g.K[f]),this.v.A()}}):co(b,k,"(Un)Select Feature",function(){if(g instanceof yk){var b=!0===g.selected?!1:!0;g.selected=b;var d=g instanceof bo?g.K:[g];for(f in d)(d[f].selected=b)?this.v.N.ma().push(d[f]):(this.v.N.ma().remove(d[f]),d[f].cluster instanceof bo&&(d[f].cluster.group_selected=
!1)),this.v.A()}});b.a.set("element",k);Vn(b.a,d);Ye(k.parentNode,"margin: 1px");nm(b.v.o.o).onmouseover=function(b){"ome_context_menu"!==b.target.id&&"ome_context_menu"!==b.target.parentNode.id&&"ome_context_menu"!==b.target.parentNode.parentNode.id&&Vn(p,void 0);return!1}}}}
function co(b,d,g,k){if("object"===typeof d&&"string"===typeof g&&0!==g.length){var p="function"===typeof k?k:null,q=null;if(1>d.childNodes||"DIV"!==d.childNodes[d.childNodes.length-1].tagName.toUpperCase()||!eo(d.childNodes[d.childNodes.length-1]))Re(d,Oe("HR",{})),Re(d,Oe("DIV",{"class":"content"}));q=d.childNodes[d.childNodes.length-1];null!==q&&(d=Oe("SPAN",{},g),d.onmouseover=function(b){fo(b.target,"selected")},d.onmouseout=function(b){fo(b.target,"")},p&&(d.onclick=function(d){k.call(b,d)}),
q.appendChild(d))}}Sm.prototype.ma=function(){return this.K};Sm.prototype.b=function(b){"boolean"!==typeof b&&(b=!1);if(this.g!=b)if(this.g=b){this.a=new Un({Vc:!0});this.v.o.o.i.push(this.a);var d=this.v;nm(this.v.o.o).oncontextmenu=function(b){if(null!==d.N)return Sm.prototype.h.call(d,b),b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,!1}}else this.a instanceof Un&&(this.v.o.o.i.remove(this.a),this.a=null),nm(this.v.o.o).oncontextmenu=null,nm(this.v.o.o).onmouseover=null};
Sm.prototype.aa=function(){this.b(!1);this.v=null};function fn(b){ui.call(this);this.La=$h;b instanceof xm&&(this.v=b,this.G=function(){this.v.N&&Gm(this.v.N)},this.i=null,this.w=function(){if(null!==this.v.N){var b=this.C().J(),g=function(g){g.C()&&g.C().eb(b)?(g.selected=!0,this.v.N.ma().push(g)):g.selected=!1};this.v.i&&(g=function(g){var p=[g];!this.v.Hb&&g instanceof bo&&(mc(b,g.sc)?p=g.K:p=[]);for(f in p)g=p[f],g.C()&&g.C().eb(b)&&(g.selected=!0,this.v.N.ma().push(g))});this.v.ma().forEach(g,this);this.v.A()}},this.h=null,this.l=function(){this.i=
S(this,"boxstart",this.G,this);this.h=S(this,"boxend",this.w,this)},this.l())}M(fn,ui);function Nm(b){b.i&&Aa(b.i);b.h&&Aa(b.h)}fn.prototype.aa=function(){Nm(this);this.v=null};function go(b,d){db.call(this,b);this.Qa=d}M(go,db);
function ho(b){di.call(this,{ub:io,Ab:jo,handleEvent:ko,vb:lo});this.ca=b.zf?b.zf:$d(Zh,Yh);this.ua=this.a=null;this.ja=[0,0];this.l=this.u=!1;this.b=new Hk;this.i=void 0!==b.rh?b.rh:10;this.V=this.G=!1;this.h=null;this.w=new uj({source:new Mk({pd:!1,Na:!!b.Na}),style:b.style?b.style:mo(),$d:!0,ae:!0});this.M={Point:this.ii,LineString:this.cf,LinearRing:this.cf,Polygon:this.df,MultiPoint:this.gi,MultiLineString:this.fi,MultiPolygon:this.hi,GeometryCollection:this.ei};this.K=b.Qa;this.K.forEach(this.ud,
this);S(this.K,"add",this.Wf,this);S(this.K,"remove",this.Xf,this)}M(ho,di);B=ho.prototype;B.ud=function(b){var d=b.C();d.ka()in this.M&&this.M[d.ka()].call(this,b,d);(d=this.Ba())&&this.Dc(this.ja,d);S(b,"change",this.Ke,this)};function no(b){b.l||(b.l=!0,T(b,new go("modifystart",b.K)))}function oo(b,d){po(b,d);b.a&&0===sb(b.K)&&(b.w.ea().Sb(b.a),b.a=null);Fa(d,"change",b.Ke,b)}
function po(b,d){var g=b.b,k=[];g.forEach(function(b){d===b.fa&&k.push(b)});for(var p=k.length-1;0<=p;--p)g.remove(k[p])}B.ta=function(b){this.w.ta(b);ho.Aa.ta.call(this,b)};B.Wf=function(b){this.ud(b.element)};B.Ke=function(b){this.V||(b=b.target,oo(this,b),this.ud(b))};B.Xf=function(b){oo(this,b.element)};B.ii=function(b,d){var g=d.sa(),g={fa:b,ra:d,ia:[g,g]};this.b.Ha(d.J(),g)};
B.gi=function(b,d){var g=d.sa(),k,p,q;p=0;for(q=g.length;p<q;++p)k=g[p],k={fa:b,ra:d,depth:[p],index:p,ia:[k,k]},this.b.Ha(d.J(),k)};B.cf=function(b,d){var g=d.sa(),k,p,q,u;k=0;for(p=g.length-1;k<p;++k)q=g.slice(k,k+2),u={fa:b,ra:d,index:k,ia:q},this.b.Ha(Rb(q),u)};B.fi=function(b,d){var g=d.sa(),k,p,q,u,v,w,z;u=0;for(v=g.length;u<v;++u)for(k=g[u],p=0,q=k.length-1;p<q;++p)w=k.slice(p,p+2),z={fa:b,ra:d,depth:[u],index:p,ia:w},this.b.Ha(Rb(w),z)};
B.df=function(b,d){var g=d.sa(),k,p,q,u,v,w,z;u=0;for(v=g.length;u<v;++u)for(k=g[u],p=0,q=k.length-1;p<q;++p)w=k.slice(p,p+2),z={fa:b,ra:d,depth:[u],index:p,ia:w},this.b.Ha(Rb(w),z)};B.hi=function(b,d){var g=d.sa(),k,p,q,u,v,w,z,A,C,D;w=0;for(z=g.length;w<z;++w)for(A=g[w],u=0,v=A.length;u<v;++u)for(k=A[u],p=0,q=k.length-1;p<q;++p)C=k.slice(p,p+2),D={fa:b,ra:d,depth:[u,w],index:p,ia:C},this.b.Ha(Rb(C),D)};B.ei=function(b,d){var g,k=d.Qf();for(g=0;g<k.length;++g)this.M[k[g].ka()].call(this,b,k[g])};
function qo(b,d){var g=b.a;g?g.C().wa(d):(g=new yk(new Fd(d)),b.a=g,b.w.ea().rc(g))}function ro(b,d){return b.index-d.index}
function io(b){this.Dc(b.f,b.map);this.h=[];this.l=!1;var d=this.a;if(d){b=[];var d=d.C().sa(),g=Rb([d]),g=Jk(this.b,g),k={};g.sort(ro);for(var p=0,q=g.length;p<q;++p){var u=g[p],v=u.ia,w=I(u.fa),z=u.depth;z&&(w+="-"+z.join("-"));k[w]||(k[w]=Array(2));if(Nb(v[0],d)&&!k[w][0])this.h.push([u,0]),k[w][0]=u;else if(Nb(v[1],d)&&!k[w][1]){if("LineString"!==u.ra.ka()&&"MultiLineString"!==u.ra.ka()||!k[w][0]||0!==k[w][0].index)this.h.push([u,1]),k[w][1]=u}else I(v)in this.ua&&!k[w][0]&&!k[w][1]&&b.push([u,
d])}b.length&&no(this);for(d=b.length-1;0<=d;--d)this.wg.apply(this,b[d])}return!!this.a}
function jo(b){this.u=!1;no(this);b=b.b;for(var d=0,g=this.h.length;d<g;++d){for(var k=this.h[d],p=k[0],q=p.depth,u=p.ra,v=u.sa(),w=p.ia,k=k[1];b.length<u.F;)b.push(0);switch(u.ka()){case "Point":v=b;w[0]=w[1]=b;break;case "MultiPoint":v[p.index]=b;w[0]=w[1]=b;break;case "LineString":v[p.index+k]=b;w[k]=b;break;case "MultiLineString":v[q[0]][p.index+k]=b;w[k]=b;break;case "Polygon":v[q[0]][p.index+k]=b;w[k]=b;break;case "MultiPolygon":v[q[1]][q[0]][p.index+k]=b,w[k]=b}so(this,u,v)}qo(this,b)}
function lo(){for(var b,d=this.h.length-1;0<=d;--d)b=this.h[d][0],Ik(this.b,Rb(b.ia),b);this.l&&(T(this,new go("modifyend",this.K)),this.l=!1);return!1}function ko(b){if(!(b instanceof ng))return!0;var d;V(b.map).b.slice()[1]||b.type!=xg||this.s||(this.ja=b.f,this.Dc(b.f,b.map));this.a&&this.ca(b)&&(b.type==sg&&this.u?d=!0:(this.a.C(),no(this),d=to(this),T(this,new go("modifyend",this.K)),this.l=!1));b.type==sg&&(this.u=!1);return ei.call(this,b)&&!d}
B.Dc=function(b,d){function g(b,d){return Pb(k,Mb(k,b.ia))-Pb(k,Mb(k,d.ia))}var k=d.Pa(b),p=d.Pa([b[0]-this.i,b[1]+this.i]),q=d.Pa([b[0]+this.i,b[1]-this.i]),p=Rb([p,q]),p=Jk(this.b,p);if(0<p.length){p.sort(g);var q=p[0].ia,u=Mb(k,q),v=ki(d,u);if(Math.sqrt(Pb(b,v))<=this.i){var w=ki(d,q[0]),z=ki(d,q[1]),w=Pb(v,w),v=Pb(v,z);(this.G=Math.sqrt(Math.min(w,v))<=this.i)&&(u=w>v?q[1]:q[0]);qo(this,u);u={};u[I(q)]=!0;z=1;for(w=p.length;z<w;++z)if(v=p[z].ia,Nb(q[0],v[0])&&Nb(q[1],v[1])||Nb(q[0],v[1])&&Nb(q[1],
v[0]))u[I(v)]=!0;else break;this.ua=u;return}}this.a&&(this.w.ea().Sb(this.a),this.a=null)};
B.wg=function(b,d){for(var g=b.ia,k=b.fa,p=b.ra,q=b.depth,u=b.index,v;d.length<p.F;)d.push(0);switch(p.ka()){case "MultiLineString":v=p.sa();v[q[0]].splice(u+1,0,d);break;case "Polygon":v=p.sa();v[q[0]].splice(u+1,0,d);break;case "MultiPolygon":v=p.sa();v[q[1]][q[0]].splice(u+1,0,d);break;case "LineString":v=p.sa();v.splice(u+1,0,d);break;default:return}so(this,p,v);v=this.b;v.remove(b);uo(this,p,u,q,1);var w={ia:[g[0],d],fa:k,ra:p,depth:q,index:u};v.Ha(Rb(w.ia),w);this.h.push([w,1]);g={ia:[d,g[1]],
fa:k,ra:p,depth:q,index:u+1};v.Ha(Rb(g.ia),g);this.h.push([g,0]);this.u=!0};
function to(b){var d=b.h,g={},k,p,q,u,v,w,z,A,C;for(v=d.length-1;0<=v;--v)if(q=d[v],A=q[0],u=A.ra,p=u.sa(),C=I(A.fa),A.depth&&(C+="-"+A.depth.join("-")),k=z=w=void 0,0===q[1]?(z=A,w=A.index):1==q[1]&&(k=A,w=A.index+1),C in g||(g[C]=[k,z,w]),q=g[C],void 0!==k&&(q[0]=k),void 0!==z&&(q[1]=z),void 0!==q[0]&&void 0!==q[1]){k=p;C=!1;z=w-1;switch(u.ka()){case "MultiLineString":p[A.depth[0]].splice(w,1);C=!0;break;case "LineString":p.splice(w,1);C=!0;break;case "MultiPolygon":k=k[A.depth[1]];case "Polygon":k=
k[A.depth[0]],4<k.length&&(w==k.length-1&&(w=0),k.splice(w,1),C=!0,0===w&&(k.pop(),k.push(k[0]),z=k.length-1))}C&&(b.b.remove(q[0]),b.b.remove(q[1]),so(b,u,p),p={depth:A.depth,fa:A.fa,ra:A.ra,index:z,ia:[q[0].ia[0],q[1].ia[1]]},b.b.Ha(Rb(p.ia),p),uo(b,u,w,A.depth,-1),b.a&&(b.w.ea().Sb(b.a),b.a=null))}return!0}function so(b,d,g){b.V=!0;d.wa(g);b.V=!1}function uo(b,d,g,k,p){Lk(b.b,d.J(),function(b){b.ra===d&&(void 0===k||void 0===b.depth||cd(b.depth,k))&&b.index>g&&(b.index+=p)})}
function mo(){var b=tj();return function(){return b.Point}};function vo(b){ho.call(this,b);this.Ka=wo;this.handleEvent=xo;this.oa=yo;this.ca=function(b){return Zh(b)&&Wh(b)}}M(vo,ho);
vo.prototype.Dc=function(b,d){if(this.K instanceof qb&&0!==sb(this.K)){var g=d.Pa(b),k=function(b,d){return Pb(g,Mb(g,b.ia))-Pb(g,Mb(g,d.ia))},p=d.Pa([b[0]-this.i,b[1]+this.i]),q=d.Pa([b[0]+this.i,b[1]-this.i]),p=Rb([p,q]),p=Jk(this.b,p);if(0<p.length&&(p.sort(k),q=p[0],!(q.ra instanceof Km))){var k=q.ia,u=Mb(g,k),v=ki(d,u);if(Math.sqrt(Pb(b,v))<=this.i){var w=ki(d,k[0]),z=ki(d,k[1]),w=Pb(v,w),v=Pb(v,z);this.G=Math.sqrt(Math.min(w,v))<=this.i;if((q.ra instanceof Nn||q.ra instanceof Tn)&&!this.G)return;
this.G&&(u=w>v?k[1]:k[0]);qo(this,u);q={};q[I(k)]=!0;v=1;for(z=p.length;v<z;++v)if(u=p[v].ia,Nb(k[0],u[0])&&Nb(k[1],u[1])||Nb(k[0],u[1])&&Nb(k[1],u[0]))q[I(u)]=!0;else break;this.ua=q;return}}this.a&&(this.w.ea().Sb(this.a),this.a=null)}};
function wo(b){if(!(b instanceof ng&&b.a instanceof MouseEvent&&"number"===typeof b.a.which&&3===b.a.which)){this.u=!1;no(this);b=b.b;for(var d=0,g=this.h.length;d<g;++d){for(var k=this.h[d],p=k[0],q=p.depth,u=p.ra,v=u.sa(),w=p.ia,k=k[1];b.length<u.F;)b.push(0);if(u instanceof Fd)v=b,w[0]=w[1]=b;else if(u instanceof rn)v[p.index]=b,w[0]=w[1]=b;else if(u instanceof pn)v[p.index+k]=b,w[k]=b;else if(u instanceof qn)v[q[0]][p.index+k]=b,w[k]=b;else if(u instanceof Tn)u.l=Math.abs(u.h-b[0]),u.s=Math.abs(u.i-
b[1]),v=(new Tn(u.h,u.i,u.l,u.s)).sa();else if(u instanceof Nn){p=this.a.C().sa();if(null==this.j)for(var z=0;z<v[q[0]].length;z++)if(v[q[0]][z][0]!=p[0]&&v[q[0]][z][1]!=p[1]){this.j=v[q[0]][z];break}var p=b[0]<this.j[0]?b[0]:this.j[0],z=b[0]>this.j[0]?b[0]:this.j[0],A=-b[1]<-this.j[1]?b[1]:this.j[1],C=-b[1]>-this.j[1]?b[1]:this.j[1];v[q[0]][0]=[p,A];v[q[0]][1]=[z,A];v[q[0]][2]=[z,C];v[q[0]][3]=[p,C];v[q[0]][4]=[p,A];w[k]=u.J().slice(2*k,2*(k+1))}else u instanceof Rd?(v[q[0]][p.index+k]=b,w[k]=b):
u instanceof sn&&(v[q[1]][q[0]][p.index+k]=b,w[k]=b);so(this,u,v)}qo(this,b)}}function yo(b){if(b instanceof ng&&b.a instanceof MouseEvent&&"number"===typeof b.a.which&&3===b.a.which)return!1;this.j=null;for(var d=this.h.length-1;0<=d;--d)b=this.h[d][0],b.ra instanceof Nn||b.ra instanceof Tn?(this.b.remove(b),this.df(b.fa,b.ra)):(Ik(this.b,Rb(b.ia),b),this.a&&this.K.remove(this.a)),0===b.fa.state&&(b.fa.state=1);this.l&&(T(this,new go("modifyend",this.K)),this.l=!1);return!1}
function xo(b){if(!(b instanceof ng)||b.a instanceof MouseEvent&&"number"===typeof b.a.which&&3===b.a.which)return!0;var d;V(b.map).b.slice()[1]||b.type!=xg||this.s||(this.ja=b.f,this.Dc(b.f,b.map));this.a&&this.ca(b)&&(b.type==sg&&this.u?d=!0:this.K instanceof qb&&0<sb(this.K)&&(this.K.item(0).C()instanceof Nn||this.K.item(0).C()instanceof Tn)?d=!0:(this.a.C(),no(this),d=to(this),T(this,new go("modifyend",this.K)),this.l=!1));b.type==sg&&(this.u=!1);return ei.call(this,b)&&!d};function zo(b,d){db.call(this,b);this.Qa=d}M(zo,db);function Ao(b){di.call(this,{ub:Bo,Ab:Co,Ae:Do,vb:Eo});this.b=void 0;this.a=null;this.K=void 0!==b.Qa?b.Qa:null;this.h=null}M(Ao,di);function Bo(b){this.h=this.i(b.f,b.map);return!this.a&&this.h?(this.a=b.b,Do.call(this,b),T(this,new zo("translatestart",this.K)),!0):!1}function Eo(b){return this.a?(this.a=null,Do.call(this,b),T(this,new zo("translateend",this.K)),!0):!1}
function Co(b){if(this.a){b=b.b;var d=b[0]-this.a[0],g=b[1]-this.a[1];if(this.K)this.K.forEach(function(b){var k=b.C();k.Xa(d,g);zk(b,k)});else if(this.h){var k=this.h.C();k.Xa(d,g);zk(this.h,k)}this.a=b;T(this,new zo("translating",this.K))}}
function Do(b){var d=nm(b.map);if(b=mm(b.map,b.f,function(b){return b})){var g=!1;this.K&&0<=this.K.a.indexOf(b)&&(g=!0);this.b=d.style.cursor;d.style.cursor=this.a?"-webkit-grabbing":g?"-webkit-grab":"pointer";d.style.cursor=this.a?g?"grab":"pointer":"grabbing"}else d.style.cursor=void 0!==this.b?this.b:"",this.b=void 0}Ao.prototype.i=function(b,d){var g=null,k=mm(d,b,function(b){return b});this.K&&0<=this.K.a.indexOf(k)&&(g=k);return g};function Fo(b){this.v=b;Ao.call(this,{});this.Ja=Go;this.bb=Ho;this.oa=Io;this.b=null;this.K=this.v.N.ma();S(this,"translateend",Fo.prototype.j,this)}M(Fo,Ao);Fo.prototype.j=function(b){var d=b.Qa.a;for(f in d)d[f].C()instanceof Km&&Jo(d[f].C(),V(b.target.Ba()).ha(),V(b.target.Ba()).O()),0===d[f].state&&(d[f].state=1);this.v.i&&Om(this.v)};
function Go(b){if(!(b instanceof ng)||b.a instanceof MouseEvent&&"number"===typeof b.a.which&&3===b.a.which)return!1;this.h=this.i(b.f,b.map);return!this.a&&this.h?(this.a=b.b,Ho.call(this,b),T(this,new zo("translatestart",this.K)),!0):!1}
function Ho(b){if(b instanceof ng&&!(b.a instanceof MouseEvent&&"number"===typeof b.a.which&&3===b.a.which)){var d=nm(b.map),g=null;$n(b.f,b.map,this.v.Hb,this,function(b){g=b});g?(b=!1,this.K&&0<=this.K.a.indexOf(g)&&(b=!0),this.b="string"===typeof d.style.cursor?d.style.cursor:null,d.style.cursor=Ua()&&!ne()?this.a?"-webkit-grabbing":b?"-webkit-grab":"pointer":this.a?"grabbing":b?"grab":"pointer"):(d.style.cursor=null!==this.b?this.b:"",this.b=null)}}
function Io(b){return!(b instanceof ng)||b.a instanceof MouseEvent&&"number"===typeof b.a.which&&3===b.a.which?!0:this.a?(this.a=null,Ho.call(this,b),T(this,new zo("translateend",this.K)),!0):!1}Fo.prototype.i=function(b,d){var g=null,k=null;$n(b,d,this.v.Hb,this,function(b){k=b});this.K&&0<=this.K.a.indexOf(k)&&(g=k);return g};Fo.prototype.aa=function(){this.v=this.K=null};function Nn(b,d,g,k){Rd.call(this,[[[b,d],[b+g,d],[b+g,d-k],[b,d-k],[b,d]]],"XY")}M(Nn,Rd);function On(b){b=b.a;return ga(b)&&10==b.length?[b[0],b[1]]:null}function Qn(b){b=b.a;return ga(b)&&10==b.length?b[2]-b[0]:0}Nn.prototype.Wb=function(b){Pn(this,null,null,b,null)};function Rn(b){b=b.a;return ga(b)&&10==b.length?Math.abs(b[5]-b[3]):0}
function Pn(b,d,g,k,p){var q=b.a;ga(q)&&10==q.length&&("number"!==typeof d&&(d=q[0]),"number"!==typeof g&&(g=q[1]),"number"!==typeof k&&(k=Qn(b)),"number"!==typeof p&&(p=Rn(b)),b.wa([[[d,g],[d+k,g],[d+k,g-p],[d,g-p],[d,g]]]))}Nn.prototype.clone=function(){var b=On(this);return new Nn(b[0],b[1],Qn(this),Rn(this))};
function Km(b,d,g){g=g||null;if(null==g||"number"!==typeof g.width||"number"!==typeof g.height)g={width:10,height:10};Nn.call(this,b,d,g.width,g.height);this.i=function(){this.h=[];var b=this.a;for(c in b)this.h.push(b[c])};this.i()}M(Km,Nn);
function Jo(b,d,g){"number"!==typeof d&&(d=0);"number"!==typeof g&&(g=1);if(0!=d){var k=[];g=b.a;for(c in g)k.push(g[c]);var p=Qn(b),q=Rn(b);wd(b,function(b,d){d[0]=b[0];d[1]=b[1];d[2]=b[0]+p;d[3]=b[1];d[4]=b[0]+p;d[5]=b[1]-q;d[6]=b[0];d[7]=b[1]-q;d[8]=b[0];d[9]=b[1];return d})}b.i();0!=d&&wd(b,function(b,d){for(i in k)d[i]=k[i];return d})}
function Ko(b,d,g){if("number"===typeof d){var k=b.h;wd(b,function(b,d){for(i in k)d[i]=k[i];return d});var p=b.h[2]-b.h[0],q=Math.abs(b.h[5]-b.h[3]);"object"===typeof g&&null!==g&&"number"===typeof g.width&&"number"===typeof g.height&&(p=0<g.width?g.width:1,q=0<g.height?g.height:1);Lo(b,{width:p,height:q});0!==d&&b.rotate(d)}}
Km.prototype.rotate=function(b){wd(this,function(d,g){for(var k=Math.cos(b),p=Math.sin(b),q=[d[0],d[1]],u=2,v=d.length;u<v;u+=2){var w=d[u],z=d[u+1];g[u]=k*(w-q[0])+p*(z-q[1])+q[0];g[u+1]=k*(z-q[1])-p*(w-q[0])+q[1]}return g})};function Lo(b,d){"object"===typeof d&&null!==d&&"number"===typeof d.width&&"number"===typeof d.height&&(0>d.width&&(d.width=1),0>d.height&&(d.height=1),wd(b,function(b,k){k[2]=k[0]+d.width;k[4]=k[0]+d.width;k[5]=k[1]-d.height;k[7]=k[1]-d.height;return k}))}
Km.prototype.Xa=function(b,d){rd.prototype.Xa.call(this,b,d);this.i()};Km.prototype.clone=function(){var b=On(this);return new Km(b[0],b[1],{width:Qn(this),height:Rn(this)})};function Tn(b,d,g,k,p,q){this.h=b;this.i=d;this.l=g;this.s=k;p={theta:p||0,step:q||.1};for(o in p){if("string"===typeof p[o])try{p[o]=parseInt(p[o])}catch(v){}"number"!==typeof p[o]&&("theta"===o&&(p[o]=0),"step"===o&&(p[o]=.1))}this.u=p.theta;this.ja=p.step;p=[];q=0*Math.PI;for(var u=2*Math.PI;q<u;q+=this.ja)x=b-k*Math.sin(q)*Math.sin(this.u*Math.PI)+g*Math.cos(q)*Math.cos(this.u*Math.PI),y=d+g*Math.cos(q)*Math.sin(this.u*Math.PI)+k*Math.sin(q)*Math.cos(this.u*Math.PI),p.push([x,y]);0<p.length&&
p.push(p[0]);Rd.call(this,[p])}M(Tn,Rd);Tn.prototype.Bc=function(){return[this.l,this.s]};Tn.prototype.Td=function(b){ga(b);this.l=b[0];this.s=b[1]};Tn.prototype.Xa=function(b,d){rd.prototype.Xa.call(this,b,d);var g=[this.h+b,this.i+d];ga(g);this.h=g[0];this.i=g[1]};Tn.prototype.clone=function(){return new Tn(this.h,this.i,this.l,this.s,this.u,this.ja)};function Mo(b){pn.call(this,b)}M(Mo,pn);Mo.prototype.clone=function(){return new Mo(this.sa().slice())};function bo(b,d){yk.call(this);this.K=this.sc=null;"undefined"!==typeof b&&"undefined"!==typeof d&&No(this,b,d,!0)}M(bo,yk);
function No(b,d,g,k){b.sc=d;b.K=g;if("boolean"===typeof k&&k)for(f in b.K)b.K[f].cluster=b;d=new ln(jc(b.sc),10);d.Xa=function(b,d){rd.prototype.Xa.call(this,b,d);for(f in g)g[f].C().Xa(b,d);this.A()};zk(b,d);d=new nj({fill:new gj({color:"rgba(255,255,0,0.25)"}),stroke:new lj({color:"rgba(255,255,0, 1)"}),text:new Mn({font:"normal 12px arial",stroke:new lj({color:"rgba(255,255,0, 1)"}),text:""+b.K.length})});Bk(b,d)};function Oo(b,d,g,k,p,q,u,v,w,z,A){Bg.call(this,p,0);this.G=void 0!==A?A:!1;this.B=u;this.w=v;this.h=null;this.b={};this.i=d;this.l=k;this.s=q?q:p;this.f=[];this.nc=null;this.j=0;q=Lg(k,this.s);v=this.l.J();p=this.i.J();q=v?lc(q,v):q;if(0===fc(q))this.state=4;else if((v=b.J())&&(p?p=lc(p,v):p=v),k=k.O(this.s[0]),k=jk(b,g,jc(q),k),!isFinite(k)||0>=k)this.state=4;else if(this.u=new mk(b,g,q,p,k*(void 0!==z?z:.5)),0===this.u.g.length)this.state=4;else if(this.j=Sg(d,k),g=ok(this.u),p&&(b.bc?(g[1]=Ib(g[1],
p[1],p[3]),g[3]=Ib(g[3],p[1],p[3])):g=lc(g,p)),fc(g))if(b=Mg(d,g,this.j),100>(b.f-b.a+1)*(b.g-b.b+1)){for(d=b.a;d<=b.f;d++)for(g=b.b;g<=b.g;g++)(z=w(this.j,d,g,u))&&this.f.push(z);0===this.f.length&&(this.state=4)}else this.state=3;else this.state=4}M(Oo,Bg);Oo.prototype.aa=function(){1==this.state&&(this.nc.forEach(Aa),this.nc=null);Oo.Aa.aa.call(this)};
Oo.prototype.nb=function(b){if(void 0!==b){var d=I(b);if(d in this.b)return this.b[d];b=xa(this.b)?this.h:this.h.cloneNode(!1);return this.b[d]=b}return this.h};
Oo.prototype.Lc=function(){var b=[];this.f.forEach(function(d){d&&2==d.W()&&b.push({D:Lg(this.i,d.na),Ra:d.nb()})},this);this.f.length=0;if(0===b.length)this.state=3;else{var d=this.s[0],g=Rg(this.l,d),k=ja(g)?g:g[0],g=ja(g)?g:g[1],d=this.l.O(d),p=this.i.O(this.j),q=Lg(this.l,this.s);this.h=lk(k,g,this.B,p,this.i.J(),d,q,this.u,b,this.w,this.G);this.state=2}this.A()};
Oo.prototype.load=function(){if(0==this.state){this.state=1;this.A();var b=0;this.nc=[];this.f.forEach(function(d){var g=d.W();if(0==g||1==g){b++;var k;k=S(d,"change",function(){var g=d.W();if(2==g||3==g||4==g)Aa(k),b--,0===b&&(this.nc.forEach(Aa),this.nc=null,this.Lc())},this);this.nc.push(k)}},this);this.f.forEach(function(b){0==b.W()&&b.load()});0===b&&aa.setTimeout(this.Lc.bind(this),0)}};function Po(b){bl.call(this,{xa:b.xa,Xc:b.Xc,D:b.D,Fa:b.Fa,Ic:b.Ic,ba:b.ba,state:b.state,Da:b.Da,oc:b.oc?b.oc:Qo,Qc:b.Qc,Gb:b.Gb,url:b.url,pc:b.pc,Na:b.Na});this.crossOrigin=void 0!==b.crossOrigin?b.crossOrigin:null;this.Pc=void 0!==b.Pc?b.Pc:hn;this.b={};this.h={};this.G=b.Oi}M(Po,bl);B=Po.prototype;B.Qe=function(){if(Fg(this.a))return!0;for(var b in this.b)if(Fg(this.b[b]))return!0;return!1};
B.Re=function(b,d){var g=this.Cc(b);Gg(this.a,this.a==g?d:{});for(var k in this.b){var p=this.b[k];Gg(p,p==g?d:{})}};B.ad=function(){return 0};B.Id=function(b){return this.l&&b&&!Fc(this.l,b)?!1:Po.Aa.Id.call(this,b)};B.mb=function(b){var d=this.l;return!this.Da||d&&!Fc(d,b)?(d=I(b).toString(),d in this.h||(this.h[d]=Ug(b)),this.h[d]):this.Da};B.Cc=function(b){var d=this.l;if(!d||Fc(d,b))return this.a;b=I(b).toString();b in this.b||(this.b[b]=new Eg);return this.b[b]};
B.Cd=function(b,d,g,k,p,q){b=[b,d,g];k=(d=Zg(this,b,p))?this.Gb(d,k,p):void 0;k=new this.Pc(b,void 0!==k?0:4,void 0!==k?k:"",this.crossOrigin,this.oc);k.g=q;S(k,"change",this.j,this);return k};function mh(b,d,g,k,p,q){if(b.l&&q&&!Fc(b.l,q)){p=b.Cc(q);g=[d,g,k];d=b.bd.apply(b,g);if(Dg(p,d))return p.get(d);var u=b.l;k=b.mb(u);var v=b.mb(q),w=Zg(b,g,q);b=new Oo(u,k,q,v,g,w,b.i,0,function(b,d,g,k){return Ro(this,b,d,g,k,u)}.bind(b),b.G,!1);p.set(d,b);return b}return Ro(b,d,g,k,p,q)}
function Ro(b,d,g,k,p,q){var u=null,v=b.bd(d,g,k);if(Dg(b.a,v)){if(u=b.a.get(v),""!=u.g){var w=u;u.a&&""==u.a.g?(u=u.a,2==w.W()&&(u.a=w)):(u=b.Cd(d,g,k,p,q,""),2==w.W()?u.a=w:w.a&&2==w.a.W()&&(u.a=w.a,w.a=null));u.a&&(u.a.a=null);b.a.replace(v,u)}}else u=b.Cd(d,g,k,p,q,""),b.a.set(v,u);return u}function Qo(b,d){b.nb().src=d};function rm(b){b=b||{};this.va=b.Ra||-1;this.u=b.width||-1;this.s=b.height||-1;this.Od=b.sh||0;this.Yd=b.time||0;this.hb=[];this.qc=[];if(ga(b.wd))for(var d in b.wd){var g=b.wd[d];this.hb.push(g);!0===g.active&&this.qc.push(parseInt(d))}this.Ua=b.Kh;this.bi=pm.tc(b.uri);this.Pd=null;d=b.Vh||{width:256,height:256};g=[0,-this.s,this.u,0];d=new Hg({Xd:[d.width,d.height],D:g,origin:ec(g),yb:b.yb||[1]});Po.call(this,{crossOrigin:b.crossOrigin,Pc:kn,Da:d,Gb:function(b){if(b){var d=this.Da.Tb.length-b[0]-
1,g=this.Ua.full+"/"+this.bi.full+"/"+this.va+"/"+this.Od+"/"+this.Yd+"/?",g=1<this.Da.Tb.length?g+("tile="+d+","+b[1]+","+(-b[2]-1)):g+("region="+b[1]*this.Da.Yb[0]+","+(-b[2]-1)*this.Da.Yb[1]),g=g+(","+this.Da.Yb[0]+","+this.Da.Yb[1]);b=this.qc.length;if(0<b)for(var g=g+"&c=",u=d=0;u<b;u++){var v=this.qc[u];if("object"===typeof this.hb[v]){var w=this.hb[v];0!=d&&(g+=",");g+=v+1;g+="|"+w.start+":"+w.end;g+="$"+w.color;d++}}else{b="&c=";for(d=0;d<this.hb.length;d++)0!==d&&(b+=","),b+="-"+(d+1);g+=
b}return g+"&q=0.9"}}})}M(rm,Po);B=rm.prototype;B.Cd=function(b,d,g,k,p,q){b=[b,d,g];k=(d=Zg(this,b,p))?this.Gb(d,k,p):void 0;k=new this.Pc(b,void 0!==k?0:4,void 0!==k?k:"",this.crossOrigin,this.oc);k.g=q;k.source=this;S(k,"change",this.j,this);return k};B.kh=function(){return this.u};B.ih=function(){return this.s};B.Rf=function(){return this.Od};B.Mh=function(b){this.Od=b};B.jh=function(){return this.Yd};B.lh=function(b){this.Yd=b};B.Pf=function(){return this.qc};
B.Lh=function(b){for(c in b);this.qc=b};function Im(b){b.a instanceof Cg&&b.a.clear();b.A()}B.aa=function(){this.a instanceof Cg&&this.a.clear();this.hb=[]};rm.prototype.getWidth=rm.prototype.kh;rm.prototype.getHeight=rm.prototype.ih;rm.prototype.getPlane=rm.prototype.Rf;rm.prototype.setPlane=rm.prototype.Mh;rm.prototype.getTime=rm.prototype.jh;rm.prototype.setTime=rm.prototype.lh;rm.prototype.getChannels=rm.prototype.Pf;rm.prototype.setChannels=rm.prototype.Lh;function So(b,d,g,k,p,q,u){Ag.call(this,b,d,g,0,k);this.j=p;this.a=new Image;null!==q&&(this.a.crossOrigin=q);this.g={};this.b=null;this.state=0;this.i=u}M(So,Ag);So.prototype.f=function(b){if(void 0!==b){var d;b=I(b);if(b in this.g)return this.g[b];xa(this.g)?d=this.a:d=this.a.cloneNode(!1);return this.g[b]=d}return this.a};So.prototype.s=function(){this.state=3;this.b.forEach(Aa);this.b=null;this.A()};
So.prototype.u=function(){void 0===this.H&&(this.H=ic(this.D)/this.a.height);this.state=2;this.b.forEach(Aa);this.b=null;this.A()};So.prototype.load=function(){0==this.state&&(this.state=1,this.A(),this.b=[S(this.a,"error",this.s,this,!0),S(this.a,"load",this.u,this,!0)],this.i(this,this.j))};function To(b){var d=b.sg,g=void 0!==b.crossOrigin?b.crossOrigin:null,k=void 0!==b.tg?b.tg:xk;qk.call(this,{xa:b.xa,Fa:b.Fa,ba:uc(b.ba)});this.b=new So(d,void 0,1,this.kb(),b.url,g,k);this.h=b.ug?b.ug:null;S(this.b,"change",this.g,this)}M(To,qk);function sk(b,d){return mc(d,b.b.J())?b.b:null}
To.prototype.g=function(b){if(2==this.b.W()){var d=this.b.J(),g=this.b.f(),k,p;this.h?(k=this.h[0],p=this.h[1]):(k=g.width,p=g.height);d=Math.ceil(hc(d)/(ic(d)/p));if(d!=k){var q=document.createElement("canvas");q.width=d;q.height=p;q.getContext("2d").drawImage(g,0,0,k,p,0,0,q.width,q.height);this.b.a=q}}To.Aa.g.call(this,b)};function xm(b,d){var g=d||{};g.pd=!0;var k=null;ga(g.features)&&(k=d.features,g.features=null,g.Qa=null);Mk.call(this,g);this.ld=!0;"boolean"===typeof g.scaleText&&(this.ld=g.scaleText);this.Eb=!1;"boolean"===typeof g.rotateText&&(this.Eb=g.rotateText);this.i=!0;this.Hb=!1;this.b=this.B=null;this.G=0;this.za=null;this.o=b;this.ib=this.Qb=this.Zb=this.N=null;this.s=[];this.Ka=function(b){var d={server:b.o.Ua,uri:"/webgateway/get_rois_json/"+b.o.ya(),jsonp:!0,success:function(d){if("string"===typeof d)try{d=
JSON.parse(d)}catch(g){console.error("Failed to parse json response!")}"object"!==typeof d?console.error("Regions Request did not receive proper response!"):(b.za=d,d=Hm(b),ga(d)&&0<d.length&&b.zb(d))},error:function(d){console.error("Error retrieving regions info for id: "+b.o.ya()+(d&&0<d.length?"\\n"+d:""))}};if(b.o.Ea){var g=pm.tc(d.uri);d.url=d.server.full+"/"+g.full;delete d.jsonp;pm.hc(d.server)||(d.dataType="jsonp");b.o.Ea.request(d)}else pm.Mc(d)};if(k){for(s in k){var g=k[s],p=V(this.o.o).ha();
V(this.o.o).O();g.C()instanceof Km&&0!==p&&!this.Eb&&g.C().rotate(-p);Lm(g,this)}this.zb(k)}this.Ka(this)}M(xm,Mk);
function ym(b,d){if(ga(d)){var g=!1,k=!1,p=!1,q=!1,u=!1,v=b.s.slice();b.s=[];for(m in d)if(!("number"!==typeof d[m]||0>d[m]||4<d[m])){if(d[m]===zm.DEFAULT){g=!0;k=p=q=u=!1;break}d[m]===zm.SELECT?(k=!0,u=!1):d[m]===zm.TRANSLATE?(p=k=!0,u=!1):d[m]===zm.MODIFY?(q=k=!0,u=!1):d[m]===zm.DRAW&&(q=p=k=!1,u=!0)}var w=function(){this.Qb&&(this.o.o.Sa.remove(this.Qb),this.Qb.qa(),this.Qb=null);this.Zb&&(this.o.o.Sa.remove(this.Zb),this.Zb.qa(),nm(this.o.o).style.cursor="",this.Zb=null);this.N&&(this.o.hd("boxSelect"),
this.N.ma().forEach(function(b){b instanceof yk&&(b.selected=!1)},this),this.N.ma().clear(),this.o.o.Sa.remove(this.N),this.N.qa(),this.A(),this.N=null)},z=function(){this.ib&&(this.ib.qa(),this.ib=null)},A=function(){null===this.N&&(this.N=new Sm(this),this.o.o.rb(this.N),this.o.rb("boxSelect",new fn(this)))};g?(z.call(b),w.call(b),b.s.push(0)):u?(w.call(b),null===b.ib&&(b.ib=new Um(v,b)),b.s.push(Tm)):(q&&(z.call(b),A.call(b),null===b.Qb&&(b.Qb=new vo({Qa:b.N.ma()}),b.o.o.rb(b.Qb)),b.s.push(3)),
p&&(z.call(b),A.call(b),null===b.Zb&&(b.Zb=new Fo(b),b.o.o.rb(b.Zb)),b.s.push(2)),k&&(z.call(b),A.call(b),b.s.push(1)))}}function Om(b){window.setTimeout(function(b){Uo(b)},0,b)}function Uo(b){if(b.i&&(b.b=Vo(b.a),ga(b.b)&&0!==b.b.length)){for(l in b.b)b.b[l].forEach(function(b){b instanceof bo&&(Lm(b,this),b.group_selected=!1)},b);b.A()}}B=xm.prototype;B.zb=function(b){this.i?(Nk(this,b),Uo(this)):Mk.prototype.zb.call(this,b)};
B.rc=function(b){this.i?(Pk(this,b),Om(this)):Mk.prototype.rc.call(this,b)};B.Sb=function(b){if(this.i){var d=I(b).toString();d in this.h?delete this.h[d]:this.a&&this.a.remove(b);this.gd(b);Om(this)}else Mk.prototype.Sb.call(this,b)};B.clear=function(){if(ga(this.b)){for(l in this.b)this.b[l]instanceof Hk&&this.b[l].clear();delete this.b[l]}Mk.prototype.clear.call(this,!0);this.w={};this.g={};this.u={};this.j=null;this.Hb=!1;this.b=this.B=null;this.G=0};
B.Lb=function(b,d,g){if("undefined"===typeof g||null===g)g=this;var k=Wo(this);if(!k||!ga(this.b)||0===this.b.length)return Lk(this.a,b,function(b){("boolean"!==typeof b.visible||b.visible)&&d.call(g,b)},g);var p=null!==this.B&&this.B!==k&&this.B&&!k;this.B=k;var q=[],u=0;if(k)for(var v=0;v<this.b.length;v++)if(!Wo(this,null,v)){u=v;break}this.G=u;u=Lk(this.b[u],b,function(u){p&&u instanceof bo&&(u.selected=!1,q.push(u));if(u instanceof bo&&(!k||u.selected)&&mc(b,u.sc))for(f in k&&v&&d.call(g,u),
u.K){var v=!0;"boolean"!==typeof u.visible||u.visible||(v=!1);var A=u.K[f].C();v&&A&&A.eb(b)&&d.call(g,u.K[f])}else u.C()&&"boolean"===typeof u.visible&&!u.visible&&u.C().eb(b)&&d.call(g,u)},g);if(this.N){for(v in q)this.N.ma().remove(q[v]);k&&this.N.ma().forEach(function(k){k instanceof bo||!k.C().eb(b)||d.call(g,k)},g)}return u};B.ma=function(){if(!this.i||!ga(this.b)||0===this.b.length)return this.a.getAll();var b=this.G;if(0>b||b>=this.b.length)b=0;return this.b[b].getAll()};
function Wo(b,d,g){if(!b.i)return b.Hb=!1;var k=!1;ga(d)&&4===d.length||(d=Mm(b.o));var p=g="number"===typeof g?g:-1;d=ga(b.b)&&0<=p&&p<b.b.length?b.b[p].Ta.search(d):b.a&&b.a.Ta?b.a.Ta.search(d):null;ga(d)&&d.length>gn&&V(b.o.o).O()!==V(b.o.o).i&&(k=!0);-1===g&&(b.Hb=k);return k}
function Rm(b,d){var g=Xo();if(""!==g){var k={nextRoiId:"",nextShapeId:"",storedCount:0},p=b.o.va,q=function(b){var g=0,k={};for(r in d.rois)if(""===b.nextRoiId||r===b.nextRoiId){b.nextRoiId="";if(250<=g){b.nextRoiId=r;b.nextShapeId=s;break}for(s in d.rois[r].shapes)if(""===b.nextShapeId||s===b.nextShapeId){b.nextShapeId="";if(250<=g){b.nextRoiId=r;b.nextShapeId=s;break}"object"!==typeof k[r]&&(k[r]={"@id":parseInt(r),"@type":"http://www.openmicroscopy.org/Schemas/ROI/2015-01#ROI",shapes:[]});k[r].shapes.push(d.rois[r].shapes[s]);
++g}}250>g&&(b.nextRoiId="",b.nextShapeId="");if(0===g)return"";try{return b={imageId:p,count:g},b.rois=k,JSON.stringify(b)}catch(q){return null}},u=q(k),v={server:b.o.Ua,uri:"/ome-ol3-viewer/postrois",method:"POST",content:u,headers:{"X-CSRFToken":g},jsonp:!1,error:function(b){console.error("Failed to store regions: "+(b&&0<b.length?"\\n"+b:""))}};b.o.Ea&&(g=pm.tc(v.uri),v.url=v.server.full+"/"+g.full,v.data=v.content,v.context=b,delete v.content,delete v.jsonp);v.success=function(g){"string"!==
typeof g&&console.error("Did not receive any data after regions post");try{g=JSON.parse(g)}catch(p){console.error("Failed to parse json response for regions storage!")}if("string"===typeof g.error)console.error("Failed to store rois: "+g.error);else if("object"===typeof g.ids){for(id in g.ids)try{b.g[id].state=0;var u=b.g[id];u.va=g.ids[id];u.A();k.storedCount++}catch(p){}if(""!==k.nextRoiId&&""!==k.nextShapeId){v.content=q(k);if(null===v.content){console.error("Failed to construct json for rois request!");
return}if(""===v.content)return;b.o.Ea?b.o.Ea.request(v):pm.Mc(v,this)}k.storedCount!==d.count&&console.error("Not all added/modified rois were stored: "+k.storedCount+"/"+d.count)}else console.error("Received unexpected data after regions post")};null===u?console.error("Failed to construct json for rois request!"):""!==u&&(b.o.Ea?b.o.Ea.request(v):pm.Mc(v,b))}}B.aa=function(){this.clear();this.o=this.za=this.h=this.M=this.a=null};function Mn(b){b=b||{};this.jb=b.font;this.j=b.rotation;this.g=b.scale;this.l=b.text;this.h=b.textAlign;this.i=b.textBaseline;this.a=void 0!==b.fill?b.fill:new gj({color:"#333"});this.Ia=void 0!==b.stroke?b.stroke:null;this.f=void 0!==b.offsetX?b.offsetX:0;this.b=void 0!==b.offsetY?b.offsetY:0}B=Mn.prototype;B.ha=function(){return this.j};B.R=function(){return this.Ia};B.I=function(){return this.l};B.Vb=function(b){this.j=b};B.nd=function(b){this.g=b};function Yo(b,d){if("object"!=typeof b)return null;var g="boolean"===typeof d?d:!1,k={count:0},p={count:0};"string"===typeof b.fillColor&&(p.color=Zo(b.fillColor,b.fillAlpha),p.color=$o(p.color),null!=p.color&&p.count++);"string"===typeof b.strokeColor&&(k.color=Zo(b.strokeColor,b.strokeAlpha),k.color=$o(k.color),null!=k.color&&k.count++);"number"===typeof b.strokeWidth?(k.width=b.strokeWidth,k.count++):k.width=1;0<k.count&&(k.lineCap="butt",k.lineJoin="miter",k.miterLimit=20);var q=0<k.count?new lj(k):
null,p=0<p.count?new gj(p):null,u={};if("string"===typeof b.textValue){var v={text:b.textValue},w="",w="string"===typeof b.fontStyle?w+(b.fontStyle+" "):w+"normal ",w="number"===typeof b.fontSize?w+(b.fontSize+"px "):w+"10px ";"string"===typeof b.fontFamily?w+=b.fontFamily:w+="sans-serif";v.font=w;q&&(k.lineCap="round",k.lineJoin="round",v.fill=new gj(k),v.stroke=new lj(k),g||v.stroke.Wb(1));u.text=new Mn(v)}q&&(u.stroke=q);p&&(u.fill=p);g&&(u.stroke=new lj({color:"rgba(255,255,255,0)",width:1,lineCap:"butt",
lineJoin:"miter",miterLimit:20}),u.fill=new gj({color:"rgba(255,255,255,0)"}));return new nj(u)}
function Lm(b,d){var g=!0,k=b.a;if(null!=k){var p=V(d.o.o);"function"===typeof k&&(k=k.call(b,p.O()));b.regions=d;var q=k.R();"object"!==typeof b.oldStrokeStyle&&(b.oldStrokeStyle=q?{color:q.h,width:q.i,lineDash:q.j,lineCap:q.a,lineJoin:q.f,miterLimit:q.b}:null);b.C()instanceof Km&&("undefined"===typeof b.oldRotation&&(b.oldRotation=p.ha()),"undefined"===typeof b.oldScale&&(b.oldScale=p.O()),"undefined"===typeof b.oldRotationFlag&&(b.oldRotationFlag=d.Eb),"undefined"===typeof b.oldScaleFlag&&(b.oldScaleFlag=
d.ld));b instanceof bo&&(b.oldRadius=b.C().Bc());Bk(b,function(d){if(!(this.regions instanceof xm))return k;var q=this.regions,w=q.ld,q=q.Eb,z=p.ha();b instanceof bo&&b.C().Td(b.oldRadius*d);var A=k.I();!A||b instanceof bo||(w?A.nd(1/d):A.nd(1),q?A.Vb(z):A.Vb(0),g=g||!1,b.C()instanceof Km&&(g||b.oldRotation!==z||b.oldScale!==d||b.oldRotationFlag!==q||b.oldScaleFlag!==w)&&(b.oldRotation!==z&&(b.oldRotation=z),b.oldScale!==d&&(b.oldScale=d),b.oldRotationFlag!==q&&(b.oldRotationFlag=q),b.oldScaleFlag!==
w&&(b.oldScaleFlag=w),g&&(g=!1),d=Sn(A.I(),A.jb,w?null:d),w=q?0:0-z,Ko(b.C(),w,d)));typeof("boolean"===b.selected)&&b.selected?(d=new lj,d.Nc("rgba(255,255,255,1)"),d.Wb(3),d.setLineDash([.1,5]),k.Ia=d):b.oldStrokeStyle?(k.R().Nc(b.oldStrokeStyle.color),k.R().Wb(b.oldStrokeStyle.width),k.R().setLineDash(b.oldStrokeStyle.lineDash),d=k.R(),d.a=b.oldStrokeStyle.lineCap,d.g=void 0,d=k.R(),d.f=b.oldStrokeStyle.lineJoin,d.g=void 0,d=k.R(),d.b=b.oldStrokeStyle.miterLimit,d.g=void 0):k.Ia=null;return k})}}
function Sn(b,d,g){if("string"!==typeof b||"string"!==typeof d)return null;var k=10;g="number"===typeof g&&0<g?g:1;var p=d.split(" ");if(3!=p.length)return null;try{k=parseInt(p[1]),k*=g,k=Math.ceil(k),d=p[0]+" "+k+"px "+p[2]}catch(q){}g=document.createElement("canvas").getContext("2d");g.font=d;b=g.measureText(b);return{width:0<b.width?b.width:5,height:k}}
function ap(b){if(!(b instanceof nj))return null;var d=null,g=null;b.f&&(g=new gj({color:b.f.a}));var k=bp(b.R()),p=null;b.I()&&(p=new Mn({font:b.I().jb?b.I().jb:null,text:b.I().I()?b.I().I():null,stroke:bp(b.I().R()),fill:b.I().a?new gj({color:b.I().a.a}):null}));if(null!==g||null!==k||null!==p)d=new nj({fill:g,stroke:k,text:p});return d}
function bp(b){return b instanceof lj?new lj({color:b.h?b.h:null,lineCap:b.a?b.a:"butt",lineDash:b.j?b.j:null,lineJoin:b.f?b.f:"miter",miterLimit:b.b?b.b:20,width:b.i?b.i:1}):null}
function Pm(b,d){var g;if(d instanceof xm&&"object"===typeof b&&"string"===typeof b.type){if(!(g instanceof qb)){if(null===d.N)return;g=d.N.ma()}var k=b.type.toLowerCase(),p=Yo(b,"label"===k);null!==p&&g.forEach(function(b){if(b instanceof yk&&!(b instanceof bo)&&b.type===k){var g=b.a;"function"===typeof g&&(g=g(V(d.o.o).O()));if(p){var v=p.f?p.f:g.f,w=null;if("object"===typeof b.oldStrokeStyle&&null!==b.oldStrokeStyle){w=new lj;w.Nc(b.oldStrokeStyle.color);w.Wb(b.oldStrokeStyle.width);w.setLineDash(b.oldStrokeStyle.lineDash);
var z=w;z.a=b.oldStrokeStyle.lineCap;z.g=void 0;z=w;z.f=b.oldStrokeStyle.lineJoin;z.g=void 0;z=w;z.b=b.oldStrokeStyle.miterLimit;z.g=void 0}p.R()&&(null===w&&(w=new lj),p.R().h&&w.Nc(p.R().h),p.R().a&&(z=w,z.a=p.R().a,z.g=void 0),p.R().j&&w.setLineDash(p.R().j),p.R().f&&(z=w,z.f=p.R().f,z.g=void 0),p.R().b&&(z=w,z.b=p.R().b,z.g=void 0),p.R().i&&w.Wb(p.R().i));g=g.I();null===g?g=p.I():p.I()&&(p.I().jb&&(g.jb=p.I().jb),p.I().f&&(g.f=p.I().f),p.I().b&&(g.b=p.I().b),p.I().a&&(g.a=p.I().a),p.I().ha()&&
g.Vb(p.I().ha()),p.I().g&&g.nd(p.I().g),p.I().R()&&(g.Ia=p.I().R()),p.I().I()&&(g.l=p.I().I()),p.I().h&&(g.h=p.I().h),p.I().i&&(g.i=p.I().i));v=new nj({fill:v,stroke:w,text:g});delete b.oldStrokeStyle;Bk(b,v);Lm(b,d);0===b.state&&(b.state=1)}}})}}function cp(b){"object"===typeof b&&"string"!==typeof b.fillColor&&"string"!==typeof b.strokeColor&&(b.strokeColor="#FFFFFF","number"!==typeof b.strokeAlpha&&(b.strokeAlpha=1),"number"!==typeof b.strokeWidth&&(b.strokeWidth=1))};var dp={};function ep(b,d){if("string"!==typeof b||0===b.length)return null;"number"!==typeof d&&(d=1);try{var g=b.replace(/\(rgba|\(|rgba|rgb|\)/g,"").split(",");if(3>g.length)return null;var k={red:255,green:255,blue:255,alpha:d};k.red=parseInt(g[0],10);k.green=parseInt(g[1],10);k.blue=parseInt(g[2],10);3<g.length&&(k.alpha=parseFloat(g[3],10))}catch(p){return null}return k}
function Zo(b,d){if("string"!==typeof b||0===b.length)return null;"number"!==typeof d&&(d=1);try{var g=b.replace(/#|\s/g,"");if(6!=g.length)return null;var k={red:255,green:255,blue:255,alpha:d};k.red=parseInt(g.substring(0,2),16);k.green=parseInt(g.substring(2,4),16);k.blue=parseInt(g.substring(4,6),16);return k}catch(p){return null}}
function $o(b){b=fp(b);if(null==b)return null;var d;d="rgba("+(b.red.toString(10)+",");d+=b.green.toString(10)+",";d+=b.blue.toString(10)+",";d+=b.alpha.toString(10);return d+")"}function fp(b){if("object"!==typeof b)return null;var d=["red","green","blue"];for(n in d){if("undefined"===typeof b[d[n]])return null;var g=b[d[n]];if(0>g||255<g)return null}"undefined"===typeof b.alpha&&(b.alpha=1);return b}
function gp(b){var d;if("number"!==typeof d)try{d=parseInt(d)}catch(p){d=1}"string"==typeof b&&(b=-1!=b.indexOf("rgba")?ep(b,d):Zo(b,d));if("object"!==typeof b||"object"!==typeof(b=fp(b)))return null;d=255*b.alpha;d=("00"+(.5>=d-parseInt(d)?Math.floor(d):Math.ceil(d)).toString(16)).substr(-2);var g=("00"+b.red.toString(16)).substr(-2),k=("00"+b.green.toString(16)).substr(-2);b=("00"+b.blue.toString(16)).substr(-2);return 0|parseInt("0x"+d+g+k+b,16)}
function hp(b,d){if(!(b instanceof pn))throw"shape type line must be of instance ol.geom.LineString!";var g="number"===typeof d?d:-1,k={};0<=g&&(k["@id"]=g);g=b.a;if(4<g.length)return dp.Li.call(null,b,d);k["@type"]="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Line";k.X1=g[0];k.X2=g[2];k.Y1=-g[1];k.Y2=-g[3];return k}
var ip={point:function(b,d){if(!(b instanceof ln))throw"shape type point must be of instance ol.geom.Circle!";var g="number"===typeof d?d:-1,k={};0<=g&&(k["@id"]=g);k["@type"]="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Point";g=Cj(b);k.X=g[0];k.Y=-g[1];return k},ellipse:function(b,d){if(!(b instanceof Tn))throw"shape type ellipse must be of instance ome.ol3.geom.Ellipse!";var g="number"===typeof d?d:-1,k={};0<=g&&(k["@id"]=g);k["@type"]="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Ellipse";
g=[b.h,b.i];k.X=g[0];k.Y=-g[1];g=b.Bc();k.RadiusX=g[0];k.RadiusY=g[1];return k},rectangle:function(b,d){if(!(b instanceof Nn))throw"shape type rectangle must be of instance ome.ol3.geom.Rectangle!";var g="number"===typeof d?d:-1,k={};0<=g&&(k["@id"]=g);k["@type"]="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Rectangle";g=On(b);k.X=g[0];k.Y=-g[1];k.Width=Qn(b);k.Height=Rn(b);return k},line:hp,polyline:function(b,d){if(!(b instanceof pn))throw"shape type polyline must be of instance ol.geom.LineString!";
var g="number"===typeof d?d:-1,k={};0<=g&&(k["@id"]=g);g=b.a;if(5>g.length)return hp.call(null,b,d);k["@type"]="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Polyline";k.Points="";for(var p=0;p<g.length;p+=2)0!==p&&0===p%2&&(k.Points+=" "),k.Points+=g[p]+","+-g[p+1];return k},label:function(b,d){if(!(b instanceof Km))throw"shape type label must be of instance ome.ol3.geom.Label!";var g="number"===typeof d?d:-1,k={};0<=g&&(k["@id"]=g);k["@type"]="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Label";
g=On(b);k.X=g[0];k.Y=-g[1];return k},polygon:function(b,d){if(!(b instanceof Rd))throw"shape type polygon must be of instance ol.geom.Polygon!";var g="number"===typeof d?d:-1,k={};0<=g&&(k["@id"]=g);k["@type"]="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Polygon";g=b.a;k.Points="";for(var p=0;p<g.length;p+=2)0!==p&&0===p%2&&(k.Points+=" "),k.Points+=g[p]+","+-g[p+1];return k}};
function Qm(b,d){if(!(b instanceof qb)||0===sb(b))return null;var g="boolean"===typeof d?d:!1,k=-1,p={count:0,rois:{}};b.forEach(function(b){var d=[];b instanceof bo?d=d.concat(b.K):d.push(b);for(f in d)if(b=d[f],b instanceof yk&&null!==b.C()&&"number"===typeof b.state&&0!==b.state){var v=-1,w=-1;if(!("string"!==typeof b.ya()||3>b.ya().length)){var z=b.ya().indexOf(":");if(!(1>z)){v=b.ya().substring(0,z);w=b.ya().substring(z+1);try{v=parseInt(v),w=parseInt(w)}catch(N){continue}z=v;2===b.state&&g&&
(z=k--);v=null;"object"!==typeof p.rois[z]&&(p.rois[z]={"@type":"http://www.openmicroscopy.org/Schemas/ROI/2015-01#ROI",shapes:[]});v=p.rois[z];z=b.type;try{var A=ip[z].call(this,b.C(),2===b.state?-1:w),w=b,C=A;if("object"===typeof C&&"string"===typeof C["@type"]&&w instanceof yk&&(w.a instanceof nj||"function"===typeof w.a)){var D=w.a;"function"===typeof D&&(D=D(1));if(D instanceof nj){var E="http://www.openmicroscopy.org/Schemas/ROI/2015-01#Label"===C["@type"];!E&&D.f&&(C.FillColor=gp(D.f.a));var G=
E&&D.I()&&D.I().R()?D.I().R().h:"object"===typeof w.oldStrokeStyle&&"string"===typeof w.oldStrokeStyle.color?w.oldStrokeStyle.color:null;G&&(C.StrokeColor=gp(G));var J="object"===typeof w.oldStrokeStyle&&null!==w.oldStrokeStyle&&"number"===typeof w.oldStrokeStyle.width?w.oldStrokeStyle.width:1;C.StrokeWidth={"@type":"TBD#LengthI",Unit:"PIXEL",Symbol:"px",Value:E&&D.I()&&D.I().R()?D.I().R().i:J};if(D.I()&&(D.I().I()&&(C.Text=D.I().I()),D.I().jb)){var K=D.I().jb.split(" ");if(3==K.length)try{C.FontStyle=
K[0],C.FontSize={"@type":"TBD#LengthI",Unit:"PIXEL",Symbol:"px",Value:parseInt(K[1])},C.FontFamily=K[2]}catch(N){}}}}w=b;C=A;"object"===typeof C&&w instanceof yk&&("number"===typeof w.theT&&-1!==w.theT&&(C.TheT=w.theT),"number"===typeof w.theZ&&-1!==w.theZ&&(C.TheZ=w.theZ),"number"===typeof w.theC&&-1!==w.theC&&(C.TheC=w.theC));A.oldId=b.ya();v.shapes.push(A)}catch(N){console.error("Failed to turn feature "+z+"("+b.ya()+") into json => "+N);continue}p.count++}}}});return 0===p.count?null:p};function sm(b){if(!ga(b)||0===b.length||1===b.length&&1===b[0])return dn;var d=dn.length;if(b.length>=d)return b;b=[].concat(b);var g=-1;for(i in b)if(1===b[i]){g=i;break}if(0>g){for(i in b)if(1>b[i]){g=i;break}0>g?(b.push(1),g=b.length-1):b.splice(g,0,1)}if(b.length>=d)return b;for(i in dn)if(1==dn[i])break;var d=d-b.length,k=!0;for(b.length-g<g&&(k=!1);0<d;)k?(k=!1,b.splice(0,0,1.5*b[0])):(k=!0,b.push(b[b.length-1]/1.5)),d--;return b}
function jp(b){if("string"!=typeof b||0==b.length)return null;for(var d=0,g=b.length,k=[],p=-1,q=0<b.indexOf(",");0<g-d;){if(" "==b[d]){if(d+1>=g)break;if(!q||q&&" "===b[d+1])if(d++,q)continue}var u=b[d].toLowerCase();if("m"===u||"l"===u||"z"===u||" "===u)if(0>p){for(;d+1<g&&" "===u&&(" "===b[d+1]||"z"===b[d+1].toLowerCase());)u=b[++d].toLowerCase();if("z"==u){k.push(k[0]);p=-1;break}for(p=d+1;0<g-d&&(" "===b[++d]||"M"===b[d]);)p++}else try{var v=b.substring(p,q?d:d-1).split(q?",":" ");if("object"!=
typeof v||2>v.length)return null;var w=null,z=null;for(t in v)if(""!==v[t])if(null===w)w=v[t];else if(null===z)z=v[t];else break;if(null===w&&null===z)return null;k.push([parseInt(w),-parseInt(z)]);p=-1;d--}catch(A){return null}d++}if(-1!==p)try{v=b.substring(p,g).split(q?",":" ");if("object"!=typeof v||2>v.length)return null;z=w=null;for(t in v)if(""!==v[t])if(null===w)w=v[t];else if(null===z)z=v[t];else break;if(null===w&&null===z)return null;k.push([parseInt(w),-parseInt(z)])}catch(A){return null}return k}
function $n(b,d,g,k,p,q){ga(b);var u=[];k="undefined"!==typeof k?k:window;g="boolean"===typeof g?g:!1;q="undefined"!==typeof q?q:Zd;var v=null;mm(d,b,function(b,d){if("boolean"!==typeof b.visible||b.visible)"function"===typeof this.$c&&this.$c(b,d)?(u.push(b),v=d):u.push(b)},k,q);p="function"===typeof p?p:function(){};if(0!=u.length)if(1===u.length)p.call(k,u[0],v);else{b=[];for(i in u)g&&u[i]instanceof bo?b.push(u[i]):0<b.length?(d=b[0].C(),Wb(d.J(),u[i].C().J())&&(b[0]=u[i])):b.push(u[i]);if(g&&
1<b.length)for(i in b)Wb(b[0].C().J(),b[i].C().J())&&(b[0]=b[1]);p.call(k,b[0],v)}}function fo(b,d){"object"===typeof b&&"string"===typeof b.className&&"string"===typeof d&&(b.className=d)}function eo(b){b="object"!==typeof b||"string"!==typeof b.className?null:b.className.match(/\S+/g)||null;return null===b?!1:0<=ae(b,"content")}
function Xo(){for(var b=document.cookie.split(";"),d=0,g=b.length;d<g;d++){for(var k=b[d];" "==k.charAt(0);)k=k.substring(1);if(0==k.indexOf("csrftoken="))return k.substring(10,k.length)}return""};var pm={tc:function(b){if("string"!==typeof b)return null;try{var d={path:"/",query:"",full:"/",relative:!0};b=b.replace(/\s/g,"");if(0===b.length)return d;for(var g=b.length,k=0;k<g&&"/"===b.charAt(k);k++)d.relative=!1,b=b.substring(k+1),k--;var p=b.indexOf("?");-1!==p&&(d.query=b.substring(p+1),b=b.substring(0,p));g=b.length;if(0<g)for(k=g-1;0<=k&&"/"===b.charAt(k);k--)b=b.substring(0,k);d.path=b;d.full=d.path;0<d.query.length&&(d.full+="/?"+d.query);return d}catch(q){return null}},ne:function(b){if("string"!==
typeof b)return null;try{var d={protocol:"",server:"",full:""};b=b.replace(/\s/g,"");if(0===b.length)return d;var g=b.indexOf("://");if(-1===g)d.protocol="http";else{var k=b.substring(0,g).toLowerCase();if("http"!==k&&"https"!==k&&"file"!==k)return null;d.protocol=k;b=b.substring(g+3)}var p=b.length;if(0<p)for(g=p-1;0<g&&"/"===b.charAt(g);g--)b=b.substring(0,g);d.server=b;d.full=d.protocol+"://"+d.server;return d}catch(q){return null}},hc:function(b){if("object"!==typeof b||"string"!==typeof b.protocol||
"string"!==typeof b.server||"string"!==typeof b.full)return!1;if(""===b.full)return!0;var d="",d="file:"===window.location.protocol?window.location.href:window.location.protocol+"//"+window.location.hostname,d=d.toLowerCase();return d===b.full.toLowerCase()?!0:!1},Ki:function(b,d,g){pm.Mc({server:b,uri:"/webclient/keepalive_ping/",jsonp:!1,success:function(b){d&&g?d.call(g,b):d?d(b):console.info("Received: "+b)},error:function(){console.error("keep alive failed")}},g)},Mc:function(b,d){var g=b||{},
k=g.server||"";"string"===typeof k&&(k=pm.ne(k));var p=g.uri||"",p=pm.tc(p),q="string"===typeof g.method?g.method.toUpperCase():"GET",u="object"===typeof g.headers?g.headers:{},v="string"===typeof g.content?g.content:null,w="number"===typeof g.timeout?g.timeout:6E4,z="function"===typeof g.success?g.success:function(b){console.info(b)},g="function"===typeof g.error?g.error:function(b){console.error(b)};pm.hc(k)?pm.Jh(k,p,z,g,q,u,w,v,d):pm.Ih(k,p,z,g,d)},oe:function(b){ab(b,"this method needs the is_jsonp_request flag as first argument!")},
Jh:function(b,d,g,k,p,q,u,v,w){pm.oe(!1,b,d,g,k,p,q,u,v);var z="undefined"!==typeof window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b=""===b.full&&d.relative?d.full:b.full+"/"+d.full;""===d.query&&(b+="/");z.open(p,b,!0);for(h in q)z.setRequestHeader(h,q[h]);z.timeout=u;z.ontimeout=function(){console.info("xhr request timed out!")};z.onerror=function(b){b="undefined"!=typeof b.target?b.target.responseText:null;console.error(null===b?"xhr: an error occured":"xhr error: "+
b)};z.onreadystatechange=function(){if(4==z.readyState&&200<=z.status&&300>z.status){var b=z.responseText;"undefined"===typeof b&&(b=null);if(null!==b){var d="string"===typeof z.responseURL,p=d?z.responseURL.lastIndexOf("webclient/login/?url="):z.responseText.lastIndexOf("webclient/login/?url=");if(-1!==p){var b="webclient/login/?url=",q=window.location.href;d&&(b=z.responseURL.substring(0,p+21));window.location.href=b+q;return!0}w?g.call(w,b):g(b)}else w?k.call(w,z.statusText):k(z.statusText);return!0}return 4==
z.readyState?(w?k.call(w,z.statusText):k(z.statusText),!0):!1};z.send("POST"===p?v:null)},He:function(b){if("object"===typeof b&&"string"===typeof b.full){var d=window.location.href,g=!1;-1!==d.indexOf("?")&&(g=!0);b=b.full+"/webclient/login/?url="+d;window.location.href=(g?b+"&":b+"?")+"haveMadeCrossOriginLogin_"}},xg:function(b){pm.jsonpCallback_&&pm.jsonpCallback_(b)},Ih:function(b,d,g,k,p){function q(b){try{var d=document.head,g=document.createElement("script");g.onerror=function(b){console.error("JSONP request failed!");
p?k.call(p,k):k(b);delete pm.jsonpCallback_};g.src=b;d.appendChild(g);d.removeChild(g)}catch(q){console.error("failed to setup jsonp request: "+q)}}pm.oe(!0,b,d,g,k);pm.jsonpCallback_=function(b){try{p?g.call(p,b):g(b)}catch(d){p?k.call(p,d):k(d)}delete pm.jsonpCallback_};try{var u=b.full+"/"+d.full,u=""==d.query?u+"/?":u+"&";q(u+"callback=ome.ol3.utils.Net.jsonpCallback")}catch(v){delete pm.jsonpCallback_,console.error("jsonp: failed to issue request: "+v)}}};
ba("ome.ol3.utils.Net.jsonpCallback",pm.xg,OME);var kp={point:function(b){var d=new yk({geometry:new ln(["number"===typeof b.cx?b.cx:"number"===typeof b.x?b.x:-1,-("number"===typeof b.cy?b.cy:"number"===typeof b.y?b.y:-1)],2)});d.type="point";Bk(d,Yo(b));return d},ellipse:function(b){var d=new yk({geometry:new Tn(b.cx,-b.cy,b.rx,b.ry)});d.type="ellipse";Bk(d,Yo(b));return d},rectangle:function(b){var d=new yk({geometry:new Nn(b.x,-b.y,b.width,b.height)});d.type="rectangle";Bk(d,Yo(b));return d},line:function(b){var d=new yk({geometry:new pn([[b.x1,
-b.y1],[b.x2,-b.y2]])});d.type="line";Bk(d,Yo(b));return d},polyline:function(b){if("string"!=typeof b.points)return null;var d=jp(b.points);if(null===d)return null;d=new yk({geometry:new Mo(d)});d.type="polyline";Bk(d,Yo(b));return d},label:function(b){if("string"!==typeof b.textValue||0===b.textValue.length)b.textValue="missing textValue";if("number"!==typeof b.fontSize)try{b.fontSize=parseInt(b.fontSize)}catch(g){b.fontSize=10}"string"!==typeof b.fontFamily&&(b.fontFamily="sans-serif");"string"!==
typeof b.fontStyle&&(b.fontStyle="normal");var d=Sn(b.textValue,b.fontStyle+" "+b.fontSize+"px "+b.fontFamily),d=new yk({geometry:new Km(b.x,-b.y,d)});d.type="label";Bk(d,Yo(b,!0));return d},polygon:function(b){if("string"!=typeof b.points)return null;var d=jp(b.points);if(null===d)return null;d=new yk({geometry:new Rd([d])});d.type="polygon";Bk(d,Yo(b));return d}};function lp(b){if("string"!==typeof b||0===b.length)return null;b=b.toLowerCase();return"undefined"===typeof kp?null:kp[b]}
function mp(b){var d=lp(b.type);if("function"!==typeof d)return null;cp(b);b=d(b);return b instanceof yk?b:null}
function Jm(b,d,g,k){if(null==lp(b.type)||!ga(g)||4!=g.length)return null;if("number"!==typeof d||0>d)d=1;if(5E4<d)return console.info("The generation is limited to 50,000 at once for now!"),null;"boolean"!==typeof k&&(k=!1);cp(b);var p=g;"object"===typeof b&&"string"===typeof b.type&&0!==b.type.length&&ga(p)&&4==p.length&&(p=b.type.toLowerCase(),"point"===p?("number"!==typeof b.cx&&(b.cx=6),"number"!==typeof b.cy&&(b.cy=6)):"line"===p?("number"!==typeof b.x1&&(b.x1=2),"number"!==typeof b.x2&&(b.x2=
17),"number"!==typeof b.y1&&(b.y1=2),"number"!==typeof b.y2&&(b.y2=2)):"polyline"===p?"string"!==typeof b.points&&(b.points="M 2 2 L 7 7 L12 2 L17 7"):"polygon"===p?"string"!==typeof b.points&&(b.points="M 2 2 L 7 7 L12 2 L17 7 Z"):"rectangle"===p?("number"!==typeof b.x&&(b.x=2),"number"!==typeof b.y&&(b.y=2),"number"!==typeof b.width&&(b.width=15),"number"!==typeof b.height&&(b.height=15)):"ellipse"===p?("number"!==typeof b.cx&&(b.cx=20),"number"!==typeof b.cy&&(b.cy=15),"number"!==typeof b.rx&&
(b.rx=8),"number"!==typeof b.ry&&(b.ry=5)):"label"===p&&("string"!==typeof b.fontFamily&&(b.fontFamily="sans-serif"),"number"!==typeof b.fontSize&&(b.fontSize=15),"string"!==typeof b.fontStyle&&(b.fontStyle="normal"),"string"!==typeof b.textValue&&(b.textValue="generated"),"number"!==typeof b.x&&(b.x=10),"number"!==typeof b.y&&(b.y=10)));b=mp(b);if(null==b)return console.error("Failed to create generation prototype!"),null;b.state=2;var q=b.C().J(),u=hc(q),v=ic(q);0===v&&(v=1);0===u&&(u=1);var w=
hc(g),z=ic(g);if(0===w||0===z||u>w||v>z)return console.error("the protoype shape to be generated does not fit into the given extent!"),null;var p=[],A=ec(g),C=[g[2],g[1]],q=ec(q);b.C().Xa(-(q[0]-A[0]),-(q[1]+C[1]));if(k){g=[0,0,w-u,z-v];for(w=0;w<d;w++){z=g;ga(z)&&4==z.length?(k=z[2],v=Math.floor(Math.random()*(k-0+1))+0,k=z[3],z=[v,Math.floor(Math.random()*(k-0+1))+0]):z=null;if(null===z){console.error("couldn't get random coordinate");break}k=new yk({geometry:b.C().clone()});k.type=b.type;Bk(k,
ap(b.a));k.C().Xa(z[0],-z[1]);z=k;v="-1:"+I(k);z.va=v;z.A();k.state=2;p.push(k)}return p}k=d;A=g;g=u;0>=g&&(g=1);0>=v&&(v=1);g={fitsPerRow:parseInt(hc(A)/g),fitsPerColumn:parseInt(ic(A)/v)};v=k/(g.fitsPerRow*g.fitsPerColumn);if(1<v){for(;1<v;)g.fitsPerRow*=2,g.fitsPerColumn*=2,v=k/(g.fitsPerRow*g.fitsPerColumn);g.stepX=parseInt(hc(A)/g.fitsPerRow)}else g.stepX=g.fitsPerRow>k?parseInt(hc(A)/k):parseInt(hc(A)/g.fitsPerRow);g.stepY=parseInt(ic(A)/g.fitsPerColumn);for(u=v=0;u*g.stepY<z&&!(v>=d);u++)for(A=
0;A*g.stepX<w&&!(v>=d);A++)k=new yk({geometry:b.C().clone()}),k.type=b.type,Bk(k,ap(b.a)),k.C().Xa(A*g.stepX,-u*g.stepY),C=k,q="-1:"+I(k),C.va=q,C.A(),k.state=2,p.push(k),v++;return p}
function Vo(b){var d=gn;if(!(b instanceof Hk)||"object"!==typeof b.Ta||"object"!==typeof b.Ta.data)return null;if("number"!==typeof d||100>=d)d=100;var g=[];np(b.Ta.data,g);b=[];for(l in g){var k=new Hk,p=[],q=[],u=g[l];for(f in u){var v=u[f];p.push(v.sc);q.push(v)}k.load(p,q);b.push(k);if(g[l].length<d)break}return b}
function np(b,d){if("object"!==typeof b||!ga(d)||"number"!==typeof b.height&&"boolean"!==typeof b.Ca&&!ga(b.children)&&!ga(b.pa))return null;if("boolean"===typeof b.Ca&&b.Ca||"number"===typeof b.height&&1==b.height){var g=[],k=new bo;for(child in b.children){if(!ga(b.children[child])||5!=b.children[child].length)return null;var p=b.children[child][4];p.cluster=k;g.push(p)}No(k,b.pa,g);ga(d[0])||d.push([]);d[0].push(k);return k}p=[];for(child in b.children)p.push(np(b.children[child],d));k=b.height-
1;ga(d[k])||d.push([]);g=[];for(r in p)g=g.concat(p[r].K);g=new bo(b.pa,g);d[k].push(g);return g}
function Hm(b){if(!(b instanceof xm&&ga(b.za)))return null;var d=[];for(roi in b.za)if("number"===typeof b.za[roi].id&&ga(b.za[roi].shapes)){var g=b.za[roi].id;b.za[roi].state=0;for(shape in b.za[roi].shapes)if("number"===typeof b.za[roi].shapes[shape].id){var k=b.za[roi].shapes[shape].id,p=b.za[roi].shapes[shape].type,q="number"===typeof b.za[roi].shapes[shape].theT?b.za[roi].shapes[shape].theT:-1,u="number"===typeof b.za[roi].shapes[shape].theZ?b.za[roi].shapes[shape].theZ:-1;if(!(null===b.o||"string"!==
typeof p||-1!==q&&b.o.Gd("t")!==q||-1!==u&&b.o.Gd("z")!==u)){b.za[roi].shapes[shape].state=0;var v=null,w=null;try{var w=mp(b.za[roi].shapes[shape]),z=null;"string"===typeof b.za[roi].shapes[shape].type&&(z=b.za[roi].shapes[shape].type.toLowerCase());if("mask"===z){var v=b,A=b.za[roi].shapes[shape];if(v instanceof xm&&"object"===typeof A&&"string"===typeof A.type&&"mask"===A.type.toLowerCase()){var C=sb(om(v.o.o))-1;tb(om(v.o.o),C,new aj({source:new To({xa:null,url:v.o.Ua.full+"/webgateway/render_shape_mask/"+
A.id,ba:V(v.o.o).g,sg:[A.x,-A.y-A.height,A.x+A.width,-A.y]})}))}continue}var D=V(b.o.o).ha();w.C()instanceof Km&&0!==D&&!b.Eb&&w.C().rotate(-D);Lm(w,b)}catch(E){v=E}k=""+g+":"+k;w instanceof yk?(p=w,p.va=k,p.A(),-1!=q&&(w.theT=q),-1!=u&&(w.theZ=u),w.state=0,d.push(w)):(console.error("Failed to construct "+p+"("+k+") from shape info!"),null!=v&&console.error(v))}}}return d};var op;function Wm(){op=[{event:ome.glue.EVENTS.IMAGE_CHANGE,handler:function(b){this.me(b.id)}},{event:ome.glue.EVENTS.IMAGE_DIMENSION_CHANGE,handler:function(b){b.id===this.ya()&&this.Ye.apply(this,[b.dim].concat(b.value))}},{event:ome.glue.EVENTS.IMAGE_INIT_REGIONS,handler:function(b){b.id===this.ya()&&this.Uc()}},{event:ome.glue.EVENTS.IMAGE_VISIBILITY_REGIONS,handler:function(b){b.id===this.ya()&&this.Ze(b.visible,b.roi_shape_ids)}}]}
function vm(b){if(b instanceof X&&b.Ea instanceof ome.glue.WebGlue)for(e in Vm(b),op)try{var d=op[e];b.Ea.subscribe(d.event,d.handler,b)}catch(g){console.error("Unable to register event/handler: "+g)}}function Vm(b){b instanceof X&&b.Ea instanceof ome.glue.WebGlue&&b.Ea.unsubscribe(b)};    return {ol: OPENLAYERS.ol, ome: OME.ome};   }));
